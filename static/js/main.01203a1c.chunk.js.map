{"version":3,"sources":["images/classicVsValley.png","components/faq.js","images/Palette128_Unobtainable_Trans.png","components/header.js","locale/de/flag.svg","locale/ua/flag.svg","locale/en/flag.svg","locale/eo/flag.svg","locale/es/flag.svg","locale/et/flag.svg","locale/et/flag_pop.svg","locale/fr/flag.svg","locale/it/flag.svg","locale/lt/flag.svg","locale/pt/flag.svg","locale/ru/flag.svg","locale/zh-Hans/flag.svg","locale/zh-Hant/flag.svg","locale/pl/flag.svg","locale/pt-Br/flag.svg","locale/ja/flag.svg","locale/locale.js","components/languages.js","cookieManager.js","components/tooltip.js","components/mapart/blockSelectionAddCustom/blockSelectionAddCustom.js","images/null.png","images/textures.png","components/mapart/blockImage.js","components/mapart/blockSelection.js","components/mapart/workers/worker-builder.js","components/mapart/workers/nbt.js","components/mapart/greenButtons.js","components/mapart/workers/mapCanvas.js","components/mapart/mapPreview.js","images/gridOverlay.png","components/mapart/autoCompleteInputBlockToAdd/autoCompleteInputBlockToAdd.js","components/mapart/bufferedNumberInput/bufferedNumberInput.js","components/mapart/mapSettings.js","components/mapart/materials.js","components/mapart/nbtReader.js","components/mapart/viewOnlineCommon/waila.js","components/mapart/viewOnline2D/viewOnline2D.js","components/mapart/viewOnline3D/pointerLockControls.js","components/mapart/viewOnline3D/viewOnline3D.js","components/mapart/mapartController.js","images/upload.png","components/root.js","index.js"],"names":["FAQ","props","_jsxs","className","children","_jsx","Link","to","concat","undefined","includes","match","params","countryCode","href","target","rel","style","textAlign","alt","src","IMG_ClassicVsValley","Header","_Component","_inherits","_super","_createSuper","_classCallCheck","apply","arguments","_createClass","key","value","getLocaleString","this","Component","Locale","en","strings","Strings_en","flag","Flag_en","ua","Strings_ua","Flag_ua","et","Strings_et","Flag_et","flag_special","Flag_et_pop","lt","Strings_lt","Flag_lt","ru","Strings_ru","Flag_ru","de","Strings_de","Flag_de","pl","Strings_pl","Flag_pl","fr","Strings_fr","Flag_fr","it","Strings_it","Flag_it","pt","Strings_pt","Flag_pt","es","Strings_es","Flag_es","Strings_zh_Hans","Flag_zh_Hans","Strings_zh_Hant","Flag_zh_Hant","ja","Flag_ja","eo","Strings_eo","Flag_eo","Strings_pt_Br","Flag_pt_Br","Languages","Object","keys","map","language","React","Fragment","CookieManager","_this","forEach","name","getCookie","setCookie","cname","cvalue","d","Date","setTime","getTime","expires","toUTCString","document","cookie","ca","split","i","length","c","charAt","substring","indexOf","defaultValue","cookieValue","Tooltip","_len","args","Array","_key","call","state","hovering","handleMouseOver","setState","handleMouseOut","tooltipStyle","textStyleOverrides","_objectSpread","display","onMouseOver","onMouseOut","tooltipText","BlockSelectionAddCustom","block_name","block_nbtTags","block_colourSetId","block_versions","E_KeyOrValue","examplesGroups","title","blocks","blockName","nbtTags","facing","half","versions","variant","type","onSettingChange_block_name","e","onSettingChange_block_nbtTags","tagIndex","keyOrValue","block_nbtTags_new","_toConsumableArray","every","t","pop","push","onSettingChange_block_colourSetId","onSettingChange_block_versions","versionToToggle","block_versions_new","coloursJSON","_i","_Object$keys","SupportedVersions","supportedVersion_key","prevProps","lastSelectedCustomBlock","loadBlockIntoForm","colourSetId","blockId","blockToLoad","blockToLoad_nbtTags","versionToLoad_nbtData","values","validVersions","find","version","_i2","_Object$entries","entries","NBTArgs","_Object$entries$_i","_slicedToArray","nbtTag_key","nbtTag_value","blockToLoad_versions","_i3","_Object$entries2","_Object$entries2$_i","MCVersion","NBTName","_this2","_this$props","onAddCustomBlock","onDeleteCustomBlock","_this$state","examples","open","examplesGroup","block","outline","padding","marginBlockStart","marginBlockEnd","disabled","_ref","_ref2","tagKey","tagValue","_ref3","_ref4","supportedVersion_value","checked","setting_customBlock_name","onChange","setting_customBlock_nbtTags","_ref5","_ref6","setting_customBlock_colourSetId","backgroundColor","tonesRGB","normal","join","color","_ref7","_ref8","colourSet","colourName","setting_customBlock_versions","_ref9","_ref10","block_version","block_version_checked","customBlock_submit","colSpan","width","onClick","customBlock_delete","BlockImage","props_others","_objectWithoutProperties","_excluded","isNone","isUnknown","IMG_Null","displayName","backgroundImage","IMG_Textures","backgroundPositionX","backgroundPositionY","presetIndex","BlockSelection","getColourSetBox","background","optionValue_staircasing","MapModes","SCHEMATIC_NBT","staircaseModes","OFF","uniqueId","MAPDAT","cssRGB","CLASSIC","VALLEY","ON","dark","light","ON_UNOBTAINABLE","unobtainable","FULL_DARK","FULL_LIGHT","FULL_UNOBTAINABLE","Error","RGBArray","onChangeColourSetBlock","optionValue_version","selectedBlocks","presets","selectedPresetName","canDeletePreset","onPresetChange","onDeletePreset","onSavePreset","onSharePreset","onGetPDNPaletteClicked","handleAddCustomBlock","handleDeleteCustomBlock","presetsManagement","id","preset","localeKey","blockSelection","filter","some","cursor","position","paddingLeft","zIndex","whiteSpace","margin","WorkerBuilder","_Worker","worker","code","toString","lastIndexOf","blob","Blob","_possibleConstructorReturn","Worker","URL","createObjectURL","_wrapNativeSuper","NBTWorker","optionValue_supportBlock","pixelsData","maps","currentSelectedBlocks","progressReportHead","exactColourCache","Map","TagTypes","NBTWriter","ArrayBuffer","DataView","Uint8Array","buffer","dataView","arrayView","offset","str","array","charCodeAt","size","requiredLength","byteLength","newLength","newBuffer","newArrayView","set","fill","dataType","accommodate","writeByType","write","bytes","encodeUTF8","slice","Map_NBT","mapColoursLayout","coloursLayout","mapMaterialsCounts","materials","NBT_json","entities","palette","author","DataVersion","physicalLayout","palette_colourSetId_paletteId","palette_paletteId_colourSetId","columnHeightsCache","nonZeroMaterials","fromEntries","_this3","paletteItemToPush","Name","toLowerCase","blockNBTData","Properties","NBTArg_key","NBTVersion","x","y","z","pos","columnNumber","getPhysicalLayout_individualColumn","postMessage","head","body","currentHeight","mapColoursLayoutColumn","physicalColumn","returnPhysicalBlock","rowNumber","coloursLayoutBlock","tone","sort","elt1","elt2","plateaus","startIndex","endIndex","ascending","currentPlateauStartIndex","visibleBlocksHeight","physicalBlock","nonPlateauPulldownHeights","Number","MAX_SAFE_INTEGER","pullDownHeight","Math","min","plateauPulldownHeight","shift","columnMinimumY","reduce","a","b","getPhysicalLayout","constructPaletteLookups","setNBT_json_palette","setNBT_json_DataVersion","setNBT_json_blocks","setNBT_json_size","nbtWriter","writeTopLevelCompound","getData","Map_Mapdat","dataVersion","data","scale","dimension","unlimitedTracking","trackingPosition","locked","height","xCenter","zCenter","colors","pixel","arrayOffset","mapdatId","setNBT_json_colors","exactRGBToColourSetIdAndTone","pixelRGB","RGBBinary","get","onmessage","headerMessage","_i6","_i7","toneKey","toneRGB","setupExactColourCache","mapSize_x","mapSize_z","whichMap_z","whichMap_x","coloursLayout_columnToPush","pixelsData_offset","colourSetIdAndTone","setupColoursLayoutsFromPixelsData","rowOfMaps","j","materials_new","mergeMaps","whichMap_y","NBT_Array","getNBT","Mapdat_Bytes","GreenButtons","buttonWidth_viewOnline","buttonWidth_NBT_Joined","buttonWidth_NBT_Split","buttonWidth_Mapdat_Split","mapPreviewWorker_onFinishCallback","nbtWorker","getNBT_base","workerHeader","optionValue_mapSize_x","optionValue_mapSize_y","optionValue_mapdatFilenameUseId","optionValue_mapdatFilenameIdStart","uploadedImage_baseFilename","currentMaterialsData","mapPreviewWorker_inProgress","downloadBlobFile","onGetViewOnlineNBT","elt","alert","terminate","resetButtonWidths","numberOfSplitsCalculated","zipFile","JSZip","t0","performance","now","t1","console","log","_e$data$body","NBT_Array_gzipped","gzip","file","generateAsync","then","content","downloadBlob","_e$data$body2","Mapdat_Bytes_gzipped","_e$data$body3","onViewOnlineClicked","onGetNBTClicked","onGetNBTSplitClicked","onGetMapdatSplitClicked","onGetMapdatSplitZipClicked","_this$props2","optionValue_modeNBTOrMapdat","optionValue_cropImage","optionValue_cropImage_zoom","optionValue_cropImage_percent_x","optionValue_cropImage_percent_y","optionValue_transparency","optionValue_transparencyTolerance","optionValue_betterColour","optionValue_dithering","optionValue_dithering_propagation_red","optionValue_dithering_propagation_green","optionValue_dithering_propagation_blue","optionValue_preprocessingEnabled","preProcessingValue_brightness","preProcessingValue_contrast","preProcessingValue_saturation","preProcessingValue_backgroundColourSelect","preProcessingValue_backgroundColour","uploadedImage","componentDidUpdate_shouldNBTWorkerTerminate","buttons_mapModeConditional","_this$props3","floor","button_donate","textDecoration","MapWorker","DitherMethods","canvasImageData","colourSetsToUse","colourCache","labCache","rgb2lab","rgb","val","has","r1","g1","b1","f","pow","h","k","l","squaredEuclideanMetricColours","pixel1","pixel2","r","g","findClosestColourSetIdAndToneAndRGBTo","closestPixel","shortestDistance","squareDistance","findClosest2ColourSetIdAndToneAndRGBTo","shortestDistance1","shortestDistance2","closestPixel1","closestPixel2","colourSetIdAndToneToRGB","newPixels","colourSetIdsToUse","toneKeys","mapMode","staircaseMode","_colourSetIdsToUse","_step","_iterator","_createForOfIteratorHelper","s","n","done","err","setupColourSetsToUse","mapsRowToAdd","_loop","mapEntryToAdd","supportBlockCount","ditherMatrix","divisor","row","chosenDitherMethod","ditherMethodKey","None","FloydSteinberg","FloydSteinberg_20","FloydSteinberg_24","MinAvgErr","Burkes","SierraLite","Stucki","Atkinson","Atkinson_6","Atkinson_10","Atkinson_12","ditherDivisor","indexR","indexG","indexB","indexA","multimapWidth","multimap_x","multimap_y","closestColourSetIdAndTone","oldPixel","closestColour","Bayer44","Bayer22","Ordered33","quant_error","weight","getMapartImageDataAndMaterials","pixels","MapPreview","mapPreviewSizeScale","workerProgress","mapCanvasWorker","MapCanvasWorker","increasePreviewScale","decreasePreviewScale","canvasRef_source","createRef","canvasRef_display","fileInputRef","newProps","prevState","newState","propChanges","shouldCanvasUpdate_source","updateCanvas_source","shouldCanvasUpdate_display","updateCanvas_display","colourHex","rgbGroups_input","exec","colourRGB_input","parseInt","smallestDistance","colourRGB_return","coloursRGB_colourSet","colourRGB_colourSet","colourDistance","padStart","ctx_source","current","getContext","imageSmoothingEnabled","imageSmoothingQuality","clearRect","canvas","backgroundColour","BackgroundColourModes","test","SMOOTH","selectedBlockId","closestSmoothColourTo","rect","fillStyle","CropModes","drawImage","CENTER","MANUAL","samplingWidth","samplingHeight","samplingOffset_x","samplingOffset_y","img_width","img_height","_this$props4","onGetMapMaterials","onMapPreviewWorker_begin","getImageData","putImageData","_this$props5","optionValue_showGridOverlay","onFileDialogEvent","ref","backgroundSize","click","visibility","AutoCompleteInputBlockToAdd","suggestionSelected","getRelevantSuggestions","suggestions_prefix","suggestions_includes","supportBlockMandatory","startsWith","handleTextChange","newValue","replace","setValue","onSuggestionClicked","suggestion","onFocus","relevantSuggestions","BufferedNumberInput","onInputChange","validators","onValidInput","newValue_buffer","newValue_int","validator","max","step","MapSettings","onOptionChange_version","onOptionChange_mapSize_x","onOptionChange_mapSize_y","onOptionChange_modeNBTOrMapdat","onOptionChange_cropImage","onOptionChange_cropImage_zoom","onOptionChange_cropImage_percent_x","onOptionChange_cropImage_percent_y","onOptionChange_showGridOverlay","onOptionChange_staircasing","setOption_SupportBlock","onOptionChange_transparency","onOptionChange_transparencyTolerance","onOptionChange_mapdatFilenameUseId","onOptionChange_mapdatFilenameIdStart","onOptionChange_BetterColour","onOptionChange_dithering","onOptionChange_dithering_propagation_red","onOptionChange_dithering_propagation_green","onOptionChange_dithering_propagation_blue","onOptionChange_PreProcessingEnabled","onOptionChange_PreProcessingBrightness","onOptionChange_PreProcessingContrast","onOptionChange_PreProcessingSaturation","onOptionChange_PreProcessingBackgroundColourSelect","onOptionChange_PreProcessingBackgroundColour","optionValue_extras_moreStaircasingOptions","onOptionChange_extras_moreStaircasingOptions","setting_mode","setting_version","supportedVersion","setting_mapSize","isNaN","setting_crop","cropMode","setting_crop_zoom","setting_crop_percent_x","setting_crop_percent_y","settings_mapModeConditional","settingGroup_cropping","setting_grid","setting_staircasing","extra","setting_transparency","setting_transparencyTolerance","settingGroup_transparency","setting_mapdatFilenameUseId","setting_mapdatFilenameIdStart","settingGroup_mapdatFilename","setting_betterColour","setting_dithering","setting_dithering_propagation_red","setting_dithering_propagation_green","setting_dithering_propagation_blue","setting_dithering_propagation","setting_preprocessing","setting_preprocessing_brightness","setting_preprocessing_contrast","setting_preprocessing_saturation","setting_preprocessing_background","backgroundColourMode","setting_preprocessing_backgroundColour","settingGroup_preprocessing","setting_extras_moreStaircasingOptions","settingGroup_extras","Materials","onlyMaxPerSplit","onOnlyMaxPerSplitChange","currentState","formatMaterialCount","count","numberOfShulkers","numberOfStacks","remainder","materialsCount","_step2","_iterator2","materialCount","first","second","_i4","_Object$entries3","_Object$entries3$_i","selection","nonZeroMaterialsItems","mergedList","_i5","_Object$values","_Object$values$_i","nbtNameToColourSetId","counts","v","NBSP","String","fromCharCode","CRLF","results","nameMaxLength","_Object$keys2","_Object$entries4","_Object$entries4$_i","padEnd","navigator","clipboard","writeText","getMaterialsCount_nonZeroMaterialsItems","getMaterialsCount_supportBlock","supportBlockIds","colourSetIdAndBlockIdFromNBTName","copyToClipboard","NBTReader","codepoints","byte","readByType","read","arrayLength","returnArray","string_bytes_length","string_bytes","decodeUTF8","list_objectType","list_length","returnObject","tagType","array_length","Waila","selectedBlock","verticalAlign","ViewOnline2D","viewOnline_NBT_decompressed","zoomFactor","canvasOffset_x","canvasOffset_y","paletteIdToColourSetIdAndBlockId","mouse","down","movedSinceDown","handleScroll_document","preventDefault","handleScroll_canvas","zoomMultiplier","offsetX","offsetY","delta","wheelDelta","detail","bind","_assertThisInitialized","handleMouseDown","clientX","clientY","addEventListener","handleMouseMove","passive","handleMouseUp","canvasRef_viewOnline","canvas_width","clientWidth","canvas_height","clientHeight","block_x","block_z","block_coords","block_paletteId","_this$paletteIdToColo","selectedBlock_colourSetId","selectedBlock_blockId","removeEventListener","mouseMoved_x","mouseMoved_y","abs","viewOnline_NBT","nbtReader","loadBuffer","NBT_palette","paletteItem_index","paletteItem","paletteItemFound","argKey","argValue","img_textures","Image","onload","canvasRef_viewOnline_ctx","textBaseline","font","fillRect","currentY","processedNoobline","_this2$paletteIdToCol","int_colourSetId","int_blockId","int_colourSetId_toDraw","int_blockId_toDraw","strokeStyle","strokeText","fillText","whichChunk_x","whichChunk_y","getNBTDecompressed","drawNBT","onChooseViewOnline3D","_this$state2","component_controls","flexDirection","component_waila","component_size","_viewOnline_NBT_decom","size_x","size_y","size_z","marginRight","right","component_topBar","left","top","_euler","Euler","_vector","Vector3","_vector_up","_changeEvent","_lockEvent","_unlockEvent","_PI_2","PI","PointerLockControls","_EventDispatcher","camera","domElement","warn","isLocked","minPolarAngle","maxPolarAngle","scope","onMouseMove","event","movementX","mozMovementX","webkitMovementX","movementY","mozMovementY","webkitMovementY","setFromQuaternion","quaternion","setFromEuler","dispatchEvent","onPointerlockChange","ownerDocument","pointerLockElement","onPointerlockError","error","connect","disconnect","dispose","getObject","getDirection","direction","copy","applyQuaternion","moveForward","distance","setFromMatrixColumn","matrix","crossVectors","up","addScaledVector","moveRight","moveUp","lock","requestPointerLock","unlock","exitPointerLock","EventDispatcher","BlockWorld","options","faces","uvRow","dir","vertices","uv","chunkSize","chunks","chunks_mesh","renderRequested","animationFrameRequestID","moveX","moveY","startAnimationLoop","renderer","render","scene","window","requestAnimationFrame","stopAnimationLoop","cancelAnimationFrame","handleKeyDown","controls","fov","updateProjectionMatrix","handleKeyUp","handlePointerDown","canvasRef","recordMovement","selectBlockIfNoMovement","selectBlock","handleTouchStart","handleWindowResize","setSize","aspect","tileSize","tileTextureWidth","tileTextureHeight","camera_x","camera_y","camera_z","onSelectBlockCallback","THREE","add","texture","load","magFilter","minFilter","material","side","alphaTest","transparent","blockX","euclideanModulo","chunkX","chunkY","chunkZ","getChunkKey","chunkKey","chunk","getChunkForBlock","blockOffset","computeBlockOffset","addChunkForBlock","start","end","setFromMatrixPosition","matrixWorld","unproject","intersection","intersectRay","dx","dy","dz","lenSq","len","sqrt","ix","iy","iz","stepX","stepY","stepZ","txDelta","tyDelta","tzDelta","xDist","yDist","zDist","txMax","Infinity","tyMax","tzMax","steppedIndex","getBlock","verticesComponents","normalsComponents","uvs","indices","startX","startY","startZ","blockY","blockZ","_block","_step$value","neighbor","numberOfVertices","_step2$value","mesh","geometry","_this$generateGeometr","generateGeometryDataForChunk","setAttribute","Float32Array","setIndex","computeBoundingSphere","updatedChunkKeys","_arr","ox","oy","oz","updateChunkGeometry","ViewOnline3D","handleEscapeKeyDown","handleViewOnline3DEscape","schematic_size_x","schematic_size_y","schematic_size_z","world","_this3$world","setBlock","_this4","_viewOnline_NBT_decom2","addEventListeners","removeEventListeners","_viewOnline_NBT_decom3","bottom","MapartController","viewOnline_3D","eventListener_dragover","stopPropagation","eventListener_drop","files","dataTransfer","imgUrl","loadUploadedImageFromURL","eventListener_paste","clipboardData","handleChangeColourSetBlock","handleChangeColourSetBlocks","setsAndBlocks","blockIdAndBlock","mode","mcVersion","supportedVersionFound","cropValue","staircasingValue","ditheringValue","text","handleGetPDNPaletteClicked","_this$state3","paletteText","selectedBlocksToURL","numberOfColoursExported","toneKeysToExport","colours","toneKeyToExport","toUpperCase","handlePresetChange","presetName","selectedPreset","DefaultPresets","defaultPreset","handleDeletePreset","_this$state4","confirm","presets_new","JSON","stringify","handleSavePreset","_this$state5","presetToSave_name","prompt","otherPresets","newPreset","_this$state6","presetQueryString","handleSharePreset","_this$state7","URLToPreset","encodedPreset","onCorruptedPreset","_this$state8","presetRegex","_loop2","encodedColourSetId","encodedBlockId","decodedColourSetId","decodedPresetIndex","Q","R","S","T","U","V","W","X","Y","Z","decodedBlock","decodedBlockId","handleSetMapMaterials","block_name_trimmed","trim","blockToAdd","addedFirstVersion","_step3","_iterator3","_step3$value","nbtTag_key_trimmed","nbtTag_value_trimmed","customBlocks_new","parse","customBlock","getMergedColoursJSON","_defineProperty","_Object$entries5","_Object$entries5$_i","init","_step4","cookiesPresets_loaded","touchCookie","cookiesPresets_updated","_iterator4","_loop3","cookiesPreset_loaded","cookiesPreset_updated","cookie_customBlocks","cookieMCVersion","URLParams","location","searchParams","decodedPresetBlocks","customBlocks","_step5","coloursJSON_custom","_iterator5","_step5$value","imageURL","baseFilename","img","filename","downloadURL","downloadElt","createElement","download","appendChild","revokeObjectURL","removeChild","_this$state9","Root","displayingCorruptedPresetWarning","displayingEdgeWarning","stringName","languageCodeOverride","stringSegments","stringLast","folder","onEdgeWarningButtonClick","onCorruptedPresetWarningButtonClick","showCorruptedPresetWarning","ReactDOM","StrictMode","Router","basename","Switch","Route","path","component","getElementById"],"mappings":"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","file":"static/js/main.01203a1c.chunk.js","sourcesContent":["export default __webpack_public_path__ + \"static/media/classicVsValley.fb0924c8.png\";","import { Link } from \"react-router-dom\";\r\n\r\nimport \"./faq.css\";\r\nimport IMG_Palette from \"../images/Palette128_Unobtainable_Trans.png\";\r\nimport IMG_ClassicVsValley from \"../images/classicVsValley.png\";\r\n\r\nfunction FAQ(props) {\r\n  return (\r\n    <div className=\"FAQ\">\r\n      <Link to={`/${![undefined, \"en\"].includes(props.match.params.countryCode) ? props.match.params.countryCode : \"\"}`}>\r\n        <h3>Close</h3>\r\n      </Link>\r\n\r\n      <h1>FAQ</h1>\r\n\r\n      <h2>How do I get started?</h2>\r\n      <a href=\"https://youtu.be/bJ-wX68WNHM\" target=\"_blank\" rel=\"noopener noreferrer\">\r\n        Video tutorial\r\n      </a>\r\n\r\n      <h2>General</h2>\r\n      <b>Why does the output change with the same image and settings?</b>\r\n      <p>\r\n        The JPEG decoding and scaling algorithms vary between browsers and get changed all the time. If you wish to be 100% sure your image stays the same,\r\n        right click on the <em>Map preview</em> and choose <em>Save image as...</em>. Next time you can upload the image you saved.\r\n      </p>\r\n\r\n      <h2>Schematic (.nbt)</h2>\r\n      <b>What do I do with the NBT file?</b>\r\n      <p>Use it like a .schematic file.</p>\r\n\r\n      <b>How can I use the NBT file?</b>\r\n      <p>\r\n        You can use it with programs like{\" \"}\r\n        <a href=\"https://cubical.xyz/\" target=\"_blank\" rel=\"noopener noreferrer\">\r\n          cubical.xyz\r\n        </a>\r\n        ,{\" \"}\r\n        <a href=\"https://www.mcedit-unified.net/\" target=\"_blank\" rel=\"noopener noreferrer\">\r\n          MCEdit\r\n        </a>{\" \"}\r\n        and mods like{\" \"}\r\n        <a href=\"https://minecraft.curseforge.com/projects/schematica\" target=\"_blank\" rel=\"noopener noreferrer\">\r\n          Schematica\r\n        </a>{\" \"}\r\n        /{\" \"}\r\n        <a href=\"https://minecraft.curseforge.com/projects/litematica\" target=\"_blank\" rel=\"noopener noreferrer\">\r\n          Litematica\r\n        </a>\r\n        . You can also import them into your game directly with a structure block - although it might require a redstone power source (\r\n        <a href=\"https://github.com/rebane2001/mapartcraft/issues/100\" target=\"_blank\" rel=\"noopener noreferrer\">\r\n          #100\r\n        </a>\r\n        ). It might be a better idea to use a datafile instead - it's easier and gives more colors.\r\n      </p>\r\n\r\n      <b>...but I need a .schematic file!</b>\r\n      <p>\r\n        Import it into{\" \"}\r\n        <a href=\"https://cubical.xyz/\" target=\"_blank\" rel=\"noopener noreferrer\">\r\n          cubical.xyz\r\n        </a>{\" \"}\r\n        or{\" \"}\r\n        <a href=\"https://www.mcedit-unified.net/\" target=\"_blank\" rel=\"noopener noreferrer\">\r\n          MCEdit\r\n        </a>{\" \"}\r\n        and export as .schematic. <em>Note that if you're using MCEdit or Cubical, you must export the map as 1.12.2.</em> You do not need a .schematic file for\r\n        use with Baritone; use Schematica and the \"#schematica\" command.\r\n      </p>\r\n\r\n      <b>But MCEdit doesn't work!</b>\r\n      <p>\r\n        Make sure you're using{\" \"}\r\n        <a href=\"https://www.mcedit-unified.net/\" target=\"_blank\" rel=\"noopener noreferrer\">\r\n          MCEdit Unified\r\n        </a>{\" \"}\r\n        and importing the NBT as a schematic, NOT loading it as a world. Alternatively, use Cubical.\r\n      </p>\r\n\r\n      <b>Why is there a row of extra blocks?</b>\r\n      <p>\r\n        The shade a block shows up as on the map is decided by the block North of it; if the Northern block is higher then a darker tone shows, else if the\r\n        Northern block is lower then a lighter tone shows, else a normal tone shows. Thus an extra row of blocks (colloquially known as a noobline) exists at\r\n        the top of a map to shade the top row properly.\r\n      </p>\r\n\r\n      <b>How do I align the map?</b>\r\n      <p>\r\n        When you have found a suitable place to build your map (eg above an ocean) make sure to open the map first and find the bottom left corner for aligning\r\n        your schematic. Maps in Minecraft align to a fixed 128x128 grid. North is always the up-direction on maps and you shouldn't need to rotate the schematic.\r\n      </p>\r\n\r\n      <h2>Datafile (.dat)</h2>\r\n      <b>What is a map.dat file?</b>\r\n      <p>\r\n        '.dat' is the native format Minecraft stores map data in, meaning you can use it to import maps into your worlds without needing to build a physical\r\n        structure. It also enables you to use a fourth extra shade of color not accessible in survival.\r\n      </p>\r\n\r\n      <b>What do I do with the map.dat file?</b>\r\n      <p>\r\n        You can use the map.dat file in singleplayer or a server you own. Create a new map in-game, go to your world's save file, then the data folder and from\r\n        there you can replace map_xxx.dat files. MapartCraft downloads a .zip file containing all of the 1x1 map.dat files.\r\n      </p>\r\n\r\n      <h2>Settings</h2>\r\n      <b>Map size?</b>\r\n      <p>\r\n        This will define how many maps you will create for your picture. When creating bigger maps, it's recommended to split it into multiple schematics (lest\r\n        large staircased maps stretch above the world height limit). This can be done with the \"DOWNLOAD AS 1X1 SPLIT\" button which downloads all the 1x1 NBTs in a .zip file.\r\n      </p>\r\n\r\n      <b>My image is stretched!</b>\r\n      <p>Change your map size, enable the crop option, or edit your image with an image editor.</p>\r\n\r\n      <b>'Staircasing'?</b>\r\n      <p>\r\n        This will make your map 3D. Doing so will give you 3 times the colors, often producing a much richer mapart, but it will also make the map a lot harder\r\n        to build, as it is not flat. 3D 'Classic' and 'Valley' modes produce the exact same resulting map image, however they are built differently; 'Valley' mode allows the map to be built without any downwards staircases, which may be easier in survival. Observe the difference:\r\n      </p>\r\n      <div style={{ textAlign: \"center\" }}>\r\n        <img alt=\"classicVsValley.png\" src={IMG_ClassicVsValley} style={{\"maxWidth\": \"75%\"}}></img>\r\n      </div>\r\n      <p>\r\n        More staircasing modes can be enabled from the <em>Extras</em> settings tab.\r\n      </p>\r\n\r\n      <b>Better color?</b>\r\n      <p>\r\n        This setting will give you more natural colors. Disabling this will make the website faster and give you slightly worse colors. It is recommended to\r\n        keep this enabled.\r\n      </p>\r\n\r\n      <b>Dithering?</b>\r\n      <p>\r\n        This will add grain to your image to make it look a lot smoother. Floyd-Steinberg dithering is the most accurate, but the Ordered/Bayer dithering will\r\n        usually have less artifacts and gives the image an unique style. It is usually recommended to disable dithering for flat-colored artwork.\r\n      </p>\r\n\r\n      <b>Presets?</b>\r\n      <p>\r\n        You can use presets to save and load block configurations. Pick your blocks and click \"Save\" to save them as a preset, pick a preset to load it and\r\n        click \"Delete\" to delete the loaded preset. It is also possible to share a link for your preset with others.\r\n      </p>\r\n\r\n      <h2>Custom Blocks</h2>\r\n      <p>Custom blocks can be added from the bottom of the blocks selection pane. Different versions of a block can be added for the same block name, eg for 1.12.2 and 1.13.2+. Some examples are provided in the 'examples' section. NBT tags / block states can be found on the <a href=\"https://minecraft.wiki/w/Block_states\" target=\"_blank\" rel=\"noopener noreferrer\">Minecraft Wiki</a>. To edit an existing custom block, select it, edit the tags / versions etc, and then click the 'add' button to overwrite. Note that presets URLs do not support custom blocks.</p>\r\n\r\n      <div style={{ textAlign: \"center\" }}>\r\n        <img alt=\"Palette\" src={IMG_Palette} />\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default FAQ;\r\n","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAAFWElEQVR42u2dS28bVRxHx5mJ37Fjx3ZsN3YebhunNEuEkHgsilCFWPJYIJD4Aiz4EvkCSF2yJEhsWNOyBUWAKOpL6kOkavNo0jaYxEnctGFVL88ggbrpOdvf+PpOc3yr+5977ySWlpaOA2Dr4lcUB9v3P8b8xgLGwbnut5iv/N3D/M3r72G+fP8y5gsL3MHr/PXBiTtjfP+pmM8Hl+Iu4PgG5xd7fAMjgbzUKIACiAKIAogCiALIy0a0uLiIF9z7I4N5rnca8wcx89hul9v/83Ef8zMPW5iP9e7wPPoEd/Bemvtf2yxhvsq3F5SDmAtqMXWA1Zg/cL/vCCAKIAogCiAKIAogCiDDaWK328ULkhWeCCc25jC/WecOnDzJ7Ve2IsxP325int/IY16vcwfzCe5/JVvFPJ3jz48HMYWGCsf1mI9HUeQIIAogCiAKIAogCiAKIMNpYqfTwQuOyryw/SDXxrzA0+RgZobbL6d4HjtXnsQ8l+OJeLXKHcw94f6XMw3MUzF1gEIQs3GgzHE1ZR1A/C9AFEAUQBRAFEAUQP41iS8+/RDPB1j77UdsYBDyvoCHuXHM58dWML+yz+vm21u8P3/l4SbmC51ZzNcPnvI0vf8M841BzG9scJfzEs/jO7vc/s/bO44AogCiAKIAogCiAKIA8pzo1PQUG3IriflhNMGFhiI/b58tcftre1wHmDoscB1h9zHm9Ql+4N7f4wUBtZDrAHsHMb+xcIPzwijGjeMQ89RO6AggCiAKIAogCiAKIAogwzrA7BSva++P8Tx9f5TPydsv8UF3rSq3P57iDfDNHd7/n0lx+9VSEfPtiOsAE8+OMN8aiWL+BNy/IObfvzbgef5oOOIIIAogCiAKIAogCiAKIMM6QKvB++u38vw8uj/K8+idIq8XaE5w+8WQ6wC1mP3/6SS3P1Hk9QT5YIB5acB1gFwQUwd4yv0L8lwHqPS5/WTkegBRAFEAUQBRAFEAUQAZkjj3WQvPB3i79To2sP6I5/ntCxcw//WDJcyj6DLmy5vLmH80+Tnmh6s/Yb49wve3tvY+5mfaX2P+xrufcJng8BvMv9s7j/n+75OOAKIAogCiAKIAogCiADKcZtems3jB2fkW5tkN3lfQjenA5tQi5qOjj7iBY45b7RmeJ+9e5QZCfnFfr8f9b1R538Li2VcwP9rn9QoXe3xOY7TedgQQBRAFEAUQBRAFEAWQ4TSxMsXn8M2f4nn+09T0f6oDXGvyFcnkLW5gj+Nmk+sYexs8T++P8PkH2Sz3f7LM7Xe785g/2eXPFx/z+w6Or5xyBBAFEAUQBRAFEAUQBZBhHaDc4P33czO8rrz3jN830InpQK3GV6RS/P3BNseT9Sbmfxf5fIFHIb/3MJPh/ldKvN6i05njOkCP+zdW4Of9T8odRwBRAFEAUQBRAFEAUQB5TiL4so0r69/5gc/L37+yjvlCndcTPEjzPP3uNq8HuPnqa5hPZPgcveIv1zC/fZ7X3Z+5yvsW3ury/V8+4t/gpeXvE44AogCiAKIAogCiAKIA8j8RBfP8vHpyhc/L3435gtk07zuIcrzuvrfD5+lHtTrm2XxMHSC9yu3HrIcocxkkOD3NdY71wYgjgCiAKIAogCiAKIAogLy4OsAc1wEqBXYk5q13QTvN+w4GWX7v4HrE3xBWqlwHKPDnC0m+/3CK2x8fP8R87gTXEa4OQkcAUQBRAFEAUQBRAFEAeXF1gDbP08t5PpA/EbNqvZlKYf5Xhs/DH4v4eX5U5vf6pceTmOdTvF4hbHD7hUIP83aD6wjlA+sAogCiAKIAogCiAKIA8sL4B0z245ksDQ2eAAAAAElFTkSuQmCC\"","import React, { Component } from \"react\";\r\nimport { Link } from \"react-router-dom\";\r\n\r\nimport \"./header.css\";\r\n\r\nclass Header extends Component {\r\n  render() {\r\n    const { getLocaleString } = this.props;\r\n    return (\r\n      <div className=\"header\">\r\n        <h3>\r\n          <Link to={`/${![undefined, \"en\"].includes(this.props.countryCode) ? this.props.countryCode + \"/\" : \"\"}faq`}>\r\n            <span className=\"FAQTextButton\">{getLocaleString(\"FAQ/FAQ\")}</span>\r\n          </Link>\r\n          <span> | </span>\r\n          <a href=\"https://youtu.be/j-4RXPkJKU8\" target=\"_blank\" rel=\"noopener noreferrer\">\r\n            {getLocaleString(\"FAQ/VIDEO-TUTORIAL\")}\r\n          </a>\r\n          <span> | </span>\r\n          <a href=\"https://github.com/mms0316/mapartcraft\" target=\"_blank\" rel=\"noopener noreferrer\">\r\n            GitHub\r\n          </a>\r\n          <span> | </span>\r\n          <a href=\"https://discord.gg/r7Tuerq\" target=\"_blank\" rel=\"noopener noreferrer\">\r\n            2b2t Mapart Discord\r\n          </a>\r\n          <span> | </span>\r\n          <a href=\"https://area51.selfadjointoperator.com/mapartcraft/\" target=\"_blank\" rel=\"noopener noreferrer\">\r\n            Beta\r\n          </a>\r\n        </h3>\r\n        <p>\r\n          {getLocaleString(\"DESCRIPTION/1\")}\r\n          <a href=\"https://www.reddit.com/r/2b2t/\" target=\"_blank\" rel=\"noopener noreferrer\">\r\n            2b2t\r\n          </a>\r\n          {getLocaleString(\"DESCRIPTION/2\")}\r\n          <br></br>\r\n          {getLocaleString(\"DESCRIPTION/3\")}\r\n          <a href=\"https://redd.it/2yck3f\" target=\"_blank\" rel=\"noopener noreferrer\">\r\n            {getLocaleString(\"DESCRIPTION/4\")}\r\n          </a>\r\n          {getLocaleString(\"DESCRIPTION/5\")}\r\n          <br></br>\r\n          <em>\r\n            {getLocaleString(\"DESCRIPTION/6\")}\r\n            <a href=\"https://rebane2001.com/mapartcraft/\" target=\"_blank\" rel=\"noopener noreferrer\">MapartCraft</a>\r\n            {getLocaleString(\"DESCRIPTION/7\")}\r\n            {\".\"}\r\n          </em>\r\n          <br></br>\r\n          <b>\r\n            {getLocaleString(\"FAQ/PLEASE-READ-1\")}\r\n            <Link to={`/${![undefined, \"en\"].includes(this.props.countryCode) ? this.props.countryCode + \"/\" : \"\"}faq`}>\r\n              <span className=\"FAQTextButton\">{getLocaleString(\"FAQ/FAQ\")}</span>\r\n            </Link>\r\n            {getLocaleString(\"FAQ/PLEASE-READ-2\")}\r\n          </b>\r\n        </p>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default Header;\r\n","export default __webpack_public_path__ + \"static/media/flag.f5d7d6f6.svg\";","export default __webpack_public_path__ + \"static/media/flag.8d48322a.svg\";","export default __webpack_public_path__ + \"static/media/flag.bca4c3c0.svg\";","export default __webpack_public_path__ + \"static/media/flag.10f89117.svg\";","export default __webpack_public_path__ + \"static/media/flag.9f898403.svg\";","export default __webpack_public_path__ + \"static/media/flag.8b3048c6.svg\";","export default __webpack_public_path__ + \"static/media/flag_pop.4947b0a4.svg\";","export default __webpack_public_path__ + \"static/media/flag.80919dec.svg\";","export default __webpack_public_path__ + \"static/media/flag.f5d8ab3c.svg\";","export default __webpack_public_path__ + \"static/media/flag.bb851604.svg\";","export default __webpack_public_path__ + \"static/media/flag.8a31a3ac.svg\";","export default __webpack_public_path__ + \"static/media/flag.85b7f971.svg\";","export default __webpack_public_path__ + \"static/media/flag.6f6e5709.svg\";","export default __webpack_public_path__ + \"static/media/flag.096c0012.svg\";","export default __webpack_public_path__ + \"static/media/flag.dcb60345.svg\";","export default __webpack_public_path__ + \"static/media/flag.04f3bfcf.svg\";","export default __webpack_public_path__ + \"static/media/flag.f018710c.svg\";","import Flag_de from \"./de/flag.svg\";\r\nimport Strings_de from \"./de/strings.json\";\r\n\r\nimport Flag_ua from \"./ua/flag.svg\";\r\nimport Strings_ua from \"./ua/strings.json\";\r\n\r\nimport Flag_en from \"./en/flag.svg\";\r\nimport Strings_en from \"./en/strings.json\";\r\n\r\nimport Flag_eo from \"./eo/flag.svg\";\r\nimport Strings_eo from \"./eo/strings.json\";\r\n\r\nimport Flag_es from \"./es/flag.svg\";\r\nimport Strings_es from \"./es/strings.json\";\r\n\r\nimport Flag_et from \"./et/flag.svg\";\r\nimport Flag_et_pop from \"./et/flag_pop.svg\";\r\nimport Strings_et from \"./et/strings.json\";\r\n\r\nimport Flag_fr from \"./fr/flag.svg\";\r\nimport Strings_fr from \"./fr/strings.json\";\r\n\r\nimport Flag_it from \"./it/flag.svg\";\r\nimport Strings_it from \"./it/strings.json\";\r\n\r\nimport Flag_lt from \"./lt/flag.svg\";\r\nimport Strings_lt from \"./lt/strings.json\";\r\n\r\nimport Flag_pt from \"./pt/flag.svg\";\r\nimport Strings_pt from \"./pt/strings.json\";\r\n\r\nimport Flag_ru from \"./ru/flag.svg\";\r\nimport Strings_ru from \"./ru/strings.json\";\r\n\r\nimport Flag_zh_Hans from \"./zh-Hans/flag.svg\";\r\nimport Strings_zh_Hans from \"./zh-Hans/strings.json\";\r\n\r\nimport Flag_zh_Hant from \"./zh-Hant/flag.svg\";\r\nimport Strings_zh_Hant from \"./zh-Hant/strings.json\";\r\n\r\nimport Flag_pl from \"./pl/flag.svg\";\r\nimport Strings_pl from \"./pl/strings.json\";\r\n\r\nimport Flag_pt_Br from \"./pt-Br/flag.svg\";\r\nimport Strings_pt_Br from \"./pt-Br/strings.json\";\r\n\r\nimport Flag_ja from \"./ja/flag.svg\";\r\nimport Strings_ja from \"./ja/strings.json\";\r\n\r\nconst Locale = {\r\n  en: { strings: Strings_en, flag: Flag_en },\r\n  ua: { strings: Strings_ua, flag: Flag_ua },\r\n  et: { strings: Strings_et, flag: Flag_et, flag_special: Flag_et_pop },\r\n  lt: { strings: Strings_lt, flag: Flag_lt },\r\n  ru: { strings: Strings_ru, flag: Flag_ru },\r\n  de: { strings: Strings_de, flag: Flag_de },\r\n  pl: { strings: Strings_pl, flag: Flag_pl },\r\n  fr: { strings: Strings_fr, flag: Flag_fr },\r\n  it: { strings: Strings_it, flag: Flag_it },\r\n  pt: { strings: Strings_pt, flag: Flag_pt },\r\n  es: { strings: Strings_es, flag: Flag_es },\r\n  \"zh-Hans\": { strings: Strings_zh_Hans, flag: Flag_zh_Hans },\r\n  \"zh-Hant\": { strings: Strings_zh_Hant, flag: Flag_zh_Hant },\r\n  ja: { strings: Strings_ja, flag: Flag_ja },\r\n  eo: { strings: Strings_eo, flag: Flag_eo },\r\n  \"pt-Br\": { strings: Strings_pt_Br, flag: Flag_pt_Br },\r\n};\r\n\r\nexport default Locale;\r\n","import React, { Component } from \"react\";\r\nimport { Link } from \"react-router-dom\";\r\n\r\nimport Locale from \"../locale/locale\";\r\n\r\nimport \"./languages.css\";\r\n\r\nclass Languages extends Component {\r\n  render() {\r\n    return (\r\n      <div className=\"languages\">\r\n        {Object.keys(Locale).map((language) => (\r\n          <div className=\"language\" key={language}>\r\n            {language === \"et\" ? (\r\n              <React.Fragment>\r\n                <Link to={`/${language}`}>\r\n                  <img src={Locale[language].flag} alt={language} className={`flag flag_${language}`} />\r\n                  <img key=\"et_pop\" src={Locale[language].flag_special} alt=\"et_pop\" className={\"flag flag_et_pop\"} />\r\n                </Link>\r\n              </React.Fragment>\r\n            ) : (\r\n              <Link to={`/${language === \"en\" ? \"\" : language}`}>\r\n                <img src={Locale[language].flag} alt={language} className={`flag flag_${language}`} />\r\n              </Link>\r\n            )}\r\n          </div>\r\n        ))}\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default Languages;\r\n","class CookieManager {\r\n  static init() {\r\n    // Handle cookie migration\r\n    const cookieNames = [\"presets\", \"mcversion\", \"customBlocks\"];\r\n    cookieNames.forEach(name => {\r\n      if (this.getCookie(`mapartcraft_${name}`) === null && this.getCookie(name) !== null) {\r\n        this.setCookie(`mapartcraft_${name}`, this.getCookie(name));\r\n      }\r\n    });\r\n  }\r\n\r\n  //Thx\r\n  //https://www.w3schools.com/js/js_cookies.asp\r\n  static setCookie(cname, cvalue) {\r\n    let d = new Date();\r\n    d.setTime(d.getTime() + 9000 * 24 * 60 * 60 * 1000);\r\n    let expires = \"expires=\" + d.toUTCString();\r\n    document.cookie = cname + \"=\" + cvalue + \";\" + expires + \";path=/\";\r\n  }\r\n\r\n  static getCookie(cname) {\r\n    let name = cname + \"=\";\r\n    let ca = document.cookie.split(\";\");\r\n    for (let i = 0; i < ca.length; i++) {\r\n      let c = ca[i];\r\n      while (c.charAt(0) === \" \") {\r\n        c = c.substring(1);\r\n      }\r\n      if (c.indexOf(name) === 0) {\r\n        return c.substring(name.length, c.length);\r\n      }\r\n    }\r\n    return null;\r\n  }\r\n\r\n  static touchCookie(cname, defaultValue) {\r\n    const cookieValue = this.getCookie(cname);\r\n    if (cookieValue !== null) {\r\n      return cookieValue;\r\n    } else {\r\n      this.setCookie(cname, defaultValue);\r\n      return defaultValue;\r\n    }\r\n  }\r\n}\r\n\r\nexport default CookieManager;\r\n","import React, { Component } from \"react\";\r\n\r\nimport \"./tooltip.css\";\r\n\r\nclass Tooltip extends Component {\r\n  state = {\r\n    hovering: false,\r\n  };\r\n\r\n  handleMouseOver = () => {\r\n    this.setState({ hovering: true });\r\n  };\r\n\r\n  handleMouseOut = () => {\r\n    this.setState({ hovering: false });\r\n  };\r\n\r\n  render() {\r\n    const tooltipStyle = this.props.textStyleOverrides !== undefined\r\n      ? {\r\n          display: this.state.hovering ? \"unset\" : \"none\",\r\n          ...this.props.textStyleOverrides,\r\n        }\r\n      : { display: this.state.hovering ? \"unset\" : \"none\" };\r\n    return (\r\n      <div className=\"tooltipContainer\">\r\n        <div onMouseOver={this.handleMouseOver} onMouseOut={this.handleMouseOut}>\r\n          {this.props.children}\r\n        </div>\r\n        <p className=\"tooltipText\" style={tooltipStyle}>\r\n          {this.props.tooltipText}\r\n        </p>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default Tooltip;\r\n","import React, { Component } from \"react\";\r\n\r\nimport SupportedVersions from \"../json/supportedVersions.json\";\r\n\r\nimport \"./blockSelectionAddCustom.css\";\r\n\r\nclass BlockSelectionAddCustom extends Component {\r\n  state = {\r\n    block_name: \"\",\r\n    block_nbtTags: [[\"\", \"\"]],\r\n    block_colourSetId: null,\r\n    block_versions: {},\r\n  };\r\n\r\n  E_KeyOrValue = {\r\n    key: 0,\r\n    value: 1,\r\n  };\r\n\r\n  examplesGroups = [\r\n    {\r\n      title: \"Stairs\",\r\n      blocks: [\r\n        {\r\n          blockName: \"birch_stairs\",\r\n          nbtTags: {\r\n            facing: \"north|east|south|west\",\r\n            half: \"top|bottom\",\r\n          },\r\n          versions: [\"1_12_2\", \"1_13_2\", \"1_14_4\", \"1_15_2\", \"1_16_5\", \"1_17_1\"],\r\n        },\r\n      ],\r\n    },\r\n    {\r\n      title: \"Slabs\",\r\n      blocks: [\r\n        {\r\n          blockName: \"stone_slab\",\r\n          nbtTags: {\r\n            variant: \"cobblestone\",\r\n            half: \"top|bottom\",\r\n          },\r\n          versions: [\"1_12_2\"],\r\n        },\r\n        {\r\n          blockName: \"cobblestone_slab\",\r\n          nbtTags: {\r\n            type: \"top|bottom\",\r\n          },\r\n          versions: [\"1_13_2\", \"1_14_4\", \"1_15_2\", \"1_16_5\", \"1_17_1\"],\r\n        },\r\n      ],\r\n    },\r\n    {\r\n      title: \"'Alpha slabs'\",\r\n      blocks: [\r\n        {\r\n          blockName: \"stone_slab\",\r\n          nbtTags: {\r\n            variant: \"wood_old\",\r\n            half: \"top|bottom\",\r\n          },\r\n          versions: [\"1_12_2\"],\r\n        },\r\n        {\r\n          blockName: \"petrified_oak_slab\",\r\n          nbtTags: {\r\n            type: \"top|bottom\",\r\n          },\r\n          versions: [\"1_13_2\", \"1_14_4\", \"1_15_2\", \"1_16_5\", \"1_17_1\"],\r\n        },\r\n      ],\r\n    },\r\n  ];\r\n\r\n  constructor(props) {\r\n    super(props);\r\n    const { coloursJSON } = props;\r\n    this.state.block_colourSetId = Object.keys(coloursJSON)[0];\r\n    for (const supportedVersion_key of Object.keys(SupportedVersions)) {\r\n      this.state.block_versions[supportedVersion_key] = false;\r\n    }\r\n  }\r\n\r\n  componentDidUpdate(prevProps) {\r\n    const { lastSelectedCustomBlock } = this.props;\r\n    if (prevProps.lastSelectedCustomBlock !== lastSelectedCustomBlock) {\r\n      this.loadBlockIntoForm(lastSelectedCustomBlock.colourSetId, lastSelectedCustomBlock.blockId);\r\n    }\r\n  }\r\n\r\n  loadBlockIntoForm(colourSetId, blockId) {\r\n    const { coloursJSON } = this.props;\r\n    const blockToLoad = coloursJSON[colourSetId].blocks[blockId];\r\n    let blockToLoad_nbtTags = [];\r\n    const versionToLoad_nbtData = Object.values(blockToLoad.validVersions).find((version) => typeof version !== \"string\");\r\n    for (const [nbtTag_key, nbtTag_value] of Object.entries(versionToLoad_nbtData.NBTArgs)) {\r\n      blockToLoad_nbtTags.push([nbtTag_key, nbtTag_value]);\r\n    }\r\n    blockToLoad_nbtTags.push([\"\", \"\"]);\r\n    const blockToLoad_versions = {};\r\n    for (const [supportedVersion_key, supportedVersion_value] of Object.entries(SupportedVersions)) {\r\n      if (supportedVersion_value.MCVersion in blockToLoad.validVersions) {\r\n        blockToLoad_versions[supportedVersion_key] = true;\r\n      } else {\r\n        blockToLoad_versions[supportedVersion_key] = false;\r\n      }\r\n    }\r\n    this.setState({\r\n      block_name: versionToLoad_nbtData.NBTName,\r\n      block_nbtTags: blockToLoad_nbtTags,\r\n      block_colourSetId: colourSetId,\r\n      block_versions: blockToLoad_versions,\r\n    });\r\n  }\r\n\r\n  onSettingChange_block_name = (e) => {\r\n    this.setState({ block_name: e.target.value });\r\n  };\r\n\r\n  onSettingChange_block_nbtTags = (e, tagIndex, keyOrValue) => {\r\n    const { block_nbtTags } = this.state;\r\n    let block_nbtTags_new = [...block_nbtTags];\r\n    block_nbtTags_new[tagIndex][keyOrValue] = e.target.value;\r\n    if (\r\n      tagIndex === block_nbtTags_new.length - 2 &&\r\n      block_nbtTags_new[block_nbtTags_new.length - 2].every((t) => t === \"\") &&\r\n      block_nbtTags_new[block_nbtTags_new.length - 1].every((t) => t === \"\")\r\n    ) {\r\n      // remove last tags inputs if they are empty and we have just made the penultimate tag inputs empty\r\n      block_nbtTags_new.pop();\r\n    } else if (tagIndex === block_nbtTags_new.length - 1) {\r\n      // always keep a blank set of inputs at the end for further tags\r\n      block_nbtTags_new.push([\"\", \"\"]);\r\n    }\r\n    this.setState({ block_nbtTags: block_nbtTags_new });\r\n  };\r\n\r\n  onSettingChange_block_colourSetId = (e) => {\r\n    this.setState({ block_colourSetId: e.target.value });\r\n  };\r\n\r\n  onSettingChange_block_versions = (versionToToggle) => {\r\n    let block_versions_new = { ...this.state.block_versions };\r\n    block_versions_new[versionToToggle] = !block_versions_new[versionToToggle];\r\n    this.setState({ block_versions: block_versions_new });\r\n  };\r\n\r\n  render() {\r\n    const { getLocaleString, coloursJSON, onAddCustomBlock, onDeleteCustomBlock } = this.props;\r\n    const { block_name, block_nbtTags, block_colourSetId, block_versions } = this.state;\r\n    const examples = (\r\n      <details open={false}>\r\n        <summary>{getLocaleString(\"BLOCK-SELECTION/ADD-CUSTOM/EXAMPLES\")}</summary>\r\n        {this.examplesGroups.map((examplesGroup) => (\r\n          <div key={examplesGroup.title}>\r\n            <b>{examplesGroup.title}</b>\r\n            {examplesGroup.blocks.map((block) => (\r\n              <div\r\n                key={block.blockName}\r\n                style={{\r\n                  outline: \"0.1em solid white\",\r\n                  padding: \"0.2em\",\r\n                  marginBlockStart: \"0.2em\",\r\n                  marginBlockEnd: \"0.2em\",\r\n                }}\r\n              >\r\n                <table>\r\n                  <tbody>\r\n                    <tr>\r\n                      <th>\r\n                        <b>\r\n                          {getLocaleString(\"BLOCK-SELECTION/ADD-CUSTOM/BLOCK-NAME\")}\r\n                          {\":\"}\r\n                        </b>{\" \"}\r\n                      </th>\r\n                      <td style={{ textAlign: \"right\" }}>\r\n                        {\"minecraft:\"}\r\n                        <input type=\"text\" value={block.blockName} disabled={true} />\r\n                      </td>\r\n                    </tr>\r\n                    <tr>\r\n                      <th>\r\n                        <b>\r\n                          {getLocaleString(\"BLOCK-SELECTION/ADD-CUSTOM/NBT-TAGS\")}\r\n                          {\":\"}\r\n                        </b>{\" \"}\r\n                      </th>\r\n                      <td style={{ textAlign: \"right\" }}>\r\n                        {Object.entries(block.nbtTags).map(([tagKey, tagValue]) => (\r\n                          <div key={tagKey}>\r\n                            <input type=\"text\" value={tagKey} disabled={true} />\r\n                            {\":\"}\r\n                            <input type=\"text\" value={tagValue} disabled={true} />\r\n                            <br />\r\n                          </div>\r\n                        ))}\r\n                      </td>\r\n                    </tr>\r\n                    <tr>\r\n                      <th>\r\n                        <b>\r\n                          {getLocaleString(\"BLOCK-SELECTION/ADD-CUSTOM/VERSIONS\")}\r\n                          {\":\"}\r\n                        </b>{\" \"}\r\n                      </th>\r\n                      <td>\r\n                        {Object.entries(SupportedVersions).map(([supportedVersion_key, supportedVersion_value]) => (\r\n                          <React.Fragment key={supportedVersion_key}>\r\n                            <input type=\"checkbox\" checked={block.versions.includes(supportedVersion_key)} disabled={true} />\r\n                            {supportedVersion_value.MCVersion}{\" \"}\r\n                          </React.Fragment>\r\n                        ))}\r\n                      </td>\r\n                    </tr>\r\n                  </tbody>\r\n                </table>\r\n              </div>\r\n            ))}\r\n            <br />\r\n          </div>\r\n        ))}\r\n      </details>\r\n    );\r\n    const setting_customBlock_name = (\r\n      <tr>\r\n        <th>\r\n          <b>\r\n            {getLocaleString(\"BLOCK-SELECTION/ADD-CUSTOM/BLOCK-NAME\")}\r\n            {\":\"}\r\n          </b>{\" \"}\r\n        </th>\r\n        <td style={{ textAlign: \"right\" }}>\r\n          {\"minecraft:\"}\r\n          <input type=\"text\" value={block_name} onChange={this.onSettingChange_block_name} />\r\n        </td>\r\n      </tr>\r\n    );\r\n    const setting_customBlock_nbtTags = (\r\n      <tr>\r\n        <th>\r\n          <b>\r\n            {getLocaleString(\"BLOCK-SELECTION/ADD-CUSTOM/NBT-TAGS\")}\r\n            {\":\"}\r\n          </b>{\" \"}\r\n        </th>\r\n        <td style={{ textAlign: \"right\" }}>\r\n          {block_nbtTags.map(([tagKey, tagValue], tagIndex) => (\r\n            <div key={tagIndex}>\r\n              <input type=\"text\" value={tagKey} onChange={(e) => this.onSettingChange_block_nbtTags(e, tagIndex, this.E_KeyOrValue.key)} />\r\n              {\":\"}\r\n              <input type=\"text\" value={tagValue} onChange={(e) => this.onSettingChange_block_nbtTags(e, tagIndex, this.E_KeyOrValue.value)} />\r\n              <br />\r\n            </div>\r\n          ))}\r\n        </td>\r\n      </tr>\r\n    );\r\n    const setting_customBlock_colourSetId = (\r\n      <tr>\r\n        <th>\r\n          <b>\r\n            {getLocaleString(\"BLOCK-SELECTION/ADD-CUSTOM/COLOUR-SET\")}\r\n            {\":\"}\r\n          </b>{\" \"}\r\n        </th>\r\n        <td>\r\n          <select\r\n            value={block_colourSetId}\r\n            onChange={this.onSettingChange_block_colourSetId}\r\n            style={{\r\n              backgroundColor: `rgb(${coloursJSON[block_colourSetId].tonesRGB.normal.join(\", \")})`,\r\n              color:\r\n                coloursJSON[block_colourSetId].tonesRGB.normal[0] * 0.299 +\r\n                  coloursJSON[block_colourSetId].tonesRGB.normal[1] * 0.587 +\r\n                  coloursJSON[block_colourSetId].tonesRGB.normal[2] * 0.114 >\r\n                186\r\n                  ? \"black\"\r\n                  : \"white\",\r\n            }}\r\n          >\r\n            {Object.entries(coloursJSON).map(([colourSetId, colourSet]) => (\r\n              <option\r\n                key={colourSetId}\r\n                value={colourSetId}\r\n                style={{\r\n                  backgroundColor: `rgb(${colourSet.tonesRGB.normal.join(\", \")})`,\r\n                  color:\r\n                    colourSet.tonesRGB.normal[0] * 0.299 + colourSet.tonesRGB.normal[1] * 0.587 + colourSet.tonesRGB.normal[2] * 0.114 > 186\r\n                      ? \"black\"\r\n                      : \"white\",\r\n                }}\r\n              >\r\n                {colourSet.colourName}\r\n              </option>\r\n            ))}\r\n          </select>\r\n        </td>\r\n      </tr>\r\n    );\r\n    const setting_customBlock_versions = (\r\n      <tr>\r\n        <th>\r\n          <b>\r\n            {getLocaleString(\"BLOCK-SELECTION/ADD-CUSTOM/VERSIONS\")}\r\n            {\":\"}\r\n          </b>{\" \"}\r\n        </th>\r\n        <td>\r\n          {Object.entries(block_versions).map(([block_version, block_version_checked]) => (\r\n            <React.Fragment key={block_version}>\r\n              <input type=\"checkbox\" checked={block_version_checked} onChange={() => this.onSettingChange_block_versions(block_version)} />\r\n              {SupportedVersions[block_version].MCVersion}{\" \"}\r\n            </React.Fragment>\r\n          ))}\r\n        </td>\r\n      </tr>\r\n    );\r\n    const customBlock_submit = (\r\n      <tr>\r\n        <th colSpan=\"2\">\r\n          <button\r\n            style={{ width: \"100%\" }}\r\n            onClick={() => onAddCustomBlock(block_colourSetId, block_name, block_nbtTags, block_versions)}\r\n          >\r\n            {getLocaleString(\"BLOCK-SELECTION/ADD-CUSTOM/ADD\")}\r\n          </button>\r\n        </th>\r\n      </tr>\r\n    );\r\n    const customBlock_delete = (\r\n      <tr>\r\n        <th colSpan=\"2\">\r\n          <button style={{ width: \"100%\" }} onClick={() => onDeleteCustomBlock(block_colourSetId, block_name, block_versions)}>\r\n            {getLocaleString(\"BLOCK-SELECTION/ADD-CUSTOM/DELETE\")}\r\n          </button>\r\n        </th>\r\n      </tr>\r\n    );\r\n    return (\r\n      <details className=\"blockSelectionAddCustom\" open={false}>\r\n        <summary>{getLocaleString(\"BLOCK-SELECTION/ADD-CUSTOM/TITLE\")}</summary>\r\n        {examples}\r\n        <table>\r\n          <tbody>\r\n            {setting_customBlock_name}\r\n            {setting_customBlock_nbtTags}\r\n            {setting_customBlock_colourSetId}\r\n            {setting_customBlock_versions}\r\n            {customBlock_submit}\r\n            {customBlock_delete}\r\n          </tbody>\r\n        </table>\r\n      </details>\r\n    );\r\n  }\r\n}\r\n\r\nexport default BlockSelectionAddCustom;\r\n","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAAySURBVFhH7c6hAQAwDMOwbP//nJH9UFCZmOq0zWT3fywAAAAAAAAAAAAAAAAAgO2A5AFAtAM9NfYR6AAAAABJRU5ErkJggg==\"","export default __webpack_public_path__ + \"static/media/textures.01da0dbb.png\";","import React, { Component } from \"react\";\r\n\r\nimport IMG_Null from \"../../images/null.png\";\r\nimport IMG_Textures from \"../../images/textures.png\";\r\n\r\nimport \"./blockImage.css\";\r\n\r\nclass BlockImage extends Component {\r\n  render() {\r\n    const { getLocaleString, coloursJSON, colourSetId, blockId, style, className, ...props_others } = this.props;\r\n    const isNone = blockId === \"-1\"; // if barrier / no block selected for colourSetId\r\n    const isUnknown = colourSetId === \"64\" && blockId === \"2\"; // if unknown / placeholder block\r\n    return (\r\n      <img\r\n        src={IMG_Null}\r\n        alt={\r\n          isNone\r\n            ? getLocaleString(\"NONE\")\r\n            : isUnknown\r\n            ? getLocaleString(\"MATERIALS/PLACEHOLDER-BLOCK-TT\")\r\n            : coloursJSON[colourSetId].blocks[blockId].displayName\r\n        }\r\n        style={\r\n          isNone\r\n            ? {\r\n                backgroundImage: `url(${IMG_Textures})`,\r\n                backgroundPositionX: \"-100%\",\r\n                backgroundPositionY: \"-6400%\",\r\n                ...style,\r\n              }\r\n            : isUnknown\r\n            ? {\r\n                backgroundImage: `url(${IMG_Textures})`,\r\n                backgroundPositionX: \"-200%\",\r\n                backgroundPositionY: \"-6400%\",\r\n                ...style,\r\n              }\r\n            : coloursJSON[colourSetId].blocks[blockId].presetIndex === \"CUSTOM\"\r\n            ? {\r\n                backgroundImage: `url(${IMG_Textures})`,\r\n                backgroundPositionX: \"-500%\",\r\n                backgroundPositionY: \"-6400%\",\r\n                backgroundColor: `rgb(${coloursJSON[colourSetId].tonesRGB.normal.join(\", \")})`,\r\n                ...style,\r\n              }\r\n            : {\r\n                backgroundImage: `url(${IMG_Textures})`,\r\n                backgroundPositionX: `-${blockId}00%`,\r\n                backgroundPositionY: `-${colourSetId}00%`,\r\n                ...style,\r\n              }\r\n        }\r\n        className={`blockImage ${className}`}\r\n        {...props_others}\r\n      />\r\n    );\r\n  }\r\n}\r\n\r\nexport default BlockImage;\r\n","import React, { Component } from \"react\";\r\n\r\nimport Tooltip from \"../tooltip\";\r\nimport BlockSelectionAddCustom from \"./blockSelectionAddCustom/blockSelectionAddCustom\";\r\nimport BlockImage from \"./blockImage\";\r\n\r\nimport MapModes from \"./json/mapModes.json\";\r\nimport SupportedVersions from \"./json/supportedVersions.json\";\r\n\r\nimport \"./blockSelection.css\";\r\n\r\nclass BlockSelection extends Component {\r\n  state = {\r\n    lastSelectedCustomBlock: null, // {colourSetId, blockId}\r\n  };\r\n\r\n  cssRGB(RGBArray) {\r\n    // RGB array to css compatible string\r\n    return `rgb(${RGBArray.join(\", \")})`;\r\n  }\r\n\r\n  getColourSetBox = (colourSet) => {\r\n    const { optionValue_staircasing } = this.props;\r\n    let background;\r\n    switch (optionValue_staircasing) {\r\n      case MapModes.SCHEMATIC_NBT.staircaseModes.OFF.uniqueId:\r\n      case MapModes.MAPDAT.staircaseModes.OFF.uniqueId: {\r\n        background = this.cssRGB(colourSet.tonesRGB.normal);\r\n        break;\r\n      }\r\n      case MapModes.SCHEMATIC_NBT.staircaseModes.CLASSIC.uniqueId:\r\n      case MapModes.SCHEMATIC_NBT.staircaseModes.VALLEY.uniqueId:\r\n      case MapModes.MAPDAT.staircaseModes.ON.uniqueId: {\r\n        background = `linear-gradient(${this.cssRGB(colourSet.tonesRGB.dark)} 33%, ${this.cssRGB(colourSet.tonesRGB.normal)} 33%, ${this.cssRGB(\r\n          colourSet.tonesRGB.normal\r\n        )} 66%, ${this.cssRGB(colourSet.tonesRGB.light)} 66%)`;\r\n        break;\r\n      }\r\n      case MapModes.MAPDAT.staircaseModes.ON_UNOBTAINABLE.uniqueId: {\r\n        background = `linear-gradient(${this.cssRGB(colourSet.tonesRGB.unobtainable)} 25%, ${this.cssRGB(colourSet.tonesRGB.dark)} 25%, ${this.cssRGB(\r\n          colourSet.tonesRGB.dark\r\n        )} 50%, ${this.cssRGB(colourSet.tonesRGB.normal)} 50%, ${this.cssRGB(colourSet.tonesRGB.normal)} 75%, ${this.cssRGB(colourSet.tonesRGB.light)} 75%)`;\r\n        break;\r\n      }\r\n      case MapModes.SCHEMATIC_NBT.staircaseModes.FULL_DARK.uniqueId:\r\n      case MapModes.MAPDAT.staircaseModes.FULL_DARK.uniqueId: {\r\n        background = this.cssRGB(colourSet.tonesRGB.dark);\r\n        break;\r\n      }\r\n      case MapModes.SCHEMATIC_NBT.staircaseModes.FULL_LIGHT.uniqueId:\r\n      case MapModes.MAPDAT.staircaseModes.FULL_LIGHT.uniqueId: {\r\n        background = this.cssRGB(colourSet.tonesRGB.light);\r\n        break;\r\n      }\r\n      case MapModes.MAPDAT.staircaseModes.FULL_UNOBTAINABLE.uniqueId: {\r\n        background = this.cssRGB(colourSet.tonesRGB.unobtainable);\r\n        break;\r\n      }\r\n      default: {\r\n        throw new Error(\"Unknown staircasing value\");\r\n      }\r\n    }\r\n    return (\r\n      <div\r\n        className=\"colourSetBox\"\r\n        style={{\r\n          background: background,\r\n        }}\r\n      />\r\n    );\r\n  };\r\n\r\n  render() {\r\n    const {\r\n      coloursJSON,\r\n      getLocaleString,\r\n      onChangeColourSetBlock,\r\n      optionValue_version,\r\n      selectedBlocks,\r\n      presets,\r\n      selectedPresetName,\r\n      canDeletePreset,\r\n      onPresetChange,\r\n      onDeletePreset,\r\n      onSavePreset,\r\n      onSharePreset,\r\n      onGetPDNPaletteClicked,\r\n      handleAddCustomBlock,\r\n      handleDeleteCustomBlock,\r\n    } = this.props;\r\n    const { lastSelectedCustomBlock } = this.state;\r\n    const presetsManagement = (\r\n      <React.Fragment>\r\n        <h2 id=\"blockselectiontitle\">{getLocaleString(\"BLOCK-SELECTION/TITLE\")}</h2>\r\n        <b>\r\n          {getLocaleString(\"BLOCK-SELECTION/PRESETS/TITLE\")}\r\n          {\":\"}\r\n        </b>{\" \"}\r\n        <select id=\"presets\" value={selectedPresetName} onChange={onPresetChange}>\r\n          <option value=\"None\">{getLocaleString(\"BLOCK-SELECTION/PRESETS/NONE\")}</option>\r\n          {presets.map((preset) => (\r\n            <option value={preset.name} key={preset.name}>\r\n              {\"localeKey\" in preset ? getLocaleString(preset.localeKey) : preset.name}\r\n            </option>\r\n          ))}\r\n        </select>\r\n        <button type=\"button\" disabled={!canDeletePreset()} onClick={onDeletePreset}>\r\n          {getLocaleString(\"BLOCK-SELECTION/PRESETS/DELETE\")}\r\n        </button>\r\n        <button type=\"button\" onClick={onSavePreset}>\r\n          {getLocaleString(\"BLOCK-SELECTION/PRESETS/SAVE\")}\r\n        </button>\r\n        <Tooltip tooltipText={getLocaleString(\"BLOCK-SELECTION/PRESETS/SHARE-TT\")}>\r\n          <button type=\"button\" onClick={onSharePreset}>\r\n            {getLocaleString(\"BLOCK-SELECTION/PRESETS/SHARE\")}\r\n          </button>\r\n        </Tooltip>\r\n        <Tooltip tooltipText={getLocaleString(\"BLOCK-SELECTION/PRESETS/DOWNLOAD-TT\")}>\r\n          <button type=\"button\" onClick={onGetPDNPaletteClicked}>\r\n            {getLocaleString(\"BLOCK-SELECTION/PRESETS/DOWNLOAD\")}\r\n          </button>\r\n        </Tooltip>\r\n      </React.Fragment>\r\n    );\r\n    const blockSelection = (\r\n      <React.Fragment>\r\n        {Object.entries(coloursJSON)\r\n          .filter(([, colourSet]) => Object.values(colourSet.blocks).some((block) => Object.keys(block.validVersions).includes(optionValue_version.MCVersion)))\r\n          .map(([colourSetId, colourSet]) => (\r\n            <div key={colourSetId} className=\"colourSet\">\r\n              {this.getColourSetBox(colourSet)}\r\n              <label>\r\n                <Tooltip tooltipText={getLocaleString(\"NONE\")}>\r\n                  <BlockImage\r\n                    getLocaleString={getLocaleString}\r\n                    coloursJSON={coloursJSON}\r\n                    colourSetId={colourSetId}\r\n                    blockId={\"-1\"}\r\n                    onClick={() => onChangeColourSetBlock(colourSetId, \"-1\")}\r\n                    style={{\r\n                      cursor: \"pointer\",\r\n                      ...(selectedBlocks[colourSetId] === \"-1\" && {\r\n                        filter: \"drop-shadow(0 0 4px #658968)\",\r\n                        backgroundColor: \"#658968\",\r\n                      }),\r\n                    }}\r\n                  />\r\n                </Tooltip>\r\n              </label>\r\n              <div className={\"colourSetBlocks\"}>\r\n                {Object.entries(colourSet.blocks)\r\n                  .filter(([, block]) => Object.keys(block.validVersions).includes(optionValue_version.MCVersion))\r\n                  .map(([blockId, block]) => (\r\n                    <label key={blockId}>\r\n                      <Tooltip tooltipText={block.displayName}>\r\n                        {selectedBlocks[colourSetId] === blockId &&\r\n                          !(Object.values(SupportedVersions)[Object.keys(SupportedVersions).length - 1].MCVersion in block.validVersions) && (\r\n                            // if doesn't support latest version\r\n                            <div\r\n                              style={{\r\n                                position: \"absolute\",\r\n                                paddingLeft: \"28px\",\r\n                                zIndex: 110,\r\n                              }}\r\n                            >\r\n                              <Tooltip\r\n                                tooltipText={`${getLocaleString(\"BLOCK-SELECTION/UNSUPPORTED-PAST\")} ${\r\n                                  Object.keys(block.validVersions)[Object.keys(block.validVersions).length - 1]\r\n                                }`}\r\n                                textStyleOverrides={{\r\n                                  whiteSpace: \"nowrap\",\r\n                                  backgroundColor: \"red\",\r\n                                }}\r\n                              >\r\n                                <h2 style={{ backgroundColor: \"red\", margin: \"0\" }}>{\"!\"}</h2>\r\n                              </Tooltip>\r\n                            </div>\r\n                          )}\r\n                        <BlockImage\r\n                          coloursJSON={coloursJSON}\r\n                          colourSetId={colourSetId}\r\n                          blockId={blockId}\r\n                          onClick={() => {\r\n                            onChangeColourSetBlock(colourSetId, blockId);\r\n                            if (block.presetIndex === \"CUSTOM\") {\r\n                              this.setState({ lastSelectedCustomBlock: { colourSetId, blockId } });\r\n                            }\r\n                          }}\r\n                          style={{\r\n                            cursor: \"pointer\",\r\n                            ...(selectedBlocks[colourSetId] === blockId && {\r\n                              filter: \"drop-shadow(0 0 4px #658968)\",\r\n                              ...(block.presetIndex !== \"CUSTOM\" && {\r\n                                backgroundColor: \"#658968\",\r\n                              }),\r\n                            }),\r\n                          }}\r\n                        />\r\n                      </Tooltip>\r\n                    </label>\r\n                  ))}\r\n              </div>\r\n            </div>\r\n          ))}\r\n      </React.Fragment>\r\n    );\r\n    return (\r\n      <div className=\"section blockSelectionDiv\">\r\n        {presetsManagement}\r\n        {blockSelection}\r\n        <BlockSelectionAddCustom\r\n          getLocaleString={getLocaleString}\r\n          coloursJSON={coloursJSON}\r\n          onAddCustomBlock={handleAddCustomBlock}\r\n          onDeleteCustomBlock={handleDeleteCustomBlock}\r\n          lastSelectedCustomBlock={lastSelectedCustomBlock}\r\n        />\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default BlockSelection;\r\n","export default class WorkerBuilder extends Worker {\r\n  constructor(worker) {\r\n    let code = worker.toString();\r\n    code = code.substring(code.indexOf(\"{\") + 1, code.lastIndexOf(\"}\"));\r\n    const blob = new Blob([code], { type: \"application/javascript\" });\r\n    return new Worker(URL.createObjectURL(blob));\r\n  }\r\n}\r\n","// eslint-disable-next-line import/no-anonymous-default-export\r\n// eslint-disable-next-line no-restricted-globals\r\n\r\nexport default function NBTWorker (args) {\r\n\r\n// begin variables passed in onmessage\r\nvar coloursJSON;\r\nvar MapModes;\r\nvar optionValue_version;\r\nvar optionValue_staircasing;\r\nvar optionValue_supportBlock;\r\nvar pixelsData;\r\nvar maps;\r\nvar currentSelectedBlocks;\r\n// end onmessage variables\r\n\r\nvar exactColourCache = new Map(); // for mapping RGB that exactly matches in coloursJSON to colourSetId and tone\r\n\r\nvar progressReportHead;\r\n\r\n/*\r\n  A mapping from type names to NBT type numbers.\r\n  This is NOT just an enum, these values have to stay as they are\r\n  https://minecraft.wiki/w/NBT_format#TAG_definition\r\n*/\r\nconst TagTypes = {\r\n  end: 0,\r\n  byte: 1,\r\n  short: 2,\r\n  int: 3,\r\n  long: 4,\r\n  float: 5,\r\n  double: 6,\r\n  byteArray: 7,\r\n  string: 8,\r\n  list: 9,\r\n  compound: 10,\r\n  intArray: 11,\r\n  longArray: 12,\r\n};\r\n\r\nclass NBTWriter {\r\n  constructor() {\r\n    if (typeof ArrayBuffer === \"undefined\") {\r\n      throw new Error(\"Missing required type ArrayBuffer\");\r\n    }\r\n    if (typeof DataView === \"undefined\") {\r\n      throw new Error(\"Missing required type DataView\");\r\n    }\r\n    if (typeof Uint8Array === \"undefined\") {\r\n      throw new Error(\"Missing required type Uint8Array\");\r\n    }\r\n    /* Will be auto-resized (x2) on write if necessary. */\r\n    this.buffer = new ArrayBuffer(1024);\r\n\r\n    /* These are recreated when the buffer is */\r\n    this.dataView = new DataView(this.buffer);\r\n    this.arrayView = new Uint8Array(this.buffer);\r\n    this.offset = 0;\r\n  }\r\n\r\n  encodeUTF8(str) {\r\n    let array = [],\r\n      i,\r\n      c;\r\n    for (i = 0; i < str.length; i++) {\r\n      c = str.charCodeAt(i);\r\n      if (c === 0x0) {\r\n        array.push(0xc0);\r\n        array.push(0x80);\r\n      } else if (c < 0x80) {\r\n        array.push(c);\r\n      } else if (c < 0x800) {\r\n        array.push(0xc0 | (c >> 6));\r\n        array.push(0x80 | (c & 0x3f));\r\n      } else if (c < 0x10000) {\r\n        array.push(0xe0 | (c >> 12));\r\n        array.push(0x80 | ((c >> 6) & 0x3f));\r\n        array.push(0x80 | (c & 0x3f));\r\n      } else {\r\n        // unsure if this is accurate, however we never need such exotic unicode characters\r\n        array.push(0xf0 | ((c >> 18) & 0x07));\r\n        array.push(0x80 | ((c >> 12) & 0x3f));\r\n        array.push(0x80 | ((c >> 6) & 0x3f));\r\n        array.push(0x80 | (c & 0x3f));\r\n      }\r\n    }\r\n    return array;\r\n  }\r\n\r\n  accommodate(size) {\r\n    // Ensures that the buffer is large enough to write `size` bytes at the current `this.offset`.\r\n    let requiredLength = this.offset + size;\r\n    if (this.buffer.byteLength >= requiredLength) {\r\n      return;\r\n    }\r\n\r\n    let newLength = this.buffer.byteLength;\r\n    while (newLength < requiredLength) {\r\n      newLength *= 2;\r\n    }\r\n    let newBuffer = new ArrayBuffer(newLength);\r\n    let newArrayView = new Uint8Array(newBuffer);\r\n    newArrayView.set(this.arrayView);\r\n\r\n    // If there's a gap between the end of the old buffer\r\n    // and the start of the new one, we need to zero it out\r\n    if (this.offset > this.buffer.byteLength) {\r\n      newArrayView.fill(0, this.buffer.byteLength, this.offset);\r\n    }\r\n\r\n    this.buffer = newBuffer;\r\n    this.dataView = new DataView(newBuffer);\r\n    this.arrayView = newArrayView;\r\n  }\r\n\r\n  write(dataType, size, value) {\r\n    this.accommodate(size);\r\n    this.dataView[`set${dataType}`](this.offset, value);\r\n    this.offset += size;\r\n  }\r\n\r\n  writeByType(dataType, value) {\r\n    switch (dataType) {\r\n      case TagTypes.end: {\r\n        this.writeByType(TagTypes.byte, 0);\r\n        break;\r\n      }\r\n      case TagTypes.byte: {\r\n        this.write(\"Int8\", 1, value);\r\n        break;\r\n      }\r\n      case TagTypes.short: {\r\n        this.write(\"Int16\", 2, value);\r\n        break;\r\n      }\r\n      case TagTypes.int: {\r\n        this.write(\"Int32\", 4, value);\r\n        break;\r\n      }\r\n      case TagTypes.long: {\r\n        // NB: special: JS doesn't support native 64 bit ints; pass an array of two 32 bit ints to this case\r\n        this.write(\"Int32\", 4, value[0]);\r\n        this.write(\"Int32\", 4, value[1]);\r\n        break;\r\n      }\r\n      case TagTypes.float: {\r\n        this.write(\"Float32\", 4, value);\r\n        break;\r\n      }\r\n      case TagTypes.double: {\r\n        this.write(\"Float64\", 8, value);\r\n        break;\r\n      }\r\n      case TagTypes.byteArray: {\r\n        this.writeByType(TagTypes.int, value.length);\r\n        this.accommodate(value.length);\r\n        this.arrayView.set(value, this.offset);\r\n        this.offset += value.length;\r\n        break;\r\n      }\r\n      case TagTypes.string: {\r\n        let bytes = this.encodeUTF8(value);\r\n        this.writeByType(TagTypes.short, bytes.length);\r\n        this.accommodate(bytes.length);\r\n        this.arrayView.set(bytes, this.offset);\r\n        this.offset += bytes.length;\r\n        break;\r\n      }\r\n      case TagTypes.list: {\r\n        // Pass a dicitonary {\"type\": TagTypes.blah, \"value\": [] }\r\n        this.writeByType(TagTypes.byte, value.type);\r\n        this.writeByType(TagTypes.int, value.value.length);\r\n        for (let i = 0; i < value.value.length; i++) {\r\n          this.writeByType(value.type, value.value[i]);\r\n        }\r\n        break;\r\n      }\r\n      case TagTypes.compound: {\r\n        // This is the rich tagtype we will interact with a lot\r\n        // Pass a dictionary {\"type\": TagTypes.blah, \"value\": ... }\r\n        // {\r\n        //   author: { type: TagTypes.string, value: \"Steve\" },\r\n        //   stuff: {\r\n        //       type: TagTypes.compound,\r\n        //       value: {\r\n        //         foo: { type: int, value: 42 },\r\n        //         bar: { type: string, value: 'Hi!' }\r\n        //       }\r\n        //   }\r\n        // }\r\n        Object.keys(value).forEach((key) => {\r\n          this.writeByType(TagTypes.byte, value[key].type);\r\n          this.writeByType(TagTypes.string, key);\r\n          this.writeByType(value[key].type, value[key].value); // this is where the nice recursion happens\r\n        });\r\n        this.writeByType(TagTypes.end, 0);\r\n        break;\r\n      }\r\n      case TagTypes.intArray: {\r\n        this.writeByType(TagTypes.int, value.length);\r\n        for (let i = 0; i < value.length; i++) {\r\n          this.writeByType(TagTypes.int, value[i]);\r\n          // https://lkml.org/lkml/2012/7/6/495\r\n        }\r\n        break;\r\n      }\r\n      case TagTypes.longArray: {\r\n        this.writeByType(TagTypes.int, value.length);\r\n        for (let i = 0; i < value.length; i++) {\r\n          this.writeByType(TagTypes.long, value[i]);\r\n          // NB this is an array of longs given as specified in case:long\r\n        }\r\n        break;\r\n      }\r\n      case \"UBYTE\": {\r\n        // unsure why this is here, seems unused; nbt raw bytes (TagTypes.byte) are signed\r\n        this.write(\"Uint8\", 1, value);\r\n        break;\r\n      }\r\n      default: {\r\n        throw new Error(`Unknown data type ${dataType} for value ${value}`);\r\n      }\r\n    }\r\n  }\r\n\r\n  writeTopLevelCompound(value) {\r\n    // For writing a top level JSON object as a compound tag.\r\n    // This is of the form {\"name\": \"blah\", \"value\": {...}}\r\n    // This is not just this.writeByType(TagTypes.compound, value); we add the appropriate compound prefix etc\r\n    this.writeByType(TagTypes.byte, TagTypes.compound);\r\n    this.writeByType(TagTypes.string, value.name);\r\n    this.writeByType(TagTypes.compound, value.value);\r\n  }\r\n\r\n  getData() {\r\n    /*\r\n      Returns the writen data as a slice from the internal buffer, cutting off any padding at the end.\r\n    */\r\n    this.accommodate(0); /* make sure the offset is inside the buffer */\r\n    return this.buffer.slice(0, this.offset);\r\n  }\r\n}\r\n\r\nclass Map_NBT {\r\n  constructor(map) {\r\n    this.mapColoursLayout = map.coloursLayout;\r\n    this.mapMaterialsCounts = map.materials;\r\n    this.NBT_json = {\r\n      name: \"\",\r\n      value: {\r\n        blocks: {\r\n          type: TagTypes.list,\r\n          value: {\r\n            type: TagTypes.compound,\r\n            value: [],\r\n          },\r\n        },\r\n        entities: {\r\n          type: TagTypes.list,\r\n          value: {\r\n            type: TagTypes.compound,\r\n            value: [],\r\n          },\r\n        },\r\n        palette: {\r\n          type: TagTypes.list,\r\n          value: {\r\n            type: TagTypes.compound,\r\n            value: [],\r\n          },\r\n        },\r\n        size: {\r\n          type: TagTypes.list,\r\n          value: {\r\n            type: TagTypes.int,\r\n            value: [], // X, Y, Z\r\n          },\r\n        },\r\n        author: {\r\n          type: TagTypes.string,\r\n          value: \"mms0316.github.io/mapartcraft\",\r\n        },\r\n        DataVersion: {\r\n          type: TagTypes.int,\r\n          value: null,\r\n        },\r\n      },\r\n    };\r\n    this.physicalLayout = [];\r\n    this.palette_colourSetId_paletteId = {}; // map coloursJSON colourSetIds to index of corresponding block in palette list\r\n    this.palette_paletteId_colourSetId = []; // map paletteIds (index of an item in this list) to colourSetIds\r\n    this.columnHeightsCache = []; // appended to in getPhysicalLayout_individualColumn, used in setNBT_json_size\r\n  }\r\n\r\n  constructPaletteLookups() {\r\n    // filter $materials to colourSetIds with non-zero materials count\r\n    const nonZeroMaterials = Object.fromEntries(Object.entries(this.mapMaterialsCounts).filter(([_, value]) => value !== 0));\r\n    // now construct palette lookups for non-zero colourSetIds\r\n    Object.keys(nonZeroMaterials).forEach((colourSetId) => {\r\n      this.palette_colourSetId_paletteId[colourSetId] = this.palette_paletteId_colourSetId.length;\r\n      this.palette_paletteId_colourSetId.push(colourSetId);\r\n    });\r\n    // finally add noobline/scaffold material at the end, special key\r\n    this.palette_colourSetId_paletteId[\"NOOBLINE_SCAFFOLD\"] = this.palette_paletteId_colourSetId.length;\r\n    this.palette_paletteId_colourSetId.push(\"NOOBLINE_SCAFFOLD\");\r\n  }\r\n\r\n  setNBT_json_palette() {\r\n    this.palette_paletteId_colourSetId.forEach((colourSetId) => {\r\n      let paletteItemToPush = {};\r\n      if (colourSetId === \"NOOBLINE_SCAFFOLD\") {\r\n        paletteItemToPush.Name = {\r\n          type: TagTypes.string,\r\n          value: `minecraft:${optionValue_supportBlock.toLowerCase()}`,\r\n        };\r\n        // we expect the support block to be something non-exotic with no properties eg netherrack\r\n      } else {\r\n        let blockNBTData = coloursJSON[colourSetId].blocks[currentSelectedBlocks[colourSetId]].validVersions[optionValue_version.MCVersion];\r\n        if (typeof blockNBTData === \"string\") {\r\n          // this is of the form eg \"&1.12.2\"\r\n          blockNBTData = coloursJSON[colourSetId].blocks[currentSelectedBlocks[colourSetId]].validVersions[blockNBTData.slice(1)];\r\n        }\r\n        paletteItemToPush.Name = {\r\n          type: TagTypes.string,\r\n          value: `minecraft:${blockNBTData.NBTName}`,\r\n        };\r\n        if (Object.keys(blockNBTData.NBTArgs).length !== 0) {\r\n          paletteItemToPush.Properties = { type: TagTypes.compound, value: {} };\r\n          Object.keys(blockNBTData.NBTArgs).forEach((NBTArg_key) => {\r\n            paletteItemToPush.Properties.value[NBTArg_key] = {\r\n              type: TagTypes.string,\r\n              value: blockNBTData.NBTArgs[NBTArg_key],\r\n            };\r\n          });\r\n        }\r\n      }\r\n      this.NBT_json.value.palette.value.value.push(paletteItemToPush);\r\n    });\r\n  }\r\n\r\n  setNBT_json_DataVersion() {\r\n    this.NBT_json.value.DataVersion.value = optionValue_version.NBTVersion;\r\n  }\r\n\r\n  returnPhysicalBlock(x, y, z, colourSetId) {\r\n    return {\r\n      pos: { type: TagTypes.list, value: { type: TagTypes.int, value: [x, y, z] } },\r\n      state: { type: TagTypes.int, value: this.palette_colourSetId_paletteId[colourSetId] },\r\n    };\r\n  }\r\n\r\n  getPhysicalLayout() {\r\n    for (let columnNumber = 0; columnNumber < this.mapColoursLayout.length; columnNumber++) {\r\n      this.getPhysicalLayout_individualColumn(columnNumber);\r\n      postMessage({\r\n        head: progressReportHead,\r\n        body: (columnNumber + 1) / this.mapColoursLayout.length,\r\n      });\r\n    }\r\n  }\r\n\r\n  getPhysicalLayout_individualColumn(columnNumber) {\r\n    const mapColoursLayoutColumn = this.mapColoursLayout[columnNumber];\r\n    let physicalColumn = [];\r\n    let currentHeight;\r\n    switch (optionValue_staircasing) {\r\n      case MapModes.SCHEMATIC_NBT.staircaseModes.OFF.uniqueId: {\r\n        // start at y = 2 for flat maps; this covers the cases of support blocks 1 and or 2 blocks below\r\n        currentHeight = 2;\r\n        break;\r\n      }\r\n      case MapModes.SCHEMATIC_NBT.staircaseModes.CLASSIC.uniqueId:\r\n      case MapModes.SCHEMATIC_NBT.staircaseModes.VALLEY.uniqueId: {\r\n        // this doesn't matter\r\n        // in the classic case each column is later adjusted to have its global minimum at y = 0 so the map has a common base / is as short as possible\r\n        // in the valley case valleys are pulled down to y = 0\r\n        currentHeight = 0;\r\n        break;\r\n      }\r\n      case MapModes.SCHEMATIC_NBT.staircaseModes.FULL_DARK.uniqueId: {\r\n        // staircase descends from noobline southwards\r\n        currentHeight = 1 + mapColoursLayoutColumn.length;\r\n        break;\r\n      }\r\n      case MapModes.SCHEMATIC_NBT.staircaseModes.FULL_LIGHT.uniqueId: {\r\n        // staircase ascends from noobline southwards\r\n        currentHeight = 1;\r\n        break;\r\n      }\r\n      default: {\r\n        throw new Error(\"Unknown staircase mode\");\r\n      }\r\n    }\r\n\r\n    // initialize noobline\r\n    physicalColumn.push(this.returnPhysicalBlock(columnNumber, currentHeight, 0, \"NOOBLINE_SCAFFOLD\"));\r\n\r\n    for (let rowNumber = 0; rowNumber < mapColoursLayoutColumn.length; rowNumber++) {\r\n      const coloursLayoutBlock = mapColoursLayoutColumn[rowNumber];\r\n\r\n      const previousHeight = currentHeight;\r\n      switch (coloursLayoutBlock.tone) {\r\n        case \"dark\": {\r\n          currentHeight -= 1;\r\n          break;\r\n        }\r\n        case \"normal\": {\r\n          break;\r\n        }\r\n        case \"light\": {\r\n          currentHeight += 1;\r\n          break;\r\n        }\r\n        default: {\r\n          throw new Error(\"Unknown tone type\");\r\n        }\r\n      }\r\n\r\n      physicalColumn.push(this.returnPhysicalBlock(columnNumber, currentHeight, rowNumber + 1, coloursLayoutBlock.colourSetId));\r\n      // the + 1 is because the noobline offsets everything South one block\r\n\r\n    }\r\n\r\n    // sort in terms of z and y, necessary for determining when a plateau has finished in valley mode, and correct noobline heights in map preview\r\n    physicalColumn.sort((elt1, elt2) => {\r\n      if (elt1.pos.value.value[2] < elt2.pos.value.value[2]) {\r\n        return -1;\r\n      } else if (elt1.pos.value.value[2] > elt2.pos.value.value[2]) {\r\n        // smaller Z first\r\n        return 1;\r\n      } else {\r\n        if (elt1.pos.value.value[1] > elt2.pos.value.value[1]) {\r\n          return -1;\r\n        } else {\r\n          // higher Y first\r\n          return 1;\r\n        }\r\n      }\r\n    });\r\n\r\n    switch (optionValue_staircasing) {\r\n      case MapModes.SCHEMATIC_NBT.staircaseModes.VALLEY.uniqueId: {\r\n        let plateaus = [{ startIndex: 0, endIndex: 0 }];\r\n        // initial 0 width plateau useful just so we don't have a special case for the first proper plateau later\r\n        let ascending = false; // weakly ascending\r\n        let currentPlateauStartIndex = null;\r\n        let visibleBlocksHeight = physicalColumn[0].pos.value.value[1]; // initialise to noobline height\r\n        // visible blocks are blocks at the top height in a x-z column, the actual map blocks that give the colours\r\n\r\n        for (let i = 0; i < physicalColumn.length; i++) {\r\n          const physicalBlock = physicalColumn[i];\r\n          if (this.palette_paletteId_colourSetId[physicalBlock.state.value] === \"NOOBLINE_SCAFFOLD\") {\r\n            continue;\r\n          }\r\n          if (ascending && physicalBlock.pos.value.value[1] < visibleBlocksHeight) {\r\n            // dark after ascent; plateau found\r\n            ascending = false;\r\n            plateaus.push({\r\n              startIndex: currentPlateauStartIndex,\r\n              endIndex: i,\r\n            });\r\n          } else if (physicalBlock.pos.value.value[1] > visibleBlocksHeight) {\r\n            // light\r\n            ascending = true;\r\n            currentPlateauStartIndex = i;\r\n          }\r\n          visibleBlocksHeight = physicalBlock.pos.value.value[1];\r\n        }\r\n\r\n        plateaus.push({ startIndex: physicalColumn.length, endIndex: physicalColumn.length });\r\n\r\n        let nonPlateauPulldownHeights = [Number.MAX_SAFE_INTEGER, Number.MAX_SAFE_INTEGER];\r\n        while (plateaus.length !== 1) {\r\n          let pullDownHeight = Number.MAX_SAFE_INTEGER;\r\n          for (let i = plateaus[0].endIndex; i < plateaus[1].startIndex; i++) {\r\n            pullDownHeight = Math.min(physicalColumn[i].pos.value.value[1], pullDownHeight);\r\n          }\r\n          for (let i = plateaus[0].endIndex; i < plateaus[1].startIndex; i++) {\r\n            physicalColumn[i].pos.value.value[1] -= pullDownHeight;\r\n          }\r\n          nonPlateauPulldownHeights[1] = pullDownHeight;\r\n          const plateauPulldownHeight = Math.min(...nonPlateauPulldownHeights);\r\n          // we pull down a plateau by the minimum of the two values the surrounding non-plateaus were pulled down by\r\n          for (let i = plateaus[0].startIndex; i < plateaus[0].endIndex; i++) {\r\n            physicalColumn[i].pos.value.value[1] -= plateauPulldownHeight;\r\n          }\r\n          plateaus.shift();\r\n          nonPlateauPulldownHeights[0] = nonPlateauPulldownHeights[1];\r\n        }\r\n        break;\r\n      }\r\n      case MapModes.SCHEMATIC_NBT.staircaseModes.CLASSIC.uniqueId: {\r\n        // make sure the column's global minimum is at y = 0; doing this for every column gives the map a common base.\r\n        const columnMinimumY = physicalColumn.reduce((a, b) => (a.pos.value.value[1] < b.pos.value.value[1] ? a : b)).pos.value.value[1];\r\n        physicalColumn.forEach((block) => {\r\n          block.pos.value.value[1] -= columnMinimumY;\r\n        });\r\n        break;\r\n      }\r\n      case MapModes.SCHEMATIC_NBT.staircaseModes.OFF.uniqueId:\r\n      case MapModes.SCHEMATIC_NBT.staircaseModes.FULL_DARK.uniqueId:\r\n      case MapModes.SCHEMATIC_NBT.staircaseModes.FULL_LIGHT.uniqueId: {\r\n        break;\r\n      }\r\n      default: {\r\n        throw new Error(\"Unknown staircase mode\");\r\n      }\r\n    }\r\n\r\n    this.NBT_json.value.blocks.value.value = this.NBT_json.value.blocks.value.value.concat(physicalColumn);\r\n    this.columnHeightsCache.push(physicalColumn.reduce((a, b) => (a.pos.value.value[1] > b.pos.value.value[1] ? a : b)).pos.value.value[1]);\r\n  }\r\n\r\n  setNBT_json_blocks() {\r\n    this.getPhysicalLayout();\r\n  }\r\n\r\n  setNBT_json_size() {\r\n    this.NBT_json.value.size.value.value = [\r\n      this.mapColoursLayout.length,\r\n      this.columnHeightsCache.reduce((a, b) => (a > b ? a : b)) + 1,\r\n      this.mapColoursLayout[0].length + 1,\r\n    ];\r\n  }\r\n\r\n  getNBT() {\r\n    this.constructPaletteLookups();\r\n    this.setNBT_json_palette();\r\n    this.setNBT_json_DataVersion();\r\n    this.setNBT_json_blocks();\r\n    this.setNBT_json_size();\r\n\r\n    // console.log(NBT_json);\r\n\r\n    let nbtWriter = new NBTWriter();\r\n    nbtWriter.writeTopLevelCompound(this.NBT_json);\r\n    return nbtWriter.getData();\r\n  }\r\n}\r\n\r\nclass Map_Mapdat {\r\n  constructor(map) {\r\n    this.coloursLayout = map.coloursLayout;\r\n\r\n    const dataVersion = optionValue_version.NBTVersion;\r\n\r\n    this.NBT_json = {\r\n      name: \"\",\r\n      value: {\r\n        data: {\r\n          type: TagTypes.compound,\r\n          value: {\r\n            scale: { type: TagTypes.byte, value: 0 },\r\n            dimension: {\r\n              type: dataVersion >= 2566 ? TagTypes.string : TagTypes.byte,\r\n              value: dataVersion >= 2566 ? \"minecraft:overworld\" : dataVersion > 1343 ? 0 : -128,\r\n            },\r\n            unlimitedTracking: { type: TagTypes.byte, value: 0 },\r\n            trackingPosition: { type: TagTypes.byte, value: 0 },\r\n            locked: { type: TagTypes.byte, value: 1 },\r\n            height: { type: TagTypes.short, value: 128 },\r\n            width: { type: TagTypes.short, value: 128 },\r\n            xCenter: { type: TagTypes.int, value: 0 },\r\n            zCenter: { type: TagTypes.int, value: 0 },\r\n            colors: { type: TagTypes.byteArray, value: new Uint8Array(16384) },\r\n          },\r\n        },\r\n        DataVersion: { type: TagTypes.int, value: dataVersion },\r\n      },\r\n    };\r\n  }\r\n\r\n  setNBT_json_colors() {\r\n    for (let x = 0; x < 128; x++) {\r\n      for (let z = 0; z < 128; z++) {\r\n        const pixel = this.coloursLayout[x][z];\r\n        const arrayOffset = z * 128 + x;\r\n        let mapdatId; // coloursJSON contains the base mapdatId that is multiplied by 4 and added to by one of 0,1,2,3\r\n        if (pixel.colourSetId === \"-1\") {\r\n          // special colourSetId for transparent maps\r\n          mapdatId = 1;\r\n        } else {\r\n          switch (pixel.tone) {\r\n            case \"dark\": {\r\n              mapdatId = 4 * coloursJSON[pixel.colourSetId].mapdatId;\r\n              break;\r\n            }\r\n            case \"normal\": {\r\n              mapdatId = 4 * coloursJSON[pixel.colourSetId].mapdatId + 1;\r\n              break;\r\n            }\r\n            case \"light\": {\r\n              mapdatId = 4 * coloursJSON[pixel.colourSetId].mapdatId + 2;\r\n              break;\r\n            }\r\n            case \"unobtainable\": {\r\n              mapdatId = 4 * coloursJSON[pixel.colourSetId].mapdatId + 3;\r\n              break;\r\n            }\r\n            default: {\r\n              throw new Error(\"Unknown colour tone\");\r\n            }\r\n          }\r\n        }\r\n        this.NBT_json.value.data.value.colors.value[arrayOffset] = mapdatId;\r\n      }\r\n      postMessage({\r\n        head: progressReportHead,\r\n        body: (x + 1) / 128,\r\n      });\r\n    }\r\n  }\r\n\r\n  getNBT() {\r\n    this.setNBT_json_colors();\r\n\r\n    let nbtWriter = new NBTWriter();\r\n    nbtWriter.writeTopLevelCompound(this.NBT_json);\r\n    return nbtWriter.getData();\r\n  }\r\n}\r\n\r\nfunction setupExactColourCache() {\r\n  // we do not care what staircasing option is selected etc as this does not matter\r\n  // this is for exactly matching colours, whose values are never repeated in coloursJSON\r\n  // also RGB could be easily changed to RGBA if Mojang ever added absolute black #000000 and we need to distinguish it from transparent\r\n  // setupExactColourCache also exists in mapCanvas.jsworker but without the \"-1\" colourSet for transparent\r\n  for (const [colourSetId, colourSet] of Object.entries(coloursJSON)) {\r\n    for (const [toneKey, toneRGB] of Object.entries(colourSet.tonesRGB)) {\r\n      const RGBBinary = (toneRGB[0] << 16) + (toneRGB[1] << 8) + toneRGB[2];\r\n      exactColourCache.set(RGBBinary, {\r\n        colourSetId: colourSetId,\r\n        tone: toneKey,\r\n      });\r\n    }\r\n  }\r\n  exactColourCache.set(0, {\r\n    // special transparent for mapdat\r\n    colourSetId: \"-1\",\r\n    tone: \"normal\",\r\n  });\r\n}\r\n\r\nfunction exactRGBToColourSetIdAndTone(pixelRGB) {\r\n  const RGBBinary = (pixelRGB[0] << 16) + (pixelRGB[1] << 8) + pixelRGB[2];\r\n  return exactColourCache.get(RGBBinary);\r\n}\r\n\r\nfunction isSupportBlockMandatoryForColourSetIdAndTone(colourSetIdAndTone) {\r\n  return coloursJSON[colourSetIdAndTone.colourSetId].blocks[currentSelectedBlocks[colourSetIdAndTone.colourSetId]].supportBlockMandatory;\r\n}\r\n\r\nfunction mergeMaps() {\r\n  // for when we want one big NBT instead of split 1x1s\r\n  maps.forEach((rowOfMaps) => {\r\n    for (let whichMap_x = 1; whichMap_x < rowOfMaps.length; whichMap_x++) {\r\n      rowOfMaps[0].coloursLayout = rowOfMaps[0].coloursLayout.concat(rowOfMaps[whichMap_x].coloursLayout); // merge along x-axis\r\n    }\r\n  });\r\n  for (let i = 0; i < maps[0][0].coloursLayout.length; i++) {\r\n    // for each column in resulting map\r\n    for (let j = 1; j < maps.length; j++) {\r\n      // for each column needing to be merged into resulting map\r\n      maps[0][0].coloursLayout[i] = maps[0][0].coloursLayout[i].concat(maps[j][0].coloursLayout[i]);\r\n    }\r\n  }\r\n  // Merge materials counts for lookup\r\n  let materials_new = {};\r\n  Object.keys(coloursJSON).forEach((colourSetId) => {\r\n    materials_new[colourSetId] = 0;\r\n  });\r\n  maps.forEach((rowOfMaps) => {\r\n    rowOfMaps.forEach((map) => {\r\n      Object.keys(map.materials).forEach((colourSetId) => {\r\n        materials_new[colourSetId] += map.materials[colourSetId];\r\n      });\r\n    });\r\n  });\r\n  maps[0][0].materials = materials_new;\r\n  maps = [[maps[0][0]]];\r\n}\r\n\r\nfunction setupColoursLayoutsFromPixelsData() {\r\n  const mapSize_x = maps[0].length;\r\n  const mapSize_z = maps.length;\r\n  for (let whichMap_z = 0; whichMap_z < mapSize_z; whichMap_z++) {\r\n    for (let whichMap_x = 0; whichMap_x < mapSize_x; whichMap_x++) {\r\n      let coloursLayout = [];\r\n      for (let columnNumber = 0; columnNumber < 128; columnNumber++) {\r\n        let coloursLayout_columnToPush = [];\r\n        for (let rowNumber = 0; rowNumber < 128; rowNumber++) {\r\n          const pixelsData_offset = 4 * (128 * mapSize_x * (128 * whichMap_z + rowNumber) + 128 * whichMap_x + columnNumber);\r\n          const colourSetIdAndTone = exactRGBToColourSetIdAndTone([\r\n            pixelsData[pixelsData_offset],\r\n            pixelsData[pixelsData_offset + 1],\r\n            pixelsData[pixelsData_offset + 2],\r\n          ]);\r\n          coloursLayout_columnToPush.push(colourSetIdAndTone);\r\n        }\r\n        coloursLayout.push(coloursLayout_columnToPush);\r\n      }\r\n      maps[whichMap_z][whichMap_x].coloursLayout = coloursLayout;\r\n    }\r\n  }\r\n}\r\n\r\nonmessage = (e) => {\r\n  coloursJSON = e.data.body.coloursJSON;\r\n  MapModes = e.data.body.MapModes;\r\n  optionValue_version = e.data.body.optionValue_version;\r\n  optionValue_staircasing = e.data.body.optionValue_staircasing;\r\n  optionValue_supportBlock = e.data.body.optionValue_supportBlock;\r\n  pixelsData = e.data.body.pixelsData;\r\n  maps = e.data.body.maps;\r\n  currentSelectedBlocks = e.data.body.currentSelectedBlocks;\r\n\r\n  const headerMessage = e.data.head;\r\n\r\n  setupExactColourCache();\r\n  setupColoursLayoutsFromPixelsData();\r\n\r\n  if ([\"CREATE_NBT_JOINED_FOR_VIEW_ONLINE\", \"CREATE_NBT_JOINED\"].includes(headerMessage)) {\r\n    mergeMaps();\r\n  }\r\n\r\n  progressReportHead = `PROGRESS_REPORT_${headerMessage}`;\r\n\r\n  switch (headerMessage) {\r\n    case \"CREATE_NBT_JOINED_FOR_VIEW_ONLINE\":\r\n    case \"CREATE_NBT_JOINED\":\r\n    case \"CREATE_NBT_SPLIT\": {\r\n      for (let whichMap_y = 0; whichMap_y < maps.length; whichMap_y++) {\r\n        for (let whichMap_x = 0; whichMap_x < maps[0].length; whichMap_x++) {\r\n          const map_NBT = new Map_NBT(maps[whichMap_y][whichMap_x]);\r\n          const NBT_Array = map_NBT.getNBT();\r\n          postMessage({\r\n            head: headerMessage === \"CREATE_NBT_JOINED_FOR_VIEW_ONLINE\" ? \"NBT_FOR_VIEW_ONLINE\" : \"NBT_ARRAY\",\r\n            body: {\r\n              whichMap_x: whichMap_x,\r\n              whichMap_y: whichMap_y,\r\n              NBT_Array: NBT_Array,\r\n            },\r\n          });\r\n        }\r\n      }\r\n      break;\r\n    }\r\n    case \"CREATE_MAPDAT_SPLIT\":\r\n    case \"CREATE_MAPDAT_SPLIT_ZIP\": {\r\n      for (let whichMap_y = 0; whichMap_y < maps.length; whichMap_y++) {\r\n        for (let whichMap_x = 0; whichMap_x < maps[0].length; whichMap_x++) {\r\n          const map_Mapdat = new Map_Mapdat(maps[whichMap_y][whichMap_x]);\r\n          const Mapdat_Bytes = map_Mapdat.getNBT();\r\n          postMessage({\r\n            head: headerMessage === \"CREATE_MAPDAT_SPLIT_ZIP\" ? \"MAPDAT_BYTES_ZIP\" : \"MAPDAT_BYTES\",\r\n            body: {\r\n              whichMap_x: whichMap_x,\r\n              whichMap_y: whichMap_y,\r\n              Mapdat_Bytes: Mapdat_Bytes,\r\n            },\r\n          });\r\n        }\r\n      }\r\n      break;\r\n    }\r\n    default: {\r\n      throw new Error(\"Unknown header message\");\r\n    }\r\n  }\r\n};\r\n\r\n};\r\n","import React, { Component } from \"react\";\r\nimport { gzip } from \"pako\"; // blocks when zipping\r\nimport JSZip from \"jszip\";\r\n\r\nimport Tooltip from \"../tooltip\";\r\n\r\nimport MapModes from \"./json/mapModes.json\";\r\n\r\nimport WorkerBuilder from './workers/worker-builder';\r\nimport NBTWorker from \"./workers/nbt\";\r\n\r\nimport \"./greenButtons.css\";\r\n\r\nclass GreenButtons extends Component {\r\n  // For download buttons and donate link etc\r\n  state = {\r\n    buttonWidth_viewOnline: 1,\r\n    buttonWidth_NBT_Joined: 1,\r\n    buttonWidth_NBT_Split: 1,\r\n    buttonWidth_Mapdat_Split: 1,\r\n    mapPreviewWorker_onFinishCallback: null,\r\n  };\r\n\r\n  nbtWorker = new WorkerBuilder(NBTWorker);\r\n\r\n  resetButtonWidths() {\r\n    this.setState({\r\n      buttonWidth_viewOnline: 1,\r\n      buttonWidth_NBT_Joined: 1,\r\n      buttonWidth_NBT_Split: 1,\r\n      buttonWidth_Mapdat_Split: 1,\r\n    });\r\n  }\r\n\r\n  getNBT_base = (workerHeader) => {\r\n    const {\r\n      getLocaleString,\r\n      coloursJSON,\r\n      optionValue_version,\r\n      optionValue_mapSize_x,\r\n      optionValue_mapSize_y,\r\n      optionValue_staircasing,\r\n      optionValue_supportBlock,\r\n      optionValue_mapdatFilenameUseId,\r\n      optionValue_mapdatFilenameIdStart,\r\n      uploadedImage_baseFilename,\r\n      currentMaterialsData,\r\n      mapPreviewWorker_inProgress,\r\n      downloadBlobFile,\r\n      onGetViewOnlineNBT,\r\n    } = this.props;\r\n    if (mapPreviewWorker_inProgress) {\r\n      this.setState({ mapPreviewWorker_onFinishCallback: () => this.getNBT_base(workerHeader) });\r\n      return;\r\n    }\r\n    if (Object.entries(currentMaterialsData.currentSelectedBlocks).every((elt) => elt[1] === \"-1\")) {\r\n      alert(getLocaleString(\"DOWNLOAD/ERROR-NONE-SELECTED\"));\r\n      return;\r\n    }\r\n    this.nbtWorker.terminate();\r\n    this.resetButtonWidths();\r\n    let numberOfSplitsCalculated = 0;\r\n    let zipFile = new JSZip();\r\n    const t0 = performance.now();\r\n    this.nbtWorker = new WorkerBuilder(NBTWorker);\r\n    this.nbtWorker.onmessage = (e) => {\r\n      switch (e.data.head) {\r\n        case \"PROGRESS_REPORT_CREATE_NBT_JOINED_FOR_VIEW_ONLINE\": {\r\n          this.setState({ buttonWidth_viewOnline: e.data.body });\r\n          break;\r\n        }\r\n        case \"PROGRESS_REPORT_CREATE_NBT_JOINED\": {\r\n          this.setState({ buttonWidth_NBT_Joined: e.data.body });\r\n          break;\r\n        }\r\n        case \"PROGRESS_REPORT_CREATE_NBT_SPLIT\": {\r\n          this.setState({ buttonWidth_NBT_Split: (numberOfSplitsCalculated + e.data.body) / (optionValue_mapSize_x * optionValue_mapSize_y) });\r\n          break;\r\n        }\r\n        case \"PROGRESS_REPORT_CREATE_MAPDAT_SPLIT\": {\r\n          this.setState({ buttonWidth_Mapdat_Split: (numberOfSplitsCalculated + e.data.body) / (optionValue_mapSize_x * optionValue_mapSize_y) });\r\n          break;\r\n        }\r\n        case \"NBT_FOR_VIEW_ONLINE\": {\r\n          const t1 = performance.now();\r\n          console.log(`Created NBT for 'view online' by ${(t1 - t0).toString()}ms`);\r\n          const { NBT_Array } = e.data.body;\r\n          onGetViewOnlineNBT(NBT_Array);\r\n          break;\r\n        }\r\n        case \"NBT_ARRAY\": {\r\n          const t1 = performance.now();\r\n          console.log(`Created NBT by ${(t1 - t0).toString()}ms`);\r\n          numberOfSplitsCalculated++;\r\n          const { NBT_Array, whichMap_x, whichMap_y } = e.data.body;\r\n          const NBT_Array_gzipped = gzip(NBT_Array);\r\n          if (workerHeader === \"CREATE_NBT_SPLIT\") {\r\n            zipFile.file(`${uploadedImage_baseFilename}_${whichMap_x}_${whichMap_y}.nbt`, NBT_Array_gzipped);\r\n            if (numberOfSplitsCalculated === optionValue_mapSize_x * optionValue_mapSize_y) {\r\n              zipFile.generateAsync({ type: \"blob\" }).then((content) => {\r\n                downloadBlobFile(content, `${uploadedImage_baseFilename}.zip`);\r\n              });\r\n            }\r\n          } else {\r\n            const downloadBlob = new Blob([NBT_Array_gzipped], { type: \"application/x-minecraft-level\" });\r\n            downloadBlobFile(downloadBlob, `${uploadedImage_baseFilename}.nbt`);\r\n          }\r\n          break;\r\n        }\r\n        case \"MAPDAT_BYTES\": {\r\n          const t1 = performance.now();\r\n          console.log(`Created Mapdat by ${(t1 - t0).toString()}ms`);\r\n          numberOfSplitsCalculated++;\r\n          const { Mapdat_Bytes, whichMap_x, whichMap_y } = e.data.body;\r\n          const Mapdat_Bytes_gzipped = gzip(Mapdat_Bytes);\r\n          const downloadBlob = new Blob([Mapdat_Bytes_gzipped], { type: \"application/x-minecraft-level\" });\r\n          downloadBlobFile(downloadBlob, optionValue_mapdatFilenameUseId\r\n            ? `map_${(optionValue_mapdatFilenameIdStart + whichMap_y * optionValue_mapSize_x + whichMap_x).toString()}.dat`\r\n            : `${uploadedImage_baseFilename}_${whichMap_x.toString()}_${whichMap_y.toString()}.dat`);\r\n          break;\r\n        }\r\n        case \"MAPDAT_BYTES_ZIP\": {\r\n          const t1 = performance.now();\r\n          console.log(`Created Mapdat by ${(t1 - t0).toString()}ms`);\r\n          numberOfSplitsCalculated++;\r\n          const { Mapdat_Bytes, whichMap_x, whichMap_y } = e.data.body;\r\n          const Mapdat_Bytes_gzipped = gzip(Mapdat_Bytes);\r\n          zipFile.file(\r\n            optionValue_mapdatFilenameUseId\r\n              ? `map_${(optionValue_mapdatFilenameIdStart + whichMap_y * optionValue_mapSize_x + whichMap_x).toString()}.dat`\r\n              : `${uploadedImage_baseFilename}_${whichMap_x.toString()}_${whichMap_y.toString()}.dat`,\r\n            Mapdat_Bytes_gzipped\r\n          );\r\n          if (numberOfSplitsCalculated === optionValue_mapSize_x * optionValue_mapSize_y) {\r\n            zipFile.generateAsync({ type: \"blob\" }).then((content) => {\r\n              downloadBlobFile(content, `${uploadedImage_baseFilename}.zip`);\r\n            });\r\n          }\r\n          break;\r\n        }\r\n        default: {\r\n          throw new Error(\"Unknown worker response header\");\r\n        }\r\n      }\r\n    };\r\n    this.nbtWorker.postMessage({\r\n      head: workerHeader,\r\n      body: {\r\n        coloursJSON: coloursJSON,\r\n        MapModes: MapModes,\r\n        optionValue_version: optionValue_version,\r\n        optionValue_staircasing: optionValue_staircasing,\r\n        optionValue_supportBlock: optionValue_supportBlock,\r\n        pixelsData: currentMaterialsData.pixelsData,\r\n        maps: currentMaterialsData.maps,\r\n        currentSelectedBlocks: currentMaterialsData.currentSelectedBlocks,\r\n      },\r\n    });\r\n  };\r\n\r\n  onViewOnlineClicked = () => {\r\n    this.getNBT_base(\"CREATE_NBT_JOINED_FOR_VIEW_ONLINE\");\r\n  };\r\n\r\n  onGetNBTClicked = () => {\r\n    this.getNBT_base(\"CREATE_NBT_JOINED\");\r\n  };\r\n\r\n  onGetNBTSplitClicked = () => {\r\n    this.getNBT_base(\"CREATE_NBT_SPLIT\");\r\n  };\r\n\r\n  onGetMapdatSplitClicked = () => {\r\n    this.getNBT_base(\"CREATE_MAPDAT_SPLIT\");\r\n  };\r\n\r\n  onGetMapdatSplitZipClicked = () => {\r\n    this.getNBT_base(\"CREATE_MAPDAT_SPLIT_ZIP\");\r\n  };\r\n\r\n  componentDidUpdate_shouldNBTWorkerTerminate(prevProps) {\r\n    const {\r\n      selectedBlocks,\r\n      optionValue_version,\r\n      optionValue_modeNBTOrMapdat,\r\n      optionValue_mapSize_x,\r\n      optionValue_mapSize_y,\r\n      optionValue_cropImage,\r\n      optionValue_cropImage_zoom,\r\n      optionValue_cropImage_percent_x,\r\n      optionValue_cropImage_percent_y,\r\n      optionValue_staircasing,\r\n      optionValue_supportBlock,\r\n      optionValue_transparency,\r\n      optionValue_transparencyTolerance,\r\n      optionValue_mapdatFilenameUseId,\r\n      optionValue_mapdatFilenameIdStart,\r\n      optionValue_betterColour,\r\n      optionValue_dithering,\r\n      optionValue_dithering_propagation_red,\r\n      optionValue_dithering_propagation_green,\r\n      optionValue_dithering_propagation_blue, \r\n      optionValue_preprocessingEnabled,\r\n      preProcessingValue_brightness,\r\n      preProcessingValue_contrast,\r\n      preProcessingValue_saturation,\r\n      preProcessingValue_backgroundColourSelect,\r\n      preProcessingValue_backgroundColour,\r\n      uploadedImage,\r\n    } = this.props;\r\n    return [\r\n      prevProps.selectedBlocks !== selectedBlocks,\r\n      prevProps.optionValue_version !== optionValue_version,\r\n      prevProps.optionValue_modeNBTOrMapdat !== optionValue_modeNBTOrMapdat,\r\n      prevProps.optionValue_mapSize_x !== optionValue_mapSize_x,\r\n      prevProps.optionValue_mapSize_y !== optionValue_mapSize_y,\r\n      prevProps.optionValue_cropImage !== optionValue_cropImage,\r\n      prevProps.optionValue_cropImage_zoom !== optionValue_cropImage_zoom,\r\n      prevProps.optionValue_cropImage_percent_x !== optionValue_cropImage_percent_x,\r\n      prevProps.optionValue_cropImage_percent_y !== optionValue_cropImage_percent_y,\r\n      prevProps.optionValue_staircasing !== optionValue_staircasing,\r\n      prevProps.optionValue_supportBlock !== optionValue_supportBlock,\r\n      prevProps.optionValue_transparency !== optionValue_transparency,\r\n      prevProps.optionValue_transparencyTolerance !== optionValue_transparencyTolerance,\r\n      prevProps.optionValue_mapdatFilenameUseId !== optionValue_mapdatFilenameUseId,\r\n      prevProps.optionValue_mapdatFilenameIdStart !== optionValue_mapdatFilenameIdStart,\r\n      prevProps.optionValue_betterColour !== optionValue_betterColour,\r\n      prevProps.optionValue_dithering !== optionValue_dithering,\r\n      prevProps.optionValue_dithering_propagation_red !== optionValue_dithering_propagation_red,\r\n      prevProps.optionValue_dithering_propagation_green !== optionValue_dithering_propagation_green,\r\n      prevProps.optionValue_dithering_propagation_blue !== optionValue_dithering_propagation_blue,\r\n      prevProps.optionValue_preprocessingEnabled !== optionValue_preprocessingEnabled,\r\n      prevProps.preProcessingValue_brightness !== preProcessingValue_brightness,\r\n      prevProps.preProcessingValue_contrast !== preProcessingValue_contrast,\r\n      prevProps.preProcessingValue_saturation !== preProcessingValue_saturation,\r\n      prevProps.preProcessingValue_backgroundColourSelect !== preProcessingValue_backgroundColourSelect,\r\n      prevProps.preProcessingValue_backgroundColour !== preProcessingValue_backgroundColour,\r\n      prevProps.uploadedImage !== uploadedImage,\r\n    ].some((elt) => elt);\r\n  }\r\n\r\n  componentDidUpdate(prevProps) {\r\n    const { mapPreviewWorker_inProgress } = this.props;\r\n    if (this.componentDidUpdate_shouldNBTWorkerTerminate(prevProps)) {\r\n      // reset callback if setting changed\r\n      this.nbtWorker.terminate();\r\n      this.resetButtonWidths();\r\n      this.setState({ mapPreviewWorker_onFinishCallback: null });\r\n    } else if (!mapPreviewWorker_inProgress && this.state.mapPreviewWorker_onFinishCallback !== null) {\r\n      this.state.mapPreviewWorker_onFinishCallback();\r\n      this.setState({ mapPreviewWorker_onFinishCallback: null });\r\n    }\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    this.nbtWorker.terminate();\r\n  }\r\n\r\n  render() {\r\n    const { buttonWidth_viewOnline, buttonWidth_NBT_Joined, buttonWidth_NBT_Split, buttonWidth_Mapdat_Split } = this.state;\r\n    const { getLocaleString, optionValue_modeNBTOrMapdat } = this.props;\r\n    let buttons_mapModeConditional;\r\n    // dummy text used in divs with absolutely positioned children to create correct container height\r\n    if (optionValue_modeNBTOrMapdat === MapModes.SCHEMATIC_NBT.uniqueId) {\r\n      buttons_mapModeConditional = (\r\n        <React.Fragment>\r\n          <Tooltip tooltipText={getLocaleString(\"VIEW-ONLINE/TITLE-TT\")}>\r\n            <div className=\"greenButton\" onClick={this.onViewOnlineClicked}>\r\n              <span className=\"greenButton_text_dummy\">{getLocaleString(\"VIEW-ONLINE/TITLE\")}</span>\r\n              <span className=\"greenButton_text\">{getLocaleString(\"VIEW-ONLINE/TITLE\")}</span>\r\n              <div\r\n                className=\"greenButton_progressDiv\"\r\n                style={{\r\n                  width: `${Math.floor(buttonWidth_viewOnline * 100)}%`,\r\n                }}\r\n              />\r\n            </div>\r\n          </Tooltip>\r\n          <br />\r\n          <Tooltip tooltipText={getLocaleString(\"DOWNLOAD/NBT-SPECIFIC/DOWNLOAD-TT\")}>\r\n            <div className=\"greenButton\" onClick={this.onGetNBTClicked}>\r\n              <span className=\"greenButton_large_text_dummy\">{getLocaleString(\"DOWNLOAD/NBT-SPECIFIC/DOWNLOAD\")}</span>\r\n              <span className=\"greenButton_large_text\">{getLocaleString(\"DOWNLOAD/NBT-SPECIFIC/DOWNLOAD\")}</span>\r\n              <div\r\n                className=\"greenButton_progressDiv\"\r\n                style={{\r\n                  width: `${Math.floor(buttonWidth_NBT_Joined * 100)}%`,\r\n                }}\r\n              />\r\n            </div>\r\n          </Tooltip>\r\n          <br />\r\n          <Tooltip tooltipText={getLocaleString(\"DOWNLOAD/NBT-SPECIFIC/DOWNLOAD-SPLIT-TT\")}>\r\n            <div className=\"greenButton\" onClick={this.onGetNBTSplitClicked}>\r\n              <span className=\"greenButton_text_dummy\">{`${getLocaleString(\"DOWNLOAD/NBT-SPECIFIC/DOWNLOAD-SPLIT\")} .ZIP`}</span>\r\n              <span className=\"greenButton_text\">{`${getLocaleString(\"DOWNLOAD/NBT-SPECIFIC/DOWNLOAD-SPLIT\")} .ZIP`}</span>\r\n              <div\r\n                className=\"greenButton_progressDiv\"\r\n                style={{\r\n                  width: `${Math.floor(buttonWidth_NBT_Split * 100)}%`,\r\n                }}\r\n              />\r\n            </div>\r\n          </Tooltip>\r\n          <br />\r\n        </React.Fragment>\r\n      );\r\n    } else {\r\n      buttons_mapModeConditional = (\r\n        <React.Fragment>\r\n          <Tooltip tooltipText={getLocaleString(\"DOWNLOAD/MAPDAT-SPECIFIC/DOWNLOAD-TT\")}>\r\n            <div className=\"greenButton\" onClick={this.onGetMapdatSplitClicked}>\r\n              <span className=\"greenButton_large_text_dummy\">{`${getLocaleString(\"DOWNLOAD/MAPDAT-SPECIFIC/DOWNLOAD\")}`}</span>\r\n              <span className=\"greenButton_large_text\">{`${getLocaleString(\"DOWNLOAD/MAPDAT-SPECIFIC/DOWNLOAD\")}`}</span>\r\n              <div\r\n                className=\"greenButton_progressDiv\"\r\n                style={{\r\n                  width: `${Math.floor(buttonWidth_Mapdat_Split * 100)}%`,\r\n                }}\r\n              />\r\n            </div>\r\n          </Tooltip>\r\n          <br />\r\n          <Tooltip tooltipText={getLocaleString(\"DOWNLOAD/MAPDAT-SPECIFIC/DOWNLOAD-TT\")}>\r\n            <div className=\"greenButton\" onClick={this.onGetMapdatSplitZipClicked}>\r\n              <span className=\"greenButton_large_text_dummy\">{`${getLocaleString(\"DOWNLOAD/MAPDAT-SPECIFIC/DOWNLOAD\")} .ZIP`}</span>\r\n              <span className=\"greenButton_large_text\">{`${getLocaleString(\"DOWNLOAD/MAPDAT-SPECIFIC/DOWNLOAD\")} .ZIP`}</span>\r\n              <div\r\n                className=\"greenButton_progressDiv\"\r\n                style={{\r\n                  width: `${Math.floor(buttonWidth_Mapdat_Split * 100)}%`,\r\n                }}\r\n              />\r\n            </div>\r\n          </Tooltip>\r\n          <br />\r\n        </React.Fragment>\r\n      );\r\n    }\r\n    const button_donate = (\r\n      <React.Fragment>\r\n        <Tooltip tooltipText={getLocaleString(\"DONATE/TITLE-TT\")}>\r\n          <div className=\"greenButton\">\r\n            <a style={{ textDecoration: \"none\" }} href=\"https://rebane2001.com/mapartcraft/supporters\" target=\"_blank\" rel=\"noopener noreferrer\">\r\n              <span className=\"greenButton_text_dummy\" style={{ backgroundColor: \"#688e6b\", color: \"#333333\" }}>\r\n                {getLocaleString(\"DONATE/TITLE\")}\r\n              </span>\r\n              <span className=\"greenButton_text\" style={{ backgroundColor: \"#688e6b\", color: \"#333333\" }}>\r\n                {getLocaleString(\"DONATE/TITLE\")}\r\n              </span>\r\n            </a>\r\n          </div>\r\n        </Tooltip>\r\n      </React.Fragment>\r\n    );\r\n    const buttonsDiv = (\r\n      <div>\r\n        {buttons_mapModeConditional}\r\n        {button_donate}\r\n      </div>\r\n    );\r\n    return buttonsDiv;\r\n  }\r\n}\r\n\r\nexport default GreenButtons;\r\n","// eslint-disable-next-line import/no-anonymous-default-export\r\n// eslint-disable-next-line no-restricted-globals\r\n\r\nexport default function MapWorker (args) {\r\n\r\nvar coloursJSON;\r\nvar MapModes;\r\nvar DitherMethods;\r\nvar canvasImageData;\r\nvar selectedBlocks;\r\nvar optionValue_modeNBTOrMapdat;\r\nvar optionValue_mapSize_x;\r\nvar optionValue_mapSize_y;\r\nvar optionValue_staircasing;\r\nvar optionValue_transparency;\r\nvar optionValue_transparencyTolerance;\r\nvar optionValue_betterColour;\r\nvar optionValue_dithering;\r\nvar optionValue_dithering_propagation_red;\r\nvar optionValue_dithering_propagation_green;\r\nvar optionValue_dithering_propagation_blue;\r\n\r\nvar colourSetsToUse = []; // colourSetIds and shades to use in map\r\nvar exactColourCache = new Map(); // for mapping RGB that exactly matches in coloursJSON to colourSetId and tone\r\nvar colourCache = new Map(); // cache for reusing colours in identical pixels\r\nvar labCache = new Map();\r\n\r\nvar maps = [];\r\n\r\n/*\r\n  'maps' is a matrix with entries accessable via maps[z][x], each of which corresponds to a 128x128 map. A typical entry is:\r\n  { materials: {}, supportBlockCount: 128 }\r\n  'materials' is a dictionary with keys corresponding to colourSetIds and entries being the number of blocks from this colourSet required to make the map.\r\n*/\r\n\r\n// rgb2lab conversion based on the one from redstonehelper's program\r\nfunction rgb2lab(rgb) {\r\n  let val = (rgb[0] << 16) + (rgb[1] << 8) + rgb[2];\r\n  if (labCache.has(val)) return labCache.get(val);\r\n\r\n  let r1 = rgb[0] / 255.0;\r\n  let g1 = rgb[1] / 255.0;\r\n  let b1 = rgb[2] / 255.0;\r\n\r\n  r1 = 0.04045 >= r1 ? (r1 /= 12.0) : Math.pow((r1 + 0.055) / 1.055, 2.4);\r\n  g1 = 0.04045 >= g1 ? (g1 /= 12.0) : Math.pow((g1 + 0.055) / 1.055, 2.4);\r\n  b1 = 0.04045 >= b1 ? (b1 /= 12.0) : Math.pow((b1 + 0.055) / 1.055, 2.4);\r\n  let f = (0.43605202 * r1 + 0.3850816 * g1 + 0.14308742 * b1) / 0.964221,\r\n    h = 0.22249159 * r1 + 0.71688604 * g1 + 0.060621485 * b1,\r\n    k = (0.013929122 * r1 + 0.097097 * g1 + 0.7141855 * b1) / 0.825211,\r\n    l = 0.008856452 < h ? Math.pow(h, 1 / 3) : (903.2963 * h + 16.0) / 116.0,\r\n    m = 500.0 * ((0.008856452 < f ? Math.pow(f, 1 / 3) : (903.2963 * f + 16.0) / 116.0) - l),\r\n    n = 200.0 * (l - (0.008856452 < k ? Math.pow(k, 1 / 3) : (903.2963 * k + 16.0) / 116.0));\r\n\r\n  rgb = [2.55 * (116.0 * l - 16.0) + 0.5, m + 0.5, n + 0.5];\r\n  labCache.set(val, rgb);\r\n  return rgb;\r\n}\r\n\r\nfunction squaredEuclideanMetricColours(pixel1, pixel2) {\r\n  if (optionValue_betterColour) {\r\n    //return deltaE(rgb2lab(pixel1),rgb2lab(pixel2))\r\n    pixel1 = rgb2lab(pixel1);\r\n    pixel2 = rgb2lab(pixel2);\r\n  }\r\n  const r = pixel1[0] - pixel2[0];\r\n  const g = pixel1[1] - pixel2[1];\r\n  const b = pixel1[2] - pixel2[2];\r\n  return r * r + g * g + b * b; // actually L*a*b* if optionValue_betterColour but metric is calculated the same\r\n}\r\n\r\nfunction findClosestColourSetIdAndToneAndRGBTo(pixelRGB) {\r\n  let RGBBinary = (pixelRGB[0] << 16) + (pixelRGB[1] << 8) + pixelRGB[2]; // injective mapping RGB to concatenated binaries\r\n  if (colourCache.has(RGBBinary)) {\r\n    return colourCache.get(RGBBinary);\r\n  } else {\r\n    let shortestDistance = 9999999;\r\n    let closestPixel;\r\n\r\n    colourSetsToUse.forEach((colourSet) => {\r\n      Object.keys(colourSet.tonesRGB).forEach((toneKey) => {\r\n        const toneRGB = colourSet.tonesRGB[toneKey];\r\n        let squareDistance = squaredEuclideanMetricColours(toneRGB, pixelRGB);\r\n        if (squareDistance < shortestDistance) {\r\n          shortestDistance = squareDistance;\r\n          closestPixel = {\r\n            colourSetId: colourSet.colourSetId,\r\n            tone: toneKey,\r\n          };\r\n        }\r\n      });\r\n    });\r\n    colourCache.set(RGBBinary, closestPixel);\r\n    return closestPixel;\r\n  }\r\n}\r\n\r\nfunction findClosest2ColourSetIdAndToneAndRGBTo(pixelRGB) {\r\n  let RGBBinary = (pixelRGB[0] << 16) + (pixelRGB[1] << 8) + pixelRGB[2];\r\n  if (colourCache.has(RGBBinary)) {\r\n    return colourCache.get(RGBBinary);\r\n  } else {\r\n    let shortestDistance1 = 9999999;\r\n    let shortestDistance2 = 9999999;\r\n    let closestPixel1 = { colourSetId: null, tone: null }; // best colour\r\n    let closestPixel2 = { colourSetId: null, tone: null }; // second best colour\r\n\r\n    colourSetsToUse.forEach((colourSet) => {\r\n      Object.keys(colourSet.tonesRGB).forEach((toneKey) => {\r\n        const toneRGB = colourSet.tonesRGB[toneKey];\r\n        let squareDistance = squaredEuclideanMetricColours(toneRGB, pixelRGB);\r\n        if (squareDistance < shortestDistance1) {\r\n          shortestDistance1 = squareDistance;\r\n          closestPixel1 = {\r\n            colourSetId: colourSet.colourSetId,\r\n            tone: toneKey,\r\n          };\r\n        }\r\n        if (squareDistance < shortestDistance2 && colourSetIdAndToneToRGB(closestPixel1.colourSetId, closestPixel1.tone) !== toneRGB) {\r\n          shortestDistance2 = squareDistance;\r\n          closestPixel2 = {\r\n            colourSetId: colourSet.colourSetId,\r\n            tone: toneKey,\r\n          };\r\n        }\r\n      });\r\n    });\r\n    if (\r\n      shortestDistance2 !== 9999999 && // to make sure closestPixel2.colourSetId/tone is not null\r\n      squaredEuclideanMetricColours(\r\n        colourSetIdAndToneToRGB(closestPixel1.colourSetId, closestPixel1.tone),\r\n        colourSetIdAndToneToRGB(closestPixel2.colourSetId, closestPixel2.tone)\r\n      ) <= shortestDistance2\r\n    ) {\r\n      closestPixel2 = closestPixel1; // if closestPixel1 is a better fit to closestPixel2 than closestPixel2 is to the actual pixel\r\n    }\r\n    let newPixels = [shortestDistance1, shortestDistance2, closestPixel1, closestPixel2];\r\n    colourCache.set(RGBBinary, newPixels);\r\n    return newPixels;\r\n  }\r\n}\r\n\r\nfunction setupColourSetsToUse() {\r\n  let colourSetIdsToUse = []; // get selected colour sets\r\n  Object.keys(selectedBlocks).forEach((key) => {\r\n    if (selectedBlocks[key] !== \"-1\") {\r\n      colourSetIdsToUse.push(key);\r\n    }\r\n  });\r\n\r\n  // now get appropriate shades\r\n  const toneKeys = Object.values(Object.values(MapModes).find((mapMode) => mapMode.uniqueId === optionValue_modeNBTOrMapdat).staircaseModes).find(\r\n    (staircaseMode) => staircaseMode.uniqueId === optionValue_staircasing\r\n  ).toneKeys;\r\n\r\n  for (const colourSetId of colourSetIdsToUse) {\r\n    let tonesRGB = {};\r\n    for (const toneKey of toneKeys) {\r\n      tonesRGB[toneKey] = coloursJSON[colourSetId].tonesRGB[toneKey];\r\n    }\r\n    colourSetsToUse.push({\r\n      colourSetId: colourSetId,\r\n      tonesRGB: tonesRGB,\r\n    });\r\n  }\r\n}\r\n\r\nfunction setupExactColourCache() {\r\n  // we do not care what staircasing option is selected etc as this does not matter\r\n  // this is for exactly matching colours, whose values are never repeated in coloursJSON\r\n  for (const [colourSetId, colourSet] of Object.entries(coloursJSON)) {\r\n    for (const [toneKey, toneRGB] of Object.entries(colourSet.tonesRGB)) {\r\n      const RGBBinary = (toneRGB[0] << 16) + (toneRGB[1] << 8) + toneRGB[2];\r\n      exactColourCache.set(RGBBinary, {\r\n        colourSetId: colourSetId,\r\n        tone: toneKey,\r\n      });\r\n    }\r\n  }\r\n}\r\n\r\nfunction exactRGBToColourSetIdAndTone(pixelRGB) {\r\n  const RGBBinary = (pixelRGB[0] << 16) + (pixelRGB[1] << 8) + pixelRGB[2];\r\n  return exactColourCache.get(RGBBinary);\r\n}\r\n\r\nfunction isSupportBlockMandatoryForColourSetIdAndTone(colourSetIdAndTone) {\r\n  return coloursJSON[colourSetIdAndTone.colourSetId].blocks[selectedBlocks[colourSetIdAndTone.colourSetId]].supportBlockMandatory;\r\n}\r\n\r\nfunction colourSetIdAndToneToRGB(colourSetId, tone) {\r\n  return coloursJSON[colourSetId][\"tonesRGB\"][tone];\r\n}\r\n\r\nfunction getMapartImageDataAndMaterials() {\r\n  for (let y = 0; y < optionValue_mapSize_y; y++) {\r\n    let mapsRowToAdd = [];\r\n    for (let x = 0; x < optionValue_mapSize_x; x++) {\r\n      let mapEntryToAdd = { materials: {}, supportBlockCount: 0 };\r\n      colourSetsToUse.forEach((colourSet) => {\r\n        mapEntryToAdd.materials[colourSet.colourSetId] = 0;\r\n      });\r\n      mapsRowToAdd.push(mapEntryToAdd);\r\n    }\r\n    maps.push(mapsRowToAdd);\r\n  }\r\n\r\n  if (colourSetsToUse.length === 0) {\r\n    return;\r\n  }\r\n\r\n  if (optionValue_modeNBTOrMapdat === MapModes.SCHEMATIC_NBT.uniqueId) {\r\n    maps.forEach((row) =>\r\n      row.forEach((map) => {\r\n        map.supportBlockCount = 128; // initialise with noobline count\r\n      })\r\n    );\r\n  }\r\n\r\n  let ditherMatrix;\r\n  let divisor;\r\n  const chosenDitherMethod =\r\n    DitherMethods[Object.keys(DitherMethods).find((ditherMethodKey) => DitherMethods[ditherMethodKey].uniqueId === optionValue_dithering)];\r\n  if (chosenDitherMethod.uniqueId !== DitherMethods.None.uniqueId) {\r\n    ditherMatrix = chosenDitherMethod.ditherMatrix;\r\n  }\r\n  if (\r\n    [\r\n      DitherMethods.FloydSteinberg.uniqueId,\r\n      DitherMethods.FloydSteinberg_20.uniqueId,\r\n      DitherMethods.FloydSteinberg_24.uniqueId,\r\n      DitherMethods.MinAvgErr.uniqueId,\r\n      DitherMethods.Burkes.uniqueId,\r\n      DitherMethods.SierraLite.uniqueId,\r\n      DitherMethods.Stucki.uniqueId,\r\n      DitherMethods.Atkinson.uniqueId,\r\n      DitherMethods.Atkinson_6.uniqueId,\r\n      DitherMethods.Atkinson_10.uniqueId,\r\n      DitherMethods.Atkinson_12.uniqueId,\r\n    ].includes(chosenDitherMethod.uniqueId)\r\n  ) {\r\n    divisor = chosenDitherMethod.ditherDivisor;\r\n  }\r\n  for (let i = 0; i < canvasImageData.data.length; i += 4) {\r\n    const indexR = i;\r\n    const indexG = i + 1;\r\n    const indexB = i + 2;\r\n    const indexA = i + 3;\r\n\r\n    const multimapWidth = optionValue_mapSize_x * 128;\r\n    const multimap_x = (i / 4) % multimapWidth;\r\n    const multimap_y = (i / 4 - multimap_x) / multimapWidth;\r\n    const whichMap_x = Math.floor(multimap_x / 128);\r\n    const whichMap_y = Math.floor(multimap_y / 128);\r\n    const individualMap_y = multimap_y % 128;\r\n    if (multimap_x === 0) {\r\n      postMessage({\r\n        head: \"PROGRESS_REPORT\",\r\n        body: multimap_y / (128 * optionValue_mapSize_y),\r\n      });\r\n    }\r\n\r\n    let closestColourSetIdAndTone;\r\n    if (\r\n      optionValue_modeNBTOrMapdat === MapModes.MAPDAT.uniqueId &&\r\n      optionValue_transparency &&\r\n      canvasImageData.data[indexA] < optionValue_transparencyTolerance\r\n    ) {\r\n      // we specially reserve 0,0,0,0 for transparent in mapdats\r\n      canvasImageData.data[indexR] = 0;\r\n      canvasImageData.data[indexG] = 0;\r\n      canvasImageData.data[indexB] = 0;\r\n      canvasImageData.data[indexA] = 0;\r\n    } else {\r\n      canvasImageData.data[indexA] = 255; // full opacity\r\n      const oldPixel = [canvasImageData.data[indexR], canvasImageData.data[indexG], canvasImageData.data[indexB]];\r\n      switch (chosenDitherMethod.uniqueId) {\r\n        // Switch statement that checks the dither method every pixel;\r\n        // I have tested a refactor that only checks once however the time difference is negligible and code quality deteriorates\r\n        case DitherMethods.None.uniqueId: {\r\n          closestColourSetIdAndTone = findClosestColourSetIdAndToneAndRGBTo(oldPixel);\r\n          const closestColour = colourSetIdAndToneToRGB(closestColourSetIdAndTone.colourSetId, closestColourSetIdAndTone.tone);\r\n          canvasImageData.data[indexR] = closestColour[0];\r\n          canvasImageData.data[indexG] = closestColour[1];\r\n          canvasImageData.data[indexB] = closestColour[2];\r\n          break;\r\n        }\r\n        case DitherMethods.Bayer44.uniqueId:\r\n        case DitherMethods.Bayer22.uniqueId:\r\n        case DitherMethods.Ordered33.uniqueId: {\r\n          const newPixels = findClosest2ColourSetIdAndToneAndRGBTo(oldPixel);\r\n          // newPixels = [shortestDistance1, shortestDistance2, newPixel1, newPixel2]\r\n          if (\r\n            (newPixels[0] * (ditherMatrix[0].length * ditherMatrix.length + 1)) / newPixels[1] >\r\n            ditherMatrix[multimap_x % ditherMatrix[0].length][multimap_y % ditherMatrix.length]\r\n          ) {\r\n            closestColourSetIdAndTone = newPixels[3];\r\n          } else {\r\n            closestColourSetIdAndTone = newPixels[2];\r\n          }\r\n          const closestColour = colourSetIdAndToneToRGB(closestColourSetIdAndTone.colourSetId, closestColourSetIdAndTone.tone);\r\n          canvasImageData.data[indexR] = closestColour[0];\r\n          canvasImageData.data[indexG] = closestColour[1];\r\n          canvasImageData.data[indexB] = closestColour[2];\r\n          break;\r\n        }\r\n        //Error diffusion algorithms\r\n        case DitherMethods.FloydSteinberg.uniqueId:\r\n        case DitherMethods.FloydSteinberg_20.uniqueId:\r\n        case DitherMethods.FloydSteinberg_24.uniqueId:\r\n        case DitherMethods.MinAvgErr.uniqueId:\r\n        case DitherMethods.Burkes.uniqueId:\r\n        case DitherMethods.SierraLite.uniqueId:\r\n        case DitherMethods.Stucki.uniqueId:\r\n        case DitherMethods.Atkinson.uniqueId:\r\n        case DitherMethods.Atkinson_6.uniqueId:\r\n        case DitherMethods.Atkinson_10.uniqueId:\r\n        case DitherMethods.Atkinson_12.uniqueId:\r\n        {\r\n          closestColourSetIdAndTone = findClosestColourSetIdAndToneAndRGBTo(oldPixel);\r\n          const closestColour = colourSetIdAndToneToRGB(closestColourSetIdAndTone.colourSetId, closestColourSetIdAndTone.tone);\r\n          canvasImageData.data[indexR] = closestColour[0];\r\n          canvasImageData.data[indexG] = closestColour[1];\r\n          canvasImageData.data[indexB] = closestColour[2];\r\n\r\n          const quant_error = [\r\n            (oldPixel[0] - closestColour[0]) * optionValue_dithering_propagation_red / 100.0,\r\n            (oldPixel[1] - closestColour[1]) * optionValue_dithering_propagation_green / 100.0,\r\n            (oldPixel[2] - closestColour[2]) * optionValue_dithering_propagation_blue / 100.0\r\n          ];\r\n\r\n          try {\r\n            // ditherMatrix [0][0...2] should always be zero, and can thus be skipped\r\n            if (multimap_x + 1 < multimapWidth) {\r\n              // Make sure to not carry over error from one side to the other\r\n              const weight = ditherMatrix[0][3] / divisor; // 1 right\r\n              canvasImageData.data[i + 4] += quant_error[0] * weight;\r\n              canvasImageData.data[i + 5] += quant_error[1] * weight;\r\n              canvasImageData.data[i + 6] += quant_error[2] * weight;\r\n              if (multimap_x + 2 < multimapWidth) {\r\n                const weight = ditherMatrix[0][4] / divisor; // 2 right\r\n                canvasImageData.data[i + 8] += quant_error[0] * weight;\r\n                canvasImageData.data[i + 9] += quant_error[1] * weight;\r\n                canvasImageData.data[i + 10] += quant_error[2] * weight;\r\n              }\r\n            }\r\n\r\n            // First row below\r\n            if (multimap_x > 0) {\r\n              // Order reversed, to allow nesting of 'if' blocks\r\n              const weight = ditherMatrix[1][1] / divisor; // 1 down, 1 left\r\n              canvasImageData.data[i + multimapWidth * 4 - 4] += quant_error[0] * weight;\r\n              canvasImageData.data[i + multimapWidth * 4 - 3] += quant_error[1] * weight;\r\n              canvasImageData.data[i + multimapWidth * 4 - 2] += quant_error[2] * weight;\r\n              if (multimap_x > 1) {\r\n                const weight = ditherMatrix[1][0] / divisor; // 1 down, 2 left\r\n                canvasImageData.data[i + multimapWidth * 4 - 8] += quant_error[0] * weight;\r\n                canvasImageData.data[i + multimapWidth * 4 - 7] += quant_error[1] * weight;\r\n                canvasImageData.data[i + multimapWidth * 4 - 6] += quant_error[2] * weight;\r\n              }\r\n            }\r\n            let weight = ditherMatrix[1][2] / divisor; // 1 down\r\n            canvasImageData.data[i + multimapWidth * 4 + 0] += quant_error[0] * weight;\r\n            canvasImageData.data[i + multimapWidth * 4 + 1] += quant_error[1] * weight;\r\n            canvasImageData.data[i + multimapWidth * 4 + 2] += quant_error[2] * weight;\r\n            if (multimap_x + 1 < multimapWidth) {\r\n              const weight = ditherMatrix[1][3] / divisor; // 1 down, 1 right\r\n              canvasImageData.data[i + multimapWidth * 4 + 4] += quant_error[0] * weight;\r\n              canvasImageData.data[i + multimapWidth * 4 + 5] += quant_error[1] * weight;\r\n              canvasImageData.data[i + multimapWidth * 4 + 6] += quant_error[2] * weight;\r\n              if (multimap_x + 2 < multimapWidth) {\r\n                const weight = ditherMatrix[1][4] / divisor; // 1 down, 2 right\r\n                canvasImageData.data[i + multimapWidth * 4 + 8] += quant_error[0] * weight;\r\n                canvasImageData.data[i + multimapWidth * 4 + 9] += quant_error[1] * weight;\r\n                canvasImageData.data[i + multimapWidth * 4 + 10] += quant_error[2] * weight;\r\n              }\r\n            }\r\n\r\n            // Second row below\r\n            if (multimap_x > 0) {\r\n              const weight = ditherMatrix[2][1] / divisor; // 2 down, 1 left\r\n              canvasImageData.data[i + multimapWidth * 8 - 4] += quant_error[0] * weight;\r\n              canvasImageData.data[i + multimapWidth * 8 - 3] += quant_error[1] * weight;\r\n              canvasImageData.data[i + multimapWidth * 8 - 2] += quant_error[2] * weight;\r\n              if (multimap_x > 1) {\r\n                const weight = ditherMatrix[2][0] / divisor; // 2 down, 2 left\r\n                canvasImageData.data[i + multimapWidth * 8 - 8] += quant_error[0] * weight;\r\n                canvasImageData.data[i + multimapWidth * 8 - 7] += quant_error[1] * weight;\r\n                canvasImageData.data[i + multimapWidth * 8 - 6] += quant_error[2] * weight;\r\n              }\r\n            }\r\n            weight = ditherMatrix[2][2] / divisor; // 2 down\r\n            canvasImageData.data[i + multimapWidth * 8 + 0] += quant_error[0] * weight;\r\n            canvasImageData.data[i + multimapWidth * 8 + 1] += quant_error[1] * weight;\r\n            canvasImageData.data[i + multimapWidth * 8 + 2] += quant_error[2] * weight;\r\n            if (multimap_x + 1 < multimapWidth) {\r\n              const weight = ditherMatrix[2][3] / divisor; // 2 down, 1 right\r\n              canvasImageData.data[i + multimapWidth * 8 + 4] += quant_error[0] * weight;\r\n              canvasImageData.data[i + multimapWidth * 8 + 5] += quant_error[1] * weight;\r\n              canvasImageData.data[i + multimapWidth * 8 + 6] += quant_error[2] * weight;\r\n              if (multimap_x + 2 < multimapWidth) {\r\n                const weight = ditherMatrix[2][4] / divisor; // 2 down, 2 right\r\n                canvasImageData.data[i + multimapWidth * 8 + 8] += quant_error[0] * weight;\r\n                canvasImageData.data[i + multimapWidth * 8 + 9] += quant_error[1] * weight;\r\n                canvasImageData.data[i + multimapWidth * 8 + 10] += quant_error[2] * weight;\r\n              }\r\n            }\r\n          } catch (e) {\r\n            console.log(e); // ???\r\n          }\r\n          break;\r\n        }\r\n        default:\r\n          break;\r\n      }\r\n\r\n      // support-block count: mapdat can skip this\r\n      if (optionValue_modeNBTOrMapdat === MapModes.SCHEMATIC_NBT.uniqueId) {\r\n        maps[whichMap_y][whichMap_x].materials[closestColourSetIdAndTone.colourSetId] += 1;\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nonmessage = (e) => {\r\n  coloursJSON = e.data.body.coloursJSON;\r\n  MapModes = e.data.body.MapModes;\r\n  DitherMethods = e.data.body.DitherMethods;\r\n  canvasImageData = e.data.body.canvasImageData;\r\n  selectedBlocks = e.data.body.selectedBlocks;\r\n  optionValue_modeNBTOrMapdat = e.data.body.optionValue_modeNBTOrMapdat;\r\n  optionValue_mapSize_x = e.data.body.optionValue_mapSize_x;\r\n  optionValue_mapSize_y = e.data.body.optionValue_mapSize_y;\r\n  optionValue_staircasing = e.data.body.optionValue_staircasing;\r\n  optionValue_transparency = e.data.body.optionValue_transparency;\r\n  optionValue_transparencyTolerance = e.data.body.optionValue_transparencyTolerance;\r\n  optionValue_betterColour = e.data.body.optionValue_betterColour;\r\n  optionValue_dithering = e.data.body.optionValue_dithering;\r\n  optionValue_dithering_propagation_red = e.data.body.optionValue_dithering_propagation_red;\r\n  optionValue_dithering_propagation_green = e.data.body.optionValue_dithering_propagation_green;\r\n  optionValue_dithering_propagation_blue = e.data.body.optionValue_dithering_propagation_blue;\r\n\r\n  setupColourSetsToUse();\r\n  setupExactColourCache();\r\n  getMapartImageDataAndMaterials();\r\n  postMessage({\r\n    head: \"PIXELS_MATERIALS_CURRENTSELECTEDBLOCKS\",\r\n    body: {\r\n      pixels: canvasImageData,\r\n      maps: maps,\r\n      currentSelectedBlocks: selectedBlocks,\r\n    },\r\n  });\r\n};\r\n\r\n};\r\n","import React, { Component, createRef } from \"react\";\r\n\r\nimport Tooltip from \"../tooltip\";\r\nimport WorkerBuilder from './workers/worker-builder';\r\nimport MapCanvasWorker from \"./workers/mapCanvas\";\r\n\r\nimport BackgroundColourModes from \"./json/backgroundColourModes.json\";\r\nimport CropModes from \"./json/cropModes.json\";\r\nimport DitherMethods from \"./json/ditherMethods.json\";\r\nimport MapModes from \"./json/mapModes.json\";\r\n\r\nimport IMG_Null from \"../../images/null.png\";\r\nimport IMG_Textures from \"../../images/textures.png\";\r\nimport IMG_GridOverlay from \"../../images/gridOverlay.png\";\r\n\r\nimport \"./mapPreview.css\";\r\n\r\nclass MapPreview extends Component {\r\n  state = {\r\n    mapPreviewSizeScale: 2,\r\n    workerProgress: 0,\r\n  };\r\n\r\n  mapCanvasWorker = new WorkerBuilder(MapCanvasWorker);\r\n\r\n  constructor(props) {\r\n    super(props);\r\n    this.canvasRef_source = createRef(); // hidden source canvas that at all times contains the uploaded image\r\n    this.canvasRef_display = createRef(); // display canvas that displays to the user, may be pixels, may be image\r\n    this.fileInputRef = createRef();\r\n  }\r\n\r\n  shouldCanvasUpdate_source(prevProps, newProps, prevState, newState) {\r\n    const propChanges = [\r\n      prevProps.coloursJSON === newProps.coloursJSON,\r\n      prevProps.selectedBlocks === newProps.selectedBlocks,\r\n      prevProps.optionValue_mapSize_x === newProps.optionValue_mapSize_x,\r\n      prevProps.optionValue_mapSize_y === newProps.optionValue_mapSize_y,\r\n      prevProps.optionValue_cropImage === newProps.optionValue_cropImage,\r\n      prevProps.optionValue_cropImage_zoom === newProps.optionValue_cropImage_zoom,\r\n      prevProps.optionValue_cropImage_percent_x === newProps.optionValue_cropImage_percent_x,\r\n      prevProps.optionValue_cropImage_percent_y === newProps.optionValue_cropImage_percent_y,\r\n      prevProps.optionValue_staircasing === newProps.optionValue_staircasing,\r\n      prevProps.optionValue_preprocessingEnabled === newProps.optionValue_preprocessingEnabled,\r\n      prevProps.preProcessingValue_brightness === newProps.preProcessingValue_brightness,\r\n      prevProps.preProcessingValue_contrast === newProps.preProcessingValue_contrast,\r\n      prevProps.preProcessingValue_saturation === newProps.preProcessingValue_saturation,\r\n      prevProps.preProcessingValue_backgroundColourSelect === newProps.preProcessingValue_backgroundColourSelect,\r\n      prevProps.preProcessingValue_backgroundColour === newProps.preProcessingValue_backgroundColour,\r\n      prevProps.uploadedImage === newProps.uploadedImage,\r\n    ];\r\n    return (\r\n      newProps.uploadedImage !== null &&\r\n      prevState.workerProgress === newState.workerProgress &&\r\n      !propChanges.every((elt) => {\r\n        return elt === true;\r\n      })\r\n    );\r\n  }\r\n\r\n  shouldCanvasUpdate_display(prevProps, newProps, prevState, newState) {\r\n    // ugly but useful method to determine whether map canvas contents should be redrawn on component update\r\n    const propChanges = [\r\n      prevProps.coloursJSON === newProps.coloursJSON,\r\n      prevProps.selectedBlocks === newProps.selectedBlocks,\r\n      prevProps.optionValue_modeNBTOrMapdat === newProps.optionValue_modeNBTOrMapdat,\r\n      prevProps.optionValue_mapSize_x === newProps.optionValue_mapSize_x,\r\n      prevProps.optionValue_mapSize_y === newProps.optionValue_mapSize_y,\r\n      prevProps.optionValue_cropImage === newProps.optionValue_cropImage,\r\n      prevProps.optionValue_cropImage_zoom === newProps.optionValue_cropImage_zoom,\r\n      prevProps.optionValue_cropImage_percent_x === newProps.optionValue_cropImage_percent_x,\r\n      prevProps.optionValue_cropImage_percent_y === newProps.optionValue_cropImage_percent_y,\r\n      prevProps.optionValue_staircasing === newProps.optionValue_staircasing,\r\n      prevProps.optionValue_transparency === newProps.optionValue_transparency,\r\n      prevProps.optionValue_transparencyTolerance === newProps.optionValue_transparencyTolerance,\r\n      prevProps.optionValue_betterColour === newProps.optionValue_betterColour,\r\n      prevProps.optionValue_dithering === newProps.optionValue_dithering,\r\n      prevProps.optionValue_dithering_propagation_red === newProps.optionValue_dithering_propagation_red,\r\n      prevProps.optionValue_dithering_propagation_green === newProps.optionValue_dithering_propagation_green,\r\n      prevProps.optionValue_dithering_propagation_blue === newProps.optionValue_dithering_propagation_blue,\r\n      prevProps.optionValue_preprocessingEnabled === newProps.optionValue_preprocessingEnabled,\r\n      prevProps.preProcessingValue_brightness === newProps.preProcessingValue_brightness,\r\n      prevProps.preProcessingValue_contrast === newProps.preProcessingValue_contrast,\r\n      prevProps.preProcessingValue_saturation === newProps.preProcessingValue_saturation,\r\n      prevProps.preProcessingValue_backgroundColourSelect === newProps.preProcessingValue_backgroundColourSelect,\r\n      prevProps.preProcessingValue_backgroundColour === newProps.preProcessingValue_backgroundColour,\r\n      prevProps.uploadedImage === newProps.uploadedImage,\r\n    ];\r\n    return (\r\n      newProps.uploadedImage !== null &&\r\n      prevState.workerProgress === newState.workerProgress &&\r\n      !propChanges.every((elt) => {\r\n        return elt === true;\r\n      })\r\n    );\r\n  }\r\n\r\n  componentDidUpdate(prevProps, prevState) {\r\n    if (this.shouldCanvasUpdate_source(prevProps, this.props, prevState, this.state)) {\r\n      this.updateCanvas_source(); // draw uploaded image on source canvas\r\n    }\r\n    if (this.shouldCanvasUpdate_display(prevProps, this.props, prevState, this.state)) {\r\n      this.updateCanvas_display(); // draw pixelart of image on display canvas\r\n    }\r\n  }\r\n\r\n  closestSmoothColourTo(colourHex) {\r\n    const { coloursJSON, selectedBlocks, optionValue_staircasing } = this.props;\r\n    const rgbGroups_input = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(colourHex);\r\n    const colourRGB_input = [parseInt(rgbGroups_input[1], 16), parseInt(rgbGroups_input[2], 16), parseInt(rgbGroups_input[3], 16)];\r\n    let smallestDistance = 9999999;\r\n    let colourRGB_return = null;\r\n    for (const [colourSetId, colourSet] of Object.entries(coloursJSON)) {\r\n      if (selectedBlocks[colourSetId] === \"-1\") {\r\n        continue;\r\n      }\r\n      let coloursRGB_colourSet;\r\n      switch (optionValue_staircasing) {\r\n        case MapModes.SCHEMATIC_NBT.staircaseModes.OFF.uniqueId:\r\n        case MapModes.SCHEMATIC_NBT.staircaseModes.CLASSIC.uniqueId:\r\n        case MapModes.SCHEMATIC_NBT.staircaseModes.VALLEY.uniqueId:\r\n        case MapModes.MAPDAT.staircaseModes.OFF.uniqueId: {\r\n          coloursRGB_colourSet = [colourSet.tonesRGB.normal];\r\n          break;\r\n        }\r\n        case MapModes.SCHEMATIC_NBT.staircaseModes.FULL_DARK.uniqueId:\r\n        case MapModes.MAPDAT.staircaseModes.FULL_DARK.uniqueId: {\r\n          coloursRGB_colourSet = [colourSet.tonesRGB.dark];\r\n          break;\r\n        }\r\n        case MapModes.SCHEMATIC_NBT.staircaseModes.FULL_LIGHT.uniqueId:\r\n        case MapModes.MAPDAT.staircaseModes.FULL_LIGHT.uniqueId: {\r\n          coloursRGB_colourSet = [colourSet.tonesRGB.light];\r\n          break;\r\n        }\r\n        case MapModes.MAPDAT.staircaseModes.FULL_UNOBTAINABLE.uniqueId: {\r\n          coloursRGB_colourSet = [colourSet.tonesRGB.unobtainable];\r\n          break;\r\n        }\r\n        case MapModes.MAPDAT.staircaseModes.ON.uniqueId: {\r\n          coloursRGB_colourSet = [colourSet.tonesRGB.dark, colourSet.tonesRGB.normal, colourSet.tonesRGB.light];\r\n          break;\r\n        }\r\n        case MapModes.MAPDAT.staircaseModes.ON_UNOBTAINABLE.uniqueId: {\r\n          coloursRGB_colourSet = [colourSet.tonesRGB.dark, colourSet.tonesRGB.normal, colourSet.tonesRGB.light, colourSet.tonesRGB.unobtainable];\r\n          break;\r\n        }\r\n        default: {\r\n          throw new Error(\"Unknown staircasing mode\");\r\n        }\r\n      }\r\n      for (const colourRGB_colourSet of coloursRGB_colourSet) {\r\n        const colourDistance =\r\n          Math.pow(colourRGB_input[0] - colourRGB_colourSet[0], 2) +\r\n          Math.pow(colourRGB_input[1] - colourRGB_colourSet[1], 2) +\r\n          Math.pow(colourRGB_input[2] - colourRGB_colourSet[2], 2);\r\n        if (colourDistance < smallestDistance) {\r\n          smallestDistance = colourDistance;\r\n          colourRGB_return = colourRGB_colourSet;\r\n        }\r\n      }\r\n    }\r\n    const colourHex_return = `#${colourRGB_return[0].toString(16).padStart(2, \"0\")}${colourRGB_return[1].toString(16).padStart(2, \"0\")}${colourRGB_return[2]\r\n      .toString(16)\r\n      .padStart(2, \"0\")}`;\r\n    return colourHex_return;\r\n  }\r\n\r\n  updateCanvas_source() {\r\n    const {\r\n      selectedBlocks,\r\n      optionValue_preprocessingEnabled,\r\n      preProcessingValue_brightness,\r\n      preProcessingValue_contrast,\r\n      preProcessingValue_saturation,\r\n      preProcessingValue_backgroundColourSelect,\r\n      preProcessingValue_backgroundColour,\r\n      uploadedImage,\r\n    } = this.props;\r\n    const {\r\n      optionValue_mapSize_x,\r\n      optionValue_mapSize_y,\r\n      optionValue_cropImage,\r\n      optionValue_cropImage_zoom,\r\n      optionValue_cropImage_percent_x,\r\n      optionValue_cropImage_percent_y,\r\n    } = this.props;\r\n    const { canvasRef_source } = this;\r\n    const ctx_source = canvasRef_source.current.getContext(\"2d\");\r\n    ctx_source.imageSmoothingEnabled = true;   // These two options keep the map preview consistent on Chrome(ium). Otherwise the first render after changing\r\n    ctx_source.imageSmoothingQuality = \"high\"; // map x or z size is pixelated to a noticeably lower quality. This is not a solution to the cause but a\r\n                                               // workaround the effect (I do not know exactly why this happens: maybe it is to do with\r\n                                               // anti-fingerprinting). Firefox is unaffected by any of this.\r\n    ctx_source.clearRect(0, 0, ctx_source.canvas.width, ctx_source.canvas.height);\r\n\r\n    if (optionValue_preprocessingEnabled) {\r\n      if (preProcessingValue_backgroundColourSelect !== BackgroundColourModes.OFF.uniqueId && /^#?[a-f\\d]{6}$/i.test(preProcessingValue_backgroundColour)) {\r\n        let backgroundColour;\r\n        if (\r\n          preProcessingValue_backgroundColourSelect === BackgroundColourModes.SMOOTH.uniqueId &&\r\n          !Object.values(selectedBlocks).every((selectedBlockId) => selectedBlockId === \"-1\")\r\n        ) {\r\n          backgroundColour = this.closestSmoothColourTo(preProcessingValue_backgroundColour);\r\n        } else {\r\n          backgroundColour = preProcessingValue_backgroundColour;\r\n        }\r\n        ctx_source.filter = \"none\"; // this needs to be present to stop filters affecting background colour\r\n        ctx_source.rect(0, 0, ctx_source.canvas.width, ctx_source.canvas.height);\r\n        ctx_source.fillStyle = backgroundColour;\r\n        ctx_source.fill();\r\n      }\r\n      ctx_source.filter = `brightness(${preProcessingValue_brightness}%) contrast(${preProcessingValue_contrast}%) saturate(${preProcessingValue_saturation}%)`;\r\n    } else {\r\n      ctx_source.filter = \"none\";\r\n    }\r\n\r\n    switch (optionValue_cropImage) {\r\n      case CropModes.OFF.uniqueId: {\r\n        ctx_source.drawImage(uploadedImage, 0, 0, ctx_source.canvas.width, ctx_source.canvas.height);\r\n        break;\r\n      }\r\n      case CropModes.CENTER.uniqueId:\r\n      case CropModes.MANUAL.uniqueId: {\r\n        const img_width = uploadedImage.width;\r\n        const img_height = uploadedImage.height;\r\n        let samplingWidth;\r\n        let samplingHeight;\r\n        let samplingOffset_x;\r\n        let samplingOffset_y;\r\n        if (img_width * optionValue_mapSize_y > img_height * optionValue_mapSize_x) {\r\n          // image w/h greater than canvas w/h\r\n          samplingWidth = Math.floor((10 * img_height * optionValue_mapSize_x) / (optionValue_mapSize_y * optionValue_cropImage_zoom));\r\n          // the 10 is because the input is from 10 to 50 in steps of 1; scale down by 10\r\n          samplingHeight = Math.floor((10 * img_height) / optionValue_cropImage_zoom);\r\n          samplingOffset_x = Math.floor((optionValue_cropImage_percent_x * (img_width - samplingWidth)) / 100);\r\n          samplingOffset_y = Math.floor((optionValue_cropImage_percent_y * (img_height - samplingHeight)) / 100);\r\n        } else {\r\n          // image w/h leq canvas w/h\r\n          samplingWidth = Math.floor((10 * img_width) / optionValue_cropImage_zoom);\r\n          samplingHeight = Math.floor((10 * img_width * optionValue_mapSize_y) / (optionValue_mapSize_x * optionValue_cropImage_zoom));\r\n          samplingOffset_x = Math.floor((optionValue_cropImage_percent_x * (img_width - samplingWidth)) / 100);\r\n          samplingOffset_y = Math.floor((optionValue_cropImage_percent_y * (img_height - samplingHeight)) / 100);\r\n        }\r\n        ctx_source.drawImage(\r\n          uploadedImage,\r\n          samplingOffset_x,\r\n          samplingOffset_y,\r\n          samplingWidth,\r\n          samplingHeight,\r\n          0,\r\n          0,\r\n          ctx_source.canvas.width,\r\n          ctx_source.canvas.height\r\n        );\r\n        break;\r\n      }\r\n      default: {\r\n        throw new Error(\"Unknown optionValue_cropImage\");\r\n      }\r\n    }\r\n  }\r\n\r\n  updateCanvas_display() {\r\n    this.mapCanvasWorker.terminate();\r\n    const { canvasRef_source, canvasRef_display } = this;\r\n    const {\r\n      coloursJSON,\r\n      selectedBlocks,\r\n      optionValue_modeNBTOrMapdat,\r\n      optionValue_mapSize_x,\r\n      optionValue_mapSize_y,\r\n      optionValue_staircasing,\r\n      optionValue_transparency,\r\n      optionValue_transparencyTolerance,\r\n      optionValue_betterColour,\r\n      optionValue_dithering,\r\n      optionValue_dithering_propagation_red,\r\n      optionValue_dithering_propagation_green,\r\n      optionValue_dithering_propagation_blue,\r\n      onGetMapMaterials,\r\n      onMapPreviewWorker_begin,\r\n    } = this.props;\r\n    const ctx_source = canvasRef_source.current.getContext(\"2d\");\r\n    const canvasImageData = ctx_source.getImageData(0, 0, ctx_source.canvas.width, ctx_source.canvas.height);\r\n    const t0 = performance.now();\r\n    this.mapCanvasWorker = new WorkerBuilder(MapCanvasWorker);\r\n    this.mapCanvasWorker.onmessage = (e) => {\r\n      if (e.data.head === \"PIXELS_MATERIALS_CURRENTSELECTEDBLOCKS\") {\r\n        const t1 = performance.now();\r\n        console.log(`Calculated map preview data in ${(t1 - t0).toString()}ms`);\r\n        const ctx_display = canvasRef_display.current.getContext(\"2d\");\r\n        ctx_display.putImageData(e.data.body.pixels, 0, 0);\r\n        this.setState({ workerProgress: 1 });\r\n        onGetMapMaterials({\r\n          pixelsData: e.data.body.pixels.data,\r\n          maps: e.data.body.maps,\r\n          currentSelectedBlocks: e.data.body.currentSelectedBlocks,\r\n        });\r\n      } else if (e.data.head === \"PROGRESS_REPORT\") {\r\n        this.setState({ workerProgress: e.data.body });\r\n      }\r\n    };\r\n    onMapPreviewWorker_begin();\r\n    this.mapCanvasWorker.postMessage({\r\n      head: \"PIXELS\",\r\n      body: {\r\n        coloursJSON: coloursJSON,\r\n        MapModes: MapModes,\r\n        DitherMethods: DitherMethods,\r\n        canvasImageData: canvasImageData,\r\n        selectedBlocks: selectedBlocks,\r\n        optionValue_modeNBTOrMapdat: optionValue_modeNBTOrMapdat,\r\n        optionValue_mapSize_x: optionValue_mapSize_x,\r\n        optionValue_mapSize_y: optionValue_mapSize_y,\r\n        optionValue_staircasing: optionValue_staircasing,\r\n        optionValue_transparency: optionValue_transparency,\r\n        optionValue_transparencyTolerance: optionValue_transparencyTolerance,\r\n        optionValue_betterColour: optionValue_betterColour,\r\n        optionValue_dithering: optionValue_dithering,\r\n        optionValue_dithering_propagation_red: optionValue_dithering_propagation_red,\r\n        optionValue_dithering_propagation_green: optionValue_dithering_propagation_green,\r\n        optionValue_dithering_propagation_blue: optionValue_dithering_propagation_blue,\r\n      },\r\n    });\r\n  }\r\n\r\n  increasePreviewScale = () => {\r\n    this.setState({\r\n      mapPreviewSizeScale: this.state.mapPreviewSizeScale * 1.2,\r\n    });\r\n  };\r\n\r\n  decreasePreviewScale = () => {\r\n    this.setState({\r\n      mapPreviewSizeScale: this.state.mapPreviewSizeScale / 1.2,\r\n    });\r\n  };\r\n\r\n  componentWillUnmount() {\r\n    this.mapCanvasWorker.terminate();\r\n  }\r\n\r\n  render() {\r\n    const {\r\n      getLocaleString,\r\n      optionValue_mapSize_x, // map size in maps\r\n      optionValue_mapSize_y,\r\n      optionValue_cropImage,\r\n      optionValue_showGridOverlay,\r\n      onFileDialogEvent,\r\n      uploadedImage,\r\n    } = this.props;\r\n    const { mapPreviewSizeScale, workerProgress } = this.state;\r\n    return (\r\n      <div className=\"section mapPreviewDiv\">\r\n        <h2>{getLocaleString(\"MAP-PREVIEW/TITLE\")}</h2>\r\n        <input type=\"file\" className=\"imgUpload\" ref={this.fileInputRef} onChange={onFileDialogEvent} />\r\n        <div>\r\n          <span\r\n            className=\"gridOverlay\"\r\n            style={{\r\n              backgroundImage: `url(${IMG_GridOverlay})`,\r\n              display: optionValue_showGridOverlay ? \"block\" : \"none\",\r\n              width: `${(mapPreviewSizeScale * 128 * optionValue_mapSize_x).toString()}px`,\r\n              height: `${(mapPreviewSizeScale * 128 * optionValue_mapSize_y).toString()}px`,\r\n              backgroundSize: `${(mapPreviewSizeScale * 128).toString()}px`,\r\n            }}\r\n          />\r\n          <canvas\r\n            className=\"mapCanvas\"\r\n            width={128 * optionValue_mapSize_x}\r\n            height={128 * optionValue_mapSize_y}\r\n            ref={this.canvasRef_display}\r\n            style={{\r\n              width: `${(mapPreviewSizeScale * 128 * optionValue_mapSize_x).toString()}px`,\r\n              height: `${(mapPreviewSizeScale * 128 * optionValue_mapSize_y).toString()}px`,\r\n            }}\r\n            onClick={() => this.fileInputRef.current.click()}\r\n          />\r\n          <canvas className=\"displayNone\" width={128 * optionValue_mapSize_x} height={128 * optionValue_mapSize_y} ref={this.canvasRef_source}></canvas>\r\n        </div>\r\n        <div className=\"mapResolutionAndZoom\">\r\n          <div>\r\n            <Tooltip tooltipText={getLocaleString(\"MAP-PREVIEW/BEST-RESOLUTION-TT\")}>\r\n              <small>{`${(128 * optionValue_mapSize_x).toString()}x${(128 * optionValue_mapSize_y).toString()}`}</small>\r\n            </Tooltip>{\" \"}\r\n            <Tooltip tooltipText={getLocaleString(\"MAP-PREVIEW/ASPECT-RATIO-MISMATCH-TT\")}>\r\n              <small\r\n                className=\"mapResWarning\"\r\n                style={{\r\n                  display:\r\n                    uploadedImage === null || uploadedImage.height * optionValue_mapSize_x === uploadedImage.width * optionValue_mapSize_y ? \"none\" : \"inline\",\r\n                  color: optionValue_cropImage === CropModes.OFF.uniqueId ? \"red\" : \"orange\",\r\n                }}\r\n              >\r\n                {uploadedImage === null ? null : `${uploadedImage.width.toString()}x${uploadedImage.height.toString()}`}\r\n              </small>\r\n            </Tooltip>\r\n          </div>\r\n          <div>\r\n            <Tooltip tooltipText={getLocaleString(\"MAP-PREVIEW/SCALE-PLUS-TT\")}>\r\n              <img\r\n                alt=\"+\"\r\n                className=\"sizeButton\"\r\n                src={IMG_Null}\r\n                style={{\r\n                  backgroundImage: `url(${IMG_Textures})`,\r\n                  backgroundPositionX: \"-96px\",\r\n                  backgroundPositionY: \"-2048px\",\r\n                }}\r\n                onClick={this.increasePreviewScale}\r\n              />\r\n            </Tooltip>\r\n            <Tooltip tooltipText={getLocaleString(\"MAP-PREVIEW/SCALE-MINUS-TT\")}>\r\n              <img\r\n                alt=\"-\"\r\n                className=\"sizeButton\"\r\n                src={IMG_Null}\r\n                style={{\r\n                  backgroundImage: `url(${IMG_Textures})`,\r\n                  backgroundPositionX: \"-128px\",\r\n                  backgroundPositionY: \"-2048px\",\r\n                }}\r\n                onClick={this.decreasePreviewScale}\r\n              />\r\n            </Tooltip>\r\n          </div>\r\n        </div>\r\n        <div\r\n          className=\"progress\"\r\n          style={\r\n            [0, 1].includes(workerProgress)\r\n              ? {\r\n                  display: \"unset\",\r\n                  visibility: \"hidden\",\r\n                }\r\n              : { display: \"block\" }\r\n          }\r\n        >\r\n          <span className=\"progressText\">{`${Math.floor(workerProgress * 100)}%`}</span>\r\n          <div\r\n            className=\"progressDiv\"\r\n            style={{\r\n              width: `${Math.floor(workerProgress * 100)}%`,\r\n            }}\r\n          />\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default MapPreview;\r\n","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAEACAYAAABccqhmAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAPiSURBVHhe7d0xjtwwEABB0h+Xf04fZYWMeUFXAbMglDBSYxXNWGv93ozx9/j81rjf/afnt+YX7x8/v3v+/JyAKAGAMAGAMAGAMAGAMAGAMAGAMAGAMAGAMAGAMAGAMAGAMAGAMAGAMAGAMAGAMAGAMAGAMAGAMAGAMAGAMAGAMAGAMAGAMAGAMAGAMAGAMAGAMAGAMAGAsLlXFH9nIGKO9byH0+7wa2M/vPtPz29N+P795u/xCQBhAgBhAgBhAgBhAgBhAgBhAgBhAgBhAgBhAgBhAgBhAgBhAgBhAgBhAgBhAgBhAgBhAgBhAgBhAgBhAgBhAgBhAgBhAgBhAgBhAgBhAgBhAgBhAgBhAgBhc68o/s5AxBzreQ+n3eHXxn5495+e35rw/fvN3+MTAMIEAMIEAMIEAMIEAMIEAMIEAMIEAMIEAMIEAMIEAMIEAMIEAMIEAMIEAMIEAMIEAMIEAMIEAMIEAMIEAMIEAMIEAMIEAMIEAMIEAMIEAMIEAMIEAMIEAMLmXlH8nYGIOdbzHk67w6+N/fDuPz2/NeH795u/xycAhAkAhAkAhAkAhAkAhAkAhAkAhAkAhAkAhAkAhAkAhAkAhAkAhAkAhAkAhAkAhAkAhAkAhAkAhAkAhAkAhAkAhAkAhAkAhAkAhAkAhAkAhAkAhAkAhAkAhM29ovg7AxFzrOc9nHaHXxv74d1/en5rwvfvN3+PTwAIEwAIEwAIEwAIEwAIEwAIEwAIEwAIEwAIEwAIEwAIEwAIEwAIEwAIEwAIEwAIEwAIEwAIEwAIEwAIEwAIEwAIEwAIEwAIEwAIEwAIEwAIEwAIEwAIEwAIm3tF8XcGIuZYz3s47Q6/NvbDu//0/NaE799v/h6fABAmABAmABAmABAmABAmABAmABAmABAmABAmABAmABAmABAmABAmABAmABAmABAmABAmABAmABAmABAmABAmABAmABAmABAmABAmABAmABAmABAmABAmABA294ri7wxEzLGe93DaHX5t7Id3/+n5rQnfv9/8PT4BIEwAIEwAIEwAIEwAIEwAIEwAIEwAIEwAIEwAIEwAIEwAIEwAIEwAIEwAIEwAIEwAIEwAIEwAIEwAIEwAIEwAIEwAIEwAIEwAIEwAIEwAIEwAIEwAIEwAIGzuFcXfGYiYYz3v4bQ7/NrYD+/+0/NbE75/v/l7fAJAmABAmABAmABAmABAmABAmABAmABAmABAmABAmABAmABAmABAmABAmABAmABAmABAmABAmABAmABAmABAmABAmABAmABAmABAmABAmABAmABAmABA2Py/JRQo8g8Assb4BzyTnrLVu1KjAAAAAElFTkSuQmCC\"","import React, { Component } from \"react\";\r\n\r\nimport BlockImage from \"../blockImage\";\r\n\r\nimport \"./autoCompleteInputBlockToAdd.css\";\r\n\r\nclass AutoCompleteInputBlockToAdd extends Component {\r\n  state = { suggestionSelected: true };\r\n\r\n  getRelevantSuggestions = () => {\r\n    const { coloursJSON, value, optionValue_version } = this.props;\r\n    let suggestions_prefix = [];\r\n    let suggestions_includes = [];\r\n\r\n    for (const [colourSetId, colourSet] of Object.entries(coloursJSON)) {\r\n      for (const [blockId, block] of Object.entries(colourSet.blocks)) {\r\n        if (!(optionValue_version.MCVersion in block.validVersions)) {\r\n          continue;\r\n        }\r\n        let blockNBTData = block.validVersions[optionValue_version.MCVersion];\r\n        if (typeof blockNBTData === \"string\") {\r\n          // this is of the form eg \"&1.12.2\"\r\n          blockNBTData = block.validVersions[blockNBTData.slice(1)];\r\n        }\r\n        if (!block.supportBlockMandatory) {\r\n          // no gravity affected blocks etc for support / noobline\r\n          if (blockNBTData.NBTName.startsWith(value)) {\r\n            suggestions_prefix.push({\r\n              blockName: blockNBTData.NBTName,\r\n              colourSetId,\r\n              blockId,\r\n            });\r\n          } else if (blockNBTData.NBTName.includes(value)) {\r\n            suggestions_includes.push({\r\n              blockName: blockNBTData.NBTName,\r\n              colourSetId,\r\n              blockId,\r\n            });\r\n          }\r\n        }\r\n      }\r\n    }\r\n    return suggestions_prefix.concat(suggestions_includes);\r\n  };\r\n\r\n  handleTextChange = (e) => {\r\n    const newValue = e.target.value.replace(\" \", \"_\").toLowerCase();\r\n    this.props.setValue(newValue);\r\n  };\r\n\r\n  onSuggestionClicked = (suggestion) => {\r\n    this.props.setValue(suggestion.blockName);\r\n    this.setState({ suggestionSelected: true });\r\n  };\r\n\r\n  onFocus = () => {\r\n    this.setState({ suggestionSelected: false });\r\n  };\r\n\r\n  render() {\r\n    const { coloursJSON, value } = this.props;\r\n    const { suggestionSelected } = this.state;\r\n\r\n    const relevantSuggestions = this.getRelevantSuggestions();\r\n\r\n    return (\r\n      <React.Fragment>\r\n        <input type=\"text\" value={value} onChange={this.handleTextChange} onFocus={this.onFocus} onClick={this.onFocus} />\r\n        <table className={\"blockToAddSuggestions\"} style={{ display: suggestionSelected || relevantSuggestions.length === 0 ? \"none\" : \"table\" }}>\r\n          <tbody>\r\n            {relevantSuggestions.map((suggestion) => (\r\n              <tr\r\n                className={\"blockToAddSuggestion\"}\r\n                key={`${suggestion.colourSetId}$_${suggestion.blockId}_${suggestion.blockName}`}\r\n                onClick={() => this.onSuggestionClicked(suggestion)}\r\n              >\r\n                <th>\r\n                  <BlockImage coloursJSON={coloursJSON} colourSetId={suggestion.colourSetId} blockId={suggestion.blockId} />\r\n                </th>\r\n                <th>{suggestion.blockName}</th>\r\n              </tr>\r\n            ))}\r\n          </tbody>\r\n        </table>\r\n      </React.Fragment>\r\n    );\r\n  }\r\n}\r\n\r\nexport default AutoCompleteInputBlockToAdd;\r\n","import { Component } from \"react\";\r\n\r\nimport \"./bufferedNumberInput.css\";\r\n\r\nclass BufferedNumberInput extends Component {\r\n  state = { buffer: null };\r\n\r\n  constructor(props) {\r\n    super(props);\r\n    this.state.buffer = props.value;\r\n  }\r\n\r\n  componentDidUpdate(prevProps) {\r\n    const { value } = this.props;\r\n    if (prevProps.value !== value) {\r\n      this.setState({ buffer: value });\r\n    }\r\n  }\r\n\r\n  onInputChange = (e) => {\r\n    const { validators, onValidInput } = this.props;\r\n    const newValue_buffer = e.target.value;\r\n    const newValue_int = parseInt(newValue_buffer);\r\n    this.setState({ buffer: newValue_buffer }, () => {\r\n      if (\r\n        validators.every((validator) => {\r\n          return validator(newValue_int);\r\n        })\r\n      ) {\r\n        onValidInput(newValue_int);\r\n      }\r\n    });\r\n  };\r\n\r\n  render() {\r\n    const { min, max, step, style, disabled } = this.props;\r\n    const { buffer } = this.state;\r\n    return <input type=\"number\" min={min} max={max} step={step} value={buffer} onChange={this.onInputChange} disabled={disabled} style={style} />;\r\n  }\r\n}\r\n\r\nexport default BufferedNumberInput;\r\n","import React, { Component } from \"react\";\r\n\r\nimport AutoCompleteInputBlockToAdd from \"./autoCompleteInputBlockToAdd/autoCompleteInputBlockToAdd\";\r\n\r\nimport BufferedNumberInput from \"./bufferedNumberInput/bufferedNumberInput\";\r\n\r\nimport Tooltip from \"../tooltip\";\r\n\r\nimport BackgroundColourModes from \"./json/backgroundColourModes.json\";\r\nimport CropModes from \"./json/cropModes.json\";\r\nimport DitherMethods from \"./json/ditherMethods.json\";\r\nimport MapModes from \"./json/mapModes.json\";\r\nimport SupportedVersions from \"./json/supportedVersions.json\";\r\n\r\nimport \"./mapSettings.css\";\r\n\r\nclass MapSettings extends Component {\r\n  render() {\r\n    const {\r\n      getLocaleString,\r\n      coloursJSON,\r\n      optionValue_version,\r\n      onOptionChange_version,\r\n      optionValue_mapSize_x,\r\n      onOptionChange_mapSize_x,\r\n      optionValue_mapSize_y,\r\n      onOptionChange_mapSize_y,\r\n      optionValue_modeNBTOrMapdat,\r\n      onOptionChange_modeNBTOrMapdat,\r\n      optionValue_cropImage,\r\n      onOptionChange_cropImage,\r\n      optionValue_cropImage_zoom,\r\n      onOptionChange_cropImage_zoom,\r\n      optionValue_cropImage_percent_x,\r\n      onOptionChange_cropImage_percent_x,\r\n      optionValue_cropImage_percent_y,\r\n      onOptionChange_cropImage_percent_y,\r\n      optionValue_showGridOverlay,\r\n      onOptionChange_showGridOverlay,\r\n      optionValue_staircasing,\r\n      onOptionChange_staircasing,\r\n      optionValue_supportBlock,\r\n      setOption_SupportBlock,\r\n      optionValue_transparency,\r\n      onOptionChange_transparency,\r\n      optionValue_transparencyTolerance,\r\n      onOptionChange_transparencyTolerance,\r\n      optionValue_mapdatFilenameUseId,\r\n      onOptionChange_mapdatFilenameUseId,\r\n      optionValue_mapdatFilenameIdStart,\r\n      onOptionChange_mapdatFilenameIdStart,\r\n      optionValue_betterColour,\r\n      onOptionChange_BetterColour,\r\n      optionValue_dithering,\r\n      onOptionChange_dithering,\r\n      optionValue_dithering_propagation_red,\r\n      onOptionChange_dithering_propagation_red,\r\n      optionValue_dithering_propagation_green,\r\n      onOptionChange_dithering_propagation_green,\r\n      optionValue_dithering_propagation_blue,\r\n      onOptionChange_dithering_propagation_blue,\r\n      optionValue_preprocessingEnabled,\r\n      onOptionChange_PreProcessingEnabled,\r\n      preProcessingValue_brightness,\r\n      onOptionChange_PreProcessingBrightness,\r\n      preProcessingValue_contrast,\r\n      onOptionChange_PreProcessingContrast,\r\n      preProcessingValue_saturation,\r\n      onOptionChange_PreProcessingSaturation,\r\n      preProcessingValue_backgroundColourSelect,\r\n      onOptionChange_PreProcessingBackgroundColourSelect,\r\n      preProcessingValue_backgroundColour,\r\n      onOptionChange_PreProcessingBackgroundColour,\r\n      optionValue_extras_moreStaircasingOptions,\r\n      onOptionChange_extras_moreStaircasingOptions,\r\n    } = this.props;\r\n    const setting_mode = (\r\n      <React.Fragment>\r\n        <Tooltip tooltipText={getLocaleString(\"MAP-SETTINGS/MODE-TT\")}>\r\n          <b>\r\n            {getLocaleString(\"MAP-SETTINGS/MODE\")}\r\n            {\":\"}\r\n          </b>\r\n        </Tooltip>{\" \"}\r\n        <select onChange={onOptionChange_modeNBTOrMapdat} value={optionValue_modeNBTOrMapdat}>\r\n          {Object.values(MapModes).map((mapMode) => (\r\n            <option key={mapMode.uniqueId} value={mapMode.uniqueId}>\r\n              {mapMode.name}\r\n            </option>\r\n          ))}\r\n        </select>\r\n        <br />\r\n      </React.Fragment>\r\n    );\r\n    const setting_version = (\r\n      <React.Fragment>\r\n        <Tooltip tooltipText={getLocaleString(\"MAP-SETTINGS/VERSION-TT\")}>\r\n          <b>\r\n            {getLocaleString(\"MAP-SETTINGS/VERSION\")}\r\n            {\":\"}\r\n          </b>\r\n        </Tooltip>{\" \"}\r\n        <select value={optionValue_version.MCVersion} onChange={onOptionChange_version}>\r\n          {Object.values(SupportedVersions).map((supportedVersion) => (\r\n            <option key={supportedVersion.MCVersion} value={supportedVersion.MCVersion}>\r\n              {supportedVersion.MCVersion}\r\n            </option>\r\n          ))}\r\n        </select>\r\n        <br />\r\n      </React.Fragment>\r\n    );\r\n    const setting_mapSize = (\r\n      <React.Fragment>\r\n        <b>\r\n          {getLocaleString(\"MAP-SETTINGS/MAP-SIZE\")}\r\n          {\":\"}\r\n        </b>{\" \"}\r\n        <BufferedNumberInput\r\n          min=\"1\"\r\n          max={null}\r\n          step=\"1\"\r\n          value={optionValue_mapSize_x}\r\n          validators={[(t) => !isNaN(t), (t) => t > 0]}\r\n          onValidInput={onOptionChange_mapSize_x}\r\n          style={{ width: \"2em\" }}\r\n        />\r\n        x\r\n        <BufferedNumberInput\r\n          min=\"1\"\r\n          max={null}\r\n          step=\"1\"\r\n          value={optionValue_mapSize_y}\r\n          validators={[(t) => !isNaN(t), (t) => t > 0]}\r\n          onValidInput={onOptionChange_mapSize_y}\r\n          style={{ width: \"2em\" }}\r\n        />\r\n        <br />\r\n      </React.Fragment>\r\n    );\r\n    let setting_crop = (\r\n      <tr>\r\n        <th>\r\n          <Tooltip tooltipText={getLocaleString(\"MAP-SETTINGS/CROP/TITLE-TT\")}>\r\n            <b>\r\n              {getLocaleString(\"MAP-SETTINGS/CROP/TITLE\")}\r\n              {\":\"}\r\n            </b>\r\n          </Tooltip>{\" \"}\r\n        </th>\r\n        <td>\r\n          <select onChange={onOptionChange_cropImage} value={optionValue_cropImage}>\r\n            {Object.values(CropModes).map((cropMode) => (\r\n              <option key={cropMode.uniqueId} value={cropMode.uniqueId}>\r\n                {getLocaleString(cropMode.localeKey)}\r\n              </option>\r\n            ))}\r\n          </select>\r\n        </td>\r\n        <td />\r\n      </tr>\r\n    );\r\n    let setting_crop_zoom = null;\r\n    let setting_crop_percent_x = null;\r\n    let setting_crop_percent_y = null;\r\n    if (optionValue_cropImage === CropModes.MANUAL.uniqueId) {\r\n      setting_crop_zoom = (\r\n        <tr>\r\n          <th>\r\n            <b>\r\n              {getLocaleString(\"MAP-SETTINGS/CROP/ZOOM\")}\r\n              {\":\"}\r\n            </b>{\" \"}\r\n          </th>\r\n          <td>\r\n            <input\r\n              type=\"range\"\r\n              min=\"10\"\r\n              max=\"50\"\r\n              value={optionValue_cropImage_zoom}\r\n              onChange={(e) => onOptionChange_cropImage_zoom(parseInt(e.target.value))}\r\n            />\r\n          </td>\r\n          <td />\r\n        </tr>\r\n      );\r\n      setting_crop_percent_x = (\r\n        <tr>\r\n          <th>\r\n            <b>{\"X:\"}</b>{\" \"}\r\n          </th>\r\n          <td>\r\n            <input\r\n              type=\"range\"\r\n              min=\"0\"\r\n              max=\"100\"\r\n              value={optionValue_cropImage_percent_x}\r\n              onChange={(e) => onOptionChange_cropImage_percent_x(parseInt(e.target.value))}\r\n            />\r\n          </td>\r\n          <td>\r\n            <BufferedNumberInput\r\n              min=\"0\"\r\n              max=\"100\"\r\n              step=\"1\"\r\n              value={optionValue_cropImage_percent_x}\r\n              validators={[(t) => !isNaN(t), (t) => t >= 0, (t) => t <= 100]}\r\n              onValidInput={onOptionChange_cropImage_percent_x}\r\n              style={{ width: \"3em\" }}\r\n            />\r\n          </td>\r\n        </tr>\r\n      );\r\n      setting_crop_percent_y = (\r\n        <tr>\r\n          <th>\r\n            <b>{\"Y:\"}</b>{\" \"}\r\n          </th>\r\n          <td>\r\n            <input\r\n              type=\"range\"\r\n              min=\"0\"\r\n              max=\"100\"\r\n              value={optionValue_cropImage_percent_y}\r\n              onChange={(e) => onOptionChange_cropImage_percent_y(parseInt(e.target.value))}\r\n            />\r\n          </td>\r\n          <td>\r\n            <BufferedNumberInput\r\n              min=\"0\"\r\n              max=\"100\"\r\n              step=\"1\"\r\n              value={optionValue_cropImage_percent_y}\r\n              validators={[(t) => !isNaN(t), (t) => t >= 0, (t) => t <= 100]}\r\n              onValidInput={onOptionChange_cropImage_percent_y}\r\n              style={{ width: \"3em\" }}\r\n            />\r\n          </td>\r\n        </tr>\r\n      );\r\n    }\r\n    let settingGroup_cropping = (\r\n      <div className={optionValue_cropImage === CropModes.MANUAL.uniqueId ? \"settingsGroup\" : null}>\r\n        <table>\r\n          <tbody>\r\n            {setting_crop}\r\n            {setting_crop_zoom}\r\n            {setting_crop_percent_x}\r\n            {setting_crop_percent_y}\r\n          </tbody>\r\n        </table>\r\n      </div>\r\n    );\r\n    const setting_grid = (\r\n      <React.Fragment>\r\n        <Tooltip tooltipText={getLocaleString(\"MAP-SETTINGS/GRID-OVERLAY-TT\")}>\r\n          <b>\r\n            {getLocaleString(\"MAP-SETTINGS/GRID-OVERLAY\")}\r\n            {\":\"}\r\n          </b>\r\n        </Tooltip>{\" \"}\r\n        <input type=\"checkbox\" checked={optionValue_showGridOverlay} onChange={onOptionChange_showGridOverlay} />\r\n        <br />\r\n      </React.Fragment>\r\n    );\r\n    const setting_staircasing = (\r\n      <React.Fragment>\r\n        <Tooltip tooltipText={getLocaleString(\"MAP-SETTINGS/3D/TITLE-TT\")}>\r\n          <b>\r\n            {getLocaleString(\"MAP-SETTINGS/3D/TITLE\")}\r\n            {\":\"}\r\n          </b>\r\n        </Tooltip>{\" \"}\r\n        <select onChange={onOptionChange_staircasing} value={optionValue_staircasing}>\r\n          {Object.values(\r\n            optionValue_modeNBTOrMapdat === MapModes.SCHEMATIC_NBT.uniqueId ? MapModes.SCHEMATIC_NBT.staircaseModes : MapModes.MAPDAT.staircaseModes\r\n          )\r\n            .filter((staircaseMode) => optionValue_extras_moreStaircasingOptions || !staircaseMode.extra)\r\n            .map((staircaseMode) => (\r\n              <option key={staircaseMode.uniqueId} value={staircaseMode.uniqueId}>\r\n                {getLocaleString(staircaseMode.localeKey)}\r\n              </option>\r\n            ))}\r\n        </select>\r\n        <br />\r\n      </React.Fragment>\r\n    );\r\n    let settings_mapModeConditional;\r\n    if (optionValue_modeNBTOrMapdat === MapModes.SCHEMATIC_NBT.uniqueId) {\r\n      settings_mapModeConditional = (\r\n        <React.Fragment>\r\n          <b>\r\n            {getLocaleString(\"MAP-SETTINGS/NBT-SPECIFIC/SUPPORT-BLOCK-TO-ADD\")}\r\n            {\":\"}\r\n          </b>{\" \"}\r\n          <AutoCompleteInputBlockToAdd\r\n            coloursJSON={coloursJSON}\r\n            value={optionValue_supportBlock}\r\n            setValue={setOption_SupportBlock}\r\n            optionValue_version={optionValue_version}\r\n          />\r\n          <br />\r\n        </React.Fragment>\r\n      );\r\n    } else {\r\n      let setting_transparency = (\r\n        <tr>\r\n          <th>\r\n            <Tooltip tooltipText={getLocaleString(\"MAP-SETTINGS/MAPDAT-SPECIFIC/TRANSPARENCY-TT\")}>\r\n              <b>\r\n                {getLocaleString(\"MAP-SETTINGS/MAPDAT-SPECIFIC/TRANSPARENCY\")}\r\n                {\":\"}\r\n              </b>\r\n            </Tooltip>{\" \"}\r\n          </th>\r\n          <td>\r\n            <input type=\"checkbox\" checked={optionValue_transparency} onChange={onOptionChange_transparency} />\r\n          </td>\r\n          <td />\r\n        </tr>\r\n      );\r\n      let setting_transparencyTolerance = null;\r\n      if (optionValue_transparency) {\r\n        setting_transparencyTolerance = (\r\n          <tr>\r\n            <th>\r\n              <b>\r\n                {getLocaleString(\"MAP-SETTINGS/MAPDAT-SPECIFIC/TRANSPARENCY-TOLERANCE\")}\r\n                {\":\"}\r\n              </b>{\" \"}\r\n            </th>\r\n            <td>\r\n              <input\r\n                type=\"range\"\r\n                min=\"0\"\r\n                max=\"256\"\r\n                value={optionValue_transparencyTolerance}\r\n                onChange={(e) => onOptionChange_transparencyTolerance(parseInt(e.target.value))}\r\n              />\r\n            </td>\r\n            <td>\r\n              <BufferedNumberInput\r\n                min=\"0\"\r\n                max=\"256\"\r\n                step=\"1\"\r\n                value={optionValue_transparencyTolerance}\r\n                validators={[(t) => !isNaN(t), (t) => t >= 0, (t) => t <= 256]}\r\n                onValidInput={onOptionChange_transparencyTolerance}\r\n                style={{ width: \"3em\" }}\r\n              />\r\n            </td>\r\n          </tr>\r\n        );\r\n      }\r\n      let settingGroup_transparency = (\r\n        <div className={optionValue_transparency ? \"settingsGroup\" : null}>\r\n          <table>\r\n            <tbody>\r\n              {setting_transparency}\r\n              {setting_transparencyTolerance}\r\n            </tbody>\r\n          </table>\r\n        </div>\r\n      );\r\n      let setting_mapdatFilenameUseId = (\r\n        <tr>\r\n          <th>\r\n            <Tooltip tooltipText={getLocaleString(\"MAP-SETTINGS/MAPDAT-SPECIFIC/MAPDAT-FILENAME-USE-ID-TT\")}>\r\n              <b>\r\n                {getLocaleString(\"MAP-SETTINGS/MAPDAT-SPECIFIC/MAPDAT-FILENAME-USE-ID\")}\r\n                {\":\"}\r\n              </b>\r\n            </Tooltip>{\" \"}\r\n          </th>\r\n          <td>\r\n            <input type=\"checkbox\" checked={optionValue_mapdatFilenameUseId} onChange={onOptionChange_mapdatFilenameUseId} />\r\n          </td>\r\n          <td />\r\n          <td />\r\n        </tr>\r\n      );\r\n      let setting_mapdatFilenameIdStart = null;\r\n      if (optionValue_mapdatFilenameUseId) {\r\n        setting_mapdatFilenameIdStart = (\r\n          <tr>\r\n            <th>\r\n              <b>\r\n                {getLocaleString(\"MAP-SETTINGS/MAPDAT-SPECIFIC/MAPDAT-FILENAME-ID-RANGE\")}\r\n                {\":\"}\r\n              </b>{\" \"}\r\n            </th>\r\n            <td>\r\n              <BufferedNumberInput\r\n                min=\"0\"\r\n                step=\"1\"\r\n                value={optionValue_mapdatFilenameIdStart}\r\n                validators={[(t) => !isNaN(t), (t) => t >= 0]}\r\n                onValidInput={onOptionChange_mapdatFilenameIdStart}\r\n                style={{ width: \"3em\" }}\r\n              />\r\n            </td>\r\n            <td>\r\n              <b>{\"-\"}</b>\r\n            </td>\r\n            <td>\r\n              <BufferedNumberInput\r\n                value={-1 + optionValue_mapdatFilenameIdStart + optionValue_mapSize_x * optionValue_mapSize_y}\r\n                disabled={true}\r\n                style={{ width: \"3em\" }}\r\n              />\r\n            </td>\r\n          </tr>\r\n        );\r\n      }\r\n      let settingGroup_mapdatFilename = (\r\n        <div className={optionValue_mapdatFilenameUseId ? \"settingsGroup\" : null}>\r\n          <table>\r\n            <tbody>\r\n              {setting_mapdatFilenameUseId}\r\n              {setting_mapdatFilenameIdStart}\r\n            </tbody>\r\n          </table>\r\n        </div>\r\n      );\r\n      settings_mapModeConditional = (\r\n        <React.Fragment>\r\n          {settingGroup_transparency}\r\n          {settingGroup_mapdatFilename}\r\n        </React.Fragment>\r\n      );\r\n    }\r\n    const setting_betterColour = (\r\n      <React.Fragment>\r\n        <Tooltip tooltipText={getLocaleString(\"MAP-SETTINGS/BETTER-COLOUR-TT\")}>\r\n          <b>\r\n            {getLocaleString(\"MAP-SETTINGS/BETTER-COLOUR\")}\r\n            {\":\"}\r\n          </b>\r\n        </Tooltip>{\" \"}\r\n        <input type=\"checkbox\" checked={optionValue_betterColour} onChange={onOptionChange_BetterColour} />\r\n        <br />\r\n      </React.Fragment>\r\n    );\r\n    const setting_dithering = (\r\n      <React.Fragment>\r\n        <Tooltip tooltipText={getLocaleString(\"MAP-SETTINGS/DITHERING/TITLE-TT\")}>\r\n          <b>\r\n            {getLocaleString(\"MAP-SETTINGS/DITHERING/TITLE\")}\r\n            {\":\"}\r\n          </b>\r\n        </Tooltip>{\" \"}\r\n        <select value={optionValue_dithering} onChange={onOptionChange_dithering}>\r\n          {Object.keys(DitherMethods).map((ditherMethodKey) => (\r\n            <option key={DitherMethods[ditherMethodKey][\"uniqueId\"]} value={DitherMethods[ditherMethodKey][\"uniqueId\"]}>\r\n              {\"localeKey\" in DitherMethods[ditherMethodKey]\r\n                ? getLocaleString(DitherMethods[ditherMethodKey][\"localeKey\"])\r\n                : DitherMethods[ditherMethodKey][\"name\"]}\r\n            </option>\r\n          ))}\r\n        </select>\r\n        <br />\r\n      </React.Fragment>\r\n    );\r\n    const setting_dithering_propagation_red = (\r\n      <tr>\r\n        <th>\r\n          <b>\r\n            {getLocaleString(\"MAP-SETTINGS/DITHERING/PROPAGATION-RED\")}\r\n            {\":\"}\r\n          </b>{\" \"}\r\n        </th>\r\n        <td>\r\n          <input\r\n            type=\"range\"\r\n            min=\"0\"\r\n            max=\"200\"\r\n            value={optionValue_dithering_propagation_red}\r\n            onChange={(e) => onOptionChange_dithering_propagation_red(parseInt(e.target.value))}\r\n          />\r\n        </td>\r\n        <td>\r\n          <BufferedNumberInput\r\n            min=\"0\"\r\n            max=\"200\"\r\n            step=\"1\"\r\n            value={optionValue_dithering_propagation_red}\r\n            validators={[(t) => !isNaN(t), (t) => t >= 0, (t) => t <= 200]}\r\n            onValidInput={onOptionChange_dithering_propagation_red}\r\n            style={{ width: \"3em\" }}\r\n          />\r\n        </td>\r\n      </tr>\r\n    );\r\n    const setting_dithering_propagation_green = (\r\n      <tr>\r\n        <th>\r\n          <b>\r\n            {getLocaleString(\"MAP-SETTINGS/DITHERING/PROPAGATION-GREEN\")}\r\n            {\":\"}\r\n          </b>{\" \"}\r\n        </th>\r\n        <td>\r\n          <input\r\n            type=\"range\"\r\n            min=\"0\"\r\n            max=\"200\"\r\n            value={optionValue_dithering_propagation_green}\r\n            onChange={(e) => onOptionChange_dithering_propagation_green(parseInt(e.target.value))}\r\n          />\r\n        </td>\r\n        <td>\r\n          <BufferedNumberInput\r\n            min=\"0\"\r\n            max=\"200\"\r\n            step=\"1\"\r\n            value={optionValue_dithering_propagation_green}\r\n            validators={[(t) => !isNaN(t), (t) => t >= 0, (t) => t <= 200]}\r\n            onValidInput={onOptionChange_dithering_propagation_green}\r\n            style={{ width: \"3em\" }}\r\n          />\r\n        </td>\r\n      </tr>\r\n    );\r\n    const setting_dithering_propagation_blue = (\r\n      <tr>\r\n        <th>\r\n          <b>\r\n            {getLocaleString(\"MAP-SETTINGS/DITHERING/PROPAGATION-BLUE\")}\r\n            {\":\"}\r\n          </b>{\" \"}\r\n        </th>\r\n        <td>\r\n          <input\r\n            type=\"range\"\r\n            min=\"0\"\r\n            max=\"200\"\r\n            value={optionValue_dithering_propagation_blue}\r\n            onChange={(e) => onOptionChange_dithering_propagation_blue(parseInt(e.target.value))}\r\n          />\r\n        </td>\r\n        <td>\r\n          <BufferedNumberInput\r\n            min=\"0\"\r\n            max=\"200\"\r\n            step=\"1\"\r\n            value={optionValue_dithering_propagation_blue}\r\n            validators={[(t) => !isNaN(t), (t) => t >= 0, (t) => t <= 200]}\r\n            onValidInput={onOptionChange_dithering_propagation_blue}\r\n            style={{ width: \"3em\" }}\r\n          />\r\n        </td>\r\n      </tr>\r\n    );\r\n    const setting_dithering_propagation = (\r\n      <div>\r\n        <table>\r\n          <tbody>\r\n            {setting_dithering_propagation_red}\r\n            {setting_dithering_propagation_green}\r\n            {setting_dithering_propagation_blue}\r\n          </tbody>\r\n        </table>\r\n      </div>\r\n    );\r\n    const setting_preprocessing = (\r\n      <tr>\r\n        <th>\r\n          <b>\r\n            {getLocaleString(\"MAP-SETTINGS/PREPROCESSING/ENABLE\")}\r\n            {\":\"}\r\n          </b>{\" \"}\r\n          <input type=\"checkbox\" checked={optionValue_preprocessingEnabled} onChange={onOptionChange_PreProcessingEnabled} />\r\n        </th>\r\n        <td />\r\n        <td />\r\n      </tr>\r\n    );\r\n    const setting_preprocessing_brightness = (\r\n      <tr>\r\n        <th>\r\n          <b>\r\n            {getLocaleString(\"MAP-SETTINGS/PREPROCESSING/BRIGHTNESS\")}\r\n            {\":\"}\r\n          </b>{\" \"}\r\n        </th>\r\n        <td>\r\n          <input\r\n            type=\"range\"\r\n            min=\"0\"\r\n            max=\"200\"\r\n            value={preProcessingValue_brightness}\r\n            onChange={(e) => onOptionChange_PreProcessingBrightness(parseInt(e.target.value))}\r\n            disabled={!optionValue_preprocessingEnabled}\r\n          />\r\n        </td>\r\n        <td>\r\n          <BufferedNumberInput\r\n            min=\"0\"\r\n            max=\"200\"\r\n            step=\"1\"\r\n            value={preProcessingValue_brightness}\r\n            validators={[(t) => !isNaN(t), (t) => t >= 0, (t) => t <= 200]}\r\n            onValidInput={onOptionChange_PreProcessingBrightness}\r\n            disabled={!optionValue_preprocessingEnabled}\r\n            style={{ width: \"3em\" }}\r\n          />\r\n        </td>\r\n      </tr>\r\n    );\r\n    const setting_preprocessing_contrast = (\r\n      <tr>\r\n        <th>\r\n          <b>\r\n            {getLocaleString(\"MAP-SETTINGS/PREPROCESSING/CONTRAST\")}\r\n            {\":\"}\r\n          </b>{\" \"}\r\n        </th>\r\n        <td>\r\n          <input\r\n            type=\"range\"\r\n            min=\"0\"\r\n            max=\"200\"\r\n            value={preProcessingValue_contrast}\r\n            onChange={(e) => onOptionChange_PreProcessingContrast(parseInt(parseInt(e.target.value)))}\r\n            disabled={!optionValue_preprocessingEnabled}\r\n          />\r\n        </td>\r\n        <td>\r\n          <BufferedNumberInput\r\n            min=\"0\"\r\n            max=\"200\"\r\n            step=\"1\"\r\n            value={preProcessingValue_contrast}\r\n            validators={[(t) => !isNaN(t), (t) => t >= 0, (t) => t <= 200]}\r\n            onValidInput={onOptionChange_PreProcessingContrast}\r\n            disabled={!optionValue_preprocessingEnabled}\r\n            style={{ width: \"3em\" }}\r\n          />\r\n        </td>\r\n      </tr>\r\n    );\r\n    const setting_preprocessing_saturation = (\r\n      <tr>\r\n        <th>\r\n          <b>\r\n            {getLocaleString(\"MAP-SETTINGS/PREPROCESSING/SATURATION\")}\r\n            {\":\"}\r\n          </b>{\" \"}\r\n        </th>\r\n        <td>\r\n          <input\r\n            type=\"range\"\r\n            min=\"0\"\r\n            max=\"200\"\r\n            value={preProcessingValue_saturation}\r\n            onChange={(e) => onOptionChange_PreProcessingSaturation(parseInt(e.target.value))}\r\n            disabled={!optionValue_preprocessingEnabled}\r\n          />\r\n        </td>\r\n        <td>\r\n          <BufferedNumberInput\r\n            min=\"0\"\r\n            max=\"200\"\r\n            step=\"1\"\r\n            value={preProcessingValue_saturation}\r\n            validators={[(t) => !isNaN(t), (t) => t >= 0, (t) => t <= 200]}\r\n            onValidInput={onOptionChange_PreProcessingSaturation}\r\n            disabled={!optionValue_preprocessingEnabled}\r\n            style={{ width: \"3em\" }}\r\n          />\r\n        </td>\r\n      </tr>\r\n    );\r\n    const setting_preprocessing_background = (\r\n      <tr>\r\n        <th>\r\n          <Tooltip tooltipText={getLocaleString(\"MAP-SETTINGS/PREPROCESSING/BACKGROUND/TITLE-TT\")}>\r\n            <b>\r\n              {getLocaleString(\"MAP-SETTINGS/PREPROCESSING/BACKGROUND/TITLE\")}\r\n              {\":\"}\r\n            </b>\r\n          </Tooltip>{\" \"}\r\n        </th>\r\n        <td>\r\n          <select\r\n            onChange={onOptionChange_PreProcessingBackgroundColourSelect}\r\n            value={preProcessingValue_backgroundColourSelect}\r\n            disabled={!optionValue_preprocessingEnabled}\r\n          >\r\n            {Object.values(BackgroundColourModes).map((backgroundColourMode) => (\r\n              <option key={backgroundColourMode.uniqueId} value={backgroundColourMode.uniqueId}>\r\n                {getLocaleString(backgroundColourMode.localeKey)}\r\n              </option>\r\n            ))}\r\n          </select>\r\n        </td>\r\n      </tr>\r\n    );\r\n    const setting_preprocessing_backgroundColour = (\r\n      <tr>\r\n        <th>\r\n          <b>\r\n            {getLocaleString(\"MAP-SETTINGS/PREPROCESSING/BACKGROUND-COLOUR\")}\r\n            {\":\"}\r\n          </b>{\" \"}\r\n        </th>\r\n        <td>\r\n          <input\r\n            type=\"color\"\r\n            value={preProcessingValue_backgroundColour}\r\n            onChange={onOptionChange_PreProcessingBackgroundColour}\r\n            disabled={!optionValue_preprocessingEnabled || preProcessingValue_backgroundColourSelect === BackgroundColourModes.OFF.uniqueId}\r\n          />\r\n        </td>\r\n      </tr>\r\n    );\r\n    const settingGroup_preprocessing = (\r\n      <React.Fragment>\r\n        <details>\r\n          <summary>{getLocaleString(\"MAP-SETTINGS/PREPROCESSING/TITLE\")}</summary>\r\n          <div className={optionValue_preprocessingEnabled ? \"settingsGroup\" : null}>\r\n            <table>\r\n              <tbody>\r\n                {setting_preprocessing}\r\n                {setting_preprocessing_brightness}\r\n                {setting_preprocessing_contrast}\r\n                {setting_preprocessing_saturation}\r\n                {setting_preprocessing_background}\r\n                {setting_preprocessing_backgroundColour}\r\n              </tbody>\r\n            </table>\r\n          </div>\r\n        </details>\r\n      </React.Fragment>\r\n    );\r\n    const setting_extras_moreStaircasingOptions = (\r\n      <tr>\r\n        <th>\r\n          <Tooltip tooltipText={getLocaleString(\"MAP-SETTINGS/EXTRAS/MORE-STAIRCASING-OPTIONS-TT\")}>\r\n            <b>\r\n              {getLocaleString(\"MAP-SETTINGS/EXTRAS/MORE-STAIRCASING-OPTIONS\")}\r\n              {\":\"}\r\n            </b>\r\n          </Tooltip>{\" \"}\r\n        </th>\r\n        <td>\r\n          <input type=\"checkbox\" checked={optionValue_extras_moreStaircasingOptions} onChange={onOptionChange_extras_moreStaircasingOptions} />\r\n        </td>\r\n      </tr>\r\n    );\r\n    const settingGroup_extras = (\r\n      <React.Fragment>\r\n        <details>\r\n          <summary>{getLocaleString(\"MAP-SETTINGS/EXTRAS/TITLE\")}</summary>\r\n          <table>\r\n            <tbody>{setting_extras_moreStaircasingOptions}</tbody>\r\n          </table>\r\n        </details>\r\n      </React.Fragment>\r\n    );\r\n    const settingsDiv = (\r\n      <div className=\"section settingsDiv\">\r\n        <h2>{getLocaleString(\"MAP-SETTINGS/TITLE\")}</h2>\r\n        {setting_mode}\r\n        {setting_version}\r\n        {setting_mapSize}\r\n        {settingGroup_cropping}\r\n        {setting_grid}\r\n        {setting_staircasing}\r\n        {settings_mapModeConditional}\r\n        {setting_betterColour}\r\n        {setting_dithering}\r\n        {setting_dithering_propagation}\r\n        {settingGroup_preprocessing}\r\n        {settingGroup_extras}\r\n      </div>\r\n    );\r\n    return settingsDiv;\r\n  }\r\n}\r\n\r\nexport default MapSettings;\r\n","import React, { Component } from \"react\";\r\n\r\nimport Tooltip from \"../tooltip\";\r\n\r\nimport BlockImage from \"./blockImage\";\r\n\r\nimport \"./materials.css\";\r\n\r\nclass Materials extends Component {\r\n  state = { onlyMaxPerSplit: false };\r\n\r\n  onOnlyMaxPerSplitChange = () => {\r\n    this.setState((currentState) => ({\r\n      // nb this method of passing currentState instead of using this.state... is prefered; TODO neaten up controller uses\r\n      onlyMaxPerSplit: !currentState.onlyMaxPerSplit,\r\n    }));\r\n  };\r\n\r\n  getMaterialsCount_nonZeroMaterialsItems() {\r\n    const { coloursJSON, currentMaterialsData } = this.props;\r\n    const { onlyMaxPerSplit } = this.state;\r\n    const materialsCount = {};\r\n    for (const colourSetId of Object.keys(coloursJSON)) {\r\n      materialsCount[colourSetId] = 0;\r\n    }\r\n    for (const row of currentMaterialsData.maps) {\r\n      for (const map of row) {\r\n        for (const [colourSetId, materialCount] of Object.entries(map.materials)) {\r\n          if (onlyMaxPerSplit) {\r\n            materialsCount[colourSetId] = Math.max(materialsCount[colourSetId], materialCount);\r\n          } else {\r\n            materialsCount[colourSetId] += materialCount;\r\n          }\r\n        }\r\n      }\r\n    }\r\n    return Object.entries(materialsCount)\r\n      .filter(([_, value]) => value !== 0)\r\n      .sort((first, second) => {\r\n        return second[1] - first[1];\r\n      });\r\n  }\r\n\r\n  getMaterialsCount_supportBlock() {\r\n    const { currentMaterialsData } = this.props;\r\n    const { onlyMaxPerSplit } = this.state;\r\n    let supportBlockCount = 0;\r\n    currentMaterialsData.maps.forEach((row) => {\r\n      row.forEach((map) => {\r\n        const count = map.supportBlockCount;\r\n        if (onlyMaxPerSplit) {\r\n          supportBlockCount = Math.max(supportBlockCount, count);\r\n        } else {\r\n          supportBlockCount += count;\r\n        }\r\n      });\r\n    });\r\n    return supportBlockCount;\r\n  }\r\n\r\n  formatMaterialCount = (count) => {\r\n    if (count < 64) return '' + count;\r\n\r\n    const numberOfShulkers = Math.floor(count / 1728);\r\n    const numberOfStacks = Math.floor((count % 1728) / 64);\r\n    const remainder = count % 64;\r\n\r\n    const sb = numberOfShulkers > 0 ? `${numberOfShulkers} B` : \"\";\r\n    const stacks = numberOfStacks > 0 ? `${numberOfStacks} S` : \"\";\r\n    const items = remainder > 0 ? `${remainder} I`: \"\";\r\n\r\n    const split = [sb, stacks, items].filter(n => n).join(' + ');\r\n\r\n    return `${count.toString()} (${split})`;\r\n  };\r\n\r\n  colourSetIdAndBlockIdFromNBTName(blockName) {\r\n    const { coloursJSON, optionValue_version } = this.props;\r\n    for (const [colourSetId, colourSet] of Object.entries(coloursJSON)) {\r\n      for (const [blockId, block] of Object.entries(colourSet.blocks)) {\r\n        if (!(optionValue_version.MCVersion in block.validVersions)) {\r\n          continue;\r\n        }\r\n        let blockNBTData = block.validVersions[optionValue_version.MCVersion];\r\n        if (typeof blockNBTData === \"string\") {\r\n          // this is of the form eg \"&1.12.2\"\r\n          blockNBTData = block.validVersions[blockNBTData.slice(1)];\r\n        }\r\n        if (\r\n          Object.keys(blockNBTData.NBTArgs).length === 0 && // no exotic blocks for noobline\r\n          blockName.toLowerCase() === blockNBTData.NBTName.toLowerCase()\r\n        ) {\r\n          return { colourSetId, blockId };\r\n        }\r\n      }\r\n    }\r\n    return null; // if block not found\r\n  }\r\n\r\n  nbtNameToColourSetId(colourSetId) {\r\n    const { coloursJSON, optionValue_version, currentMaterialsData } = this.props;\r\n    const colourSet = coloursJSON[colourSetId];\r\n    const selection = currentMaterialsData.currentSelectedBlocks[colourSetId];\r\n\r\n    if (selection < 0) return null;\r\n\r\n    const block = colourSet.blocks[selection];\r\n    if (!(optionValue_version.MCVersion in block.validVersions)) {\r\n      return null;\r\n    }\r\n    let blockNBTData = block.validVersions[optionValue_version.MCVersion];\r\n\r\n    if (typeof blockNBTData === \"string\") {\r\n      // this is of the form eg \"&1.12.2\"\r\n      blockNBTData = block.validVersions[blockNBTData.slice(1)];\r\n    }\r\n\r\n    return blockNBTData.NBTName.toLowerCase();\r\n  }\r\n\r\n  copyToClipboard(nonZeroMaterialsItems, supportBlockCount) {\r\n    const { optionValue_supportBlock} = this.props;\r\n\r\n    const mergedList = new Array(nonZeroMaterialsItems.length);\r\n\r\n    for (const [colourSetId, val] of Object.values(nonZeroMaterialsItems)) {\r\n      const mcId = this.nbtNameToColourSetId(colourSetId);\r\n      mergedList[mcId] = val;\r\n    }\r\n\r\n    mergedList[optionValue_supportBlock] += supportBlockCount;\r\n\r\n    const counts = Object.fromEntries(\r\n      Object.entries(mergedList.sort((first, second) => second - first))\r\n      .map(([k, v]) => [k, this.formatMaterialCount(v)]));\r\n      \r\n    const NBSP = String.fromCharCode(160); //non-breaking space\r\n    const CRLF = String.fromCharCode(13, 10); //new line\r\n\r\n    const results = [\"```\"];\r\n\r\n    //calculate paddings\r\n    let nameMaxLength = 0;\r\n\r\n    for (const key of Object.keys(counts)) {\r\n      if (nameMaxLength < key.length)\r\n        nameMaxLength = key.length;\r\n    }\r\n\r\n    //insert each entry\r\n    for (const [key, val] of Object.entries(counts)) {\r\n      results.push(key.padEnd(nameMaxLength, NBSP) + \" = \" + val);\r\n    }\r\n\r\n    results.push(\"```\");\r\n\r\n    navigator.clipboard.writeText(results.join(CRLF));\r\n  }\r\n\r\n  render() {\r\n    const { getLocaleString, coloursJSON, optionValue_supportBlock, currentMaterialsData, onChangeColourSetBlock } = this.props;\r\n    const { onlyMaxPerSplit } = this.state;\r\n    const nonZeroMaterialsItems = this.getMaterialsCount_nonZeroMaterialsItems();\r\n    const supportBlockCount = this.getMaterialsCount_supportBlock();\r\n    const supportBlockIds = this.colourSetIdAndBlockIdFromNBTName(optionValue_supportBlock);\r\n    return (\r\n      <div className=\"section materialsDiv\">\r\n        <h2>{getLocaleString(\"MATERIALS/TITLE\")}</h2>\r\n        <Tooltip tooltipText={getLocaleString(\"MATERIALS/SHOW-PER-SPLIT-TT\")}>\r\n          <b>\r\n            {getLocaleString(\"MATERIALS/SHOW-PER-SPLIT\")}\r\n            {\":\"}\r\n          </b>\r\n        </Tooltip>{\" \"}\r\n        <input type=\"checkbox\" checked={onlyMaxPerSplit} onChange={this.onOnlyMaxPerSplitChange} />\r\n        <br />\r\n        <button type=\"button\" onClick={() => this.copyToClipboard(nonZeroMaterialsItems, supportBlockCount)}>{getLocaleString(\"MATERIALS/COPY-CLIPBOARD\")}</button>\r\n        <table id=\"materialtable\">\r\n          <tbody>\r\n            <tr>\r\n              <th>{getLocaleString(\"MATERIALS/BLOCK\")}</th>\r\n              <th>{getLocaleString(\"MATERIALS/AMOUNT\")}</th>\r\n            </tr>\r\n            {supportBlockCount !== 0 && (\r\n              <tr>\r\n                <th>\r\n                  <Tooltip tooltipText={getLocaleString(\"MATERIALS/PLACEHOLDER-BLOCK-TT\")}>\r\n                    <BlockImage\r\n                      getLocaleString={getLocaleString}\r\n                      coloursJSON={coloursJSON}\r\n                      colourSetId={supportBlockIds === null ? \"64\" : supportBlockIds.colourSetId}\r\n                      blockId={supportBlockIds === null ? \"2\" : supportBlockIds.blockId}\r\n                    />\r\n                  </Tooltip>\r\n                </th>\r\n                <th>{this.formatMaterialCount(supportBlockCount)}</th>\r\n              </tr>\r\n            )}\r\n            {nonZeroMaterialsItems.map(([colourSetId, materialCount]) => {\r\n              const blockId = currentMaterialsData.currentSelectedBlocks[colourSetId];\r\n              return (\r\n                <tr key={colourSetId}>\r\n                  <th>\r\n                    <Tooltip tooltipText={coloursJSON[colourSetId].blocks[blockId].displayName}>\r\n                      <BlockImage coloursJSON={coloursJSON} colourSetId={colourSetId} blockId={blockId} />\r\n                    </Tooltip>\r\n                    <Tooltip tooltipText={getLocaleString(\"NONE\")}>\r\n                      <BlockImage\r\n                        getLocaleString={getLocaleString}\r\n                        coloursJSON={coloursJSON}\r\n                        colourSetId={colourSetId}\r\n                        blockId={\"-1\"}\r\n                        onClick={() => onChangeColourSetBlock(colourSetId, \"-1\")}\r\n                        style={{\r\n                          cursor: \"pointer\"\r\n                        }}\r\n                      />\r\n                    </Tooltip>\r\n                  </th>\r\n                  <th>{this.formatMaterialCount(materialCount)}</th>\r\n                </tr>\r\n              );\r\n            })}\r\n          </tbody>\r\n        </table>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default Materials;\r\n","/*\r\n  A mapping from type names to NBT type numbers.\r\n  This is NOT just an enum, these values have to stay as they are\r\n  https://minecraft.wiki/w/NBT_format#TAG_definition\r\n*/\r\nconst TagTypes = {\r\n  end: 0,\r\n  byte: 1,\r\n  short: 2,\r\n  int: 3,\r\n  long: 4,\r\n  float: 5,\r\n  double: 6,\r\n  byteArray: 7,\r\n  string: 8,\r\n  list: 9,\r\n  compound: 10,\r\n  intArray: 11,\r\n  longArray: 12,\r\n};\r\n\r\nclass NBTReader {\r\n  constructor() {\r\n    if (typeof ArrayBuffer === \"undefined\") {\r\n      throw new Error(\"Missing required type ArrayBuffer\");\r\n    }\r\n    if (typeof DataView === \"undefined\") {\r\n      throw new Error(\"Missing required type DataView\");\r\n    }\r\n    if (typeof Uint8Array === \"undefined\") {\r\n      throw new Error(\"Missing required type Uint8Array\");\r\n    }\r\n    this.buffer = null;\r\n    this.dataView = null;\r\n    this.arrayView = null;\r\n    this.offset = null;\r\n  }\r\n\r\n  loadBuffer(buffer) {\r\n    this.buffer = buffer;\r\n    this.dataView = new DataView(this.buffer);\r\n    this.arrayView = new Uint8Array(this.buffer);\r\n    this.offset = 0;\r\n  }\r\n\r\n  decodeUTF8(bytes) {\r\n    let codepoints = [];\r\n    for (let i = 0; i < bytes.length; i++) {\r\n      const byte = bytes[i];\r\n      if ((byte & 0x80) === 0) {\r\n        // single byte 0x0001 to 0x007F\r\n        codepoints.push(byte);\r\n      } else if ((byte & 0xe0) === 0xc0) {\r\n        // two bytes for 0x0000 and 0x0080 to 0x07FF\r\n        codepoints.push(((byte & 0x1f) << 6) | (bytes[i + 1] & 0x3f));\r\n        i += 1;\r\n      } else if ((byte & 0xf0) === 0xe0) {\r\n        // three bytes for 0x0800 to 0xFFFF\r\n        codepoints.push(((byte & 0x0f) << 12) | ((bytes[i + 1] & 0x3f) << 6) | (bytes[i + 2] & 0x3f));\r\n        i += 2;\r\n      }\r\n    }\r\n    return String.fromCharCode.apply(null, codepoints);\r\n  }\r\n\r\n  read(dataType, size) {\r\n    const value = this.dataView[`get${dataType}`](this.offset);\r\n    this.offset += size;\r\n    return value;\r\n  }\r\n\r\n  readByType(dataType) {\r\n    switch (dataType) {\r\n      case TagTypes.end: {\r\n        return this.readByType(TagTypes.byte);\r\n      }\r\n      case TagTypes.byte: {\r\n        return this.read(\"Int8\", 1);\r\n      }\r\n      case TagTypes.short: {\r\n        return this.read(\"Int16\", 2);\r\n      }\r\n      case TagTypes.int: {\r\n        return this.read(\"Int32\", 4);\r\n      }\r\n      case TagTypes.long: {\r\n        // NB: special: JS doesn't support native 64 bit ints; returns an array of two 32 bit ints\r\n        return [this.readByType(TagTypes.int), this.readByType(TagTypes.int)];\r\n      }\r\n      case TagTypes.float: {\r\n        return this.read(\"Float32\", 4);\r\n      }\r\n      case TagTypes.double: {\r\n        return this.read(\"Float64\", 8);\r\n      }\r\n      case TagTypes.byteArray: {\r\n        const arrayLength = this.readByType(TagTypes.int);\r\n        const returnArray = this.arrayView.slice(this.offset, this.offset + arrayLength);\r\n        this.offset += arrayLength;\r\n        return returnArray;\r\n      }\r\n      case TagTypes.string: {\r\n        const string_bytes_length = this.readByType(TagTypes.short);\r\n        const string_bytes = this.arrayView.slice(this.offset, this.offset + string_bytes_length);\r\n        this.offset += string_bytes_length;\r\n        return this.decodeUTF8(string_bytes);\r\n      }\r\n      case TagTypes.list: {\r\n        const list_objectType = this.readByType(TagTypes.byte);\r\n        const list_length = this.readByType(TagTypes.int);\r\n        let returnObject = { type: list_objectType, value: [] };\r\n        for (let i = 0; i < list_length; i++) {\r\n          returnObject.value.push(this.readByType(list_objectType));\r\n        }\r\n        return returnObject;\r\n      }\r\n      case TagTypes.compound: {\r\n        let returnObject = {};\r\n        while (true) {\r\n          let tagType = this.readByType(TagTypes.byte);\r\n          if (tagType === TagTypes.end) {\r\n            break;\r\n          } else {\r\n            let key = this.readByType(TagTypes.string);\r\n            let value = this.readByType(tagType);\r\n            returnObject[key] = { type: tagType, value: value };\r\n          }\r\n        }\r\n        return returnObject;\r\n      }\r\n      case TagTypes.intArray: {\r\n        const returnArray = [];\r\n        const array_length = this.readByType(TagTypes.int);\r\n        for (let i = 0; i < array_length; i++) {\r\n          returnArray.push(this.readByType(TagTypes.int));\r\n        }\r\n        return returnArray;\r\n      }\r\n      case TagTypes.longArray: {\r\n        const returnArray = [];\r\n        const array_length = this.readByType(TagTypes.int);\r\n        for (let i = 0; i < array_length; i++) {\r\n          returnArray.push(this.readByType(TagTypes.long));\r\n          // NB this is an array of length 2 arrays of ints as specified in case:long\r\n        }\r\n        return returnArray;\r\n      }\r\n      default: {\r\n        throw new Error(`Unknown data type ${dataType}`);\r\n      }\r\n    }\r\n  }\r\n\r\n  getData() {\r\n    this.readByType(TagTypes.byte);\r\n    return {\r\n      name: this.readByType(TagTypes.string),\r\n      value: this.readByType(TagTypes.compound),\r\n    }; // NB this reads the top-level compound which does not have a terminating null byte\r\n  }\r\n}\r\n\r\nexport default NBTReader;\r\n","import React, { Component } from \"react\";\r\n\r\nimport BlockImage from \"../blockImage\";\r\n\r\nimport \"./waila.css\";\r\n\r\n// What Am I Looking At\r\n\r\nclass Waila extends Component {\r\n  render() {\r\n    const { getLocaleString, coloursJSON, selectedBlock, ...props_others } = this.props;\r\n    return (\r\n      <div className={\"viewOnline_waila\"} {...props_others}>\r\n        <h3>{`x: ${selectedBlock.x.toString()} y: ${selectedBlock.y.toString()} z: ${selectedBlock.z.toString()}`}</h3>\r\n        <BlockImage\r\n          getLocaleString={getLocaleString}\r\n          coloursJSON={coloursJSON}\r\n          colourSetId={selectedBlock.colourSetId.toString()}\r\n          blockId={selectedBlock.blockId.toString()}\r\n          style={{ verticalAlign: \"middle\" }}\r\n        />{\" \"}\r\n        {selectedBlock.colourSetId === 64 && selectedBlock.blockId === 2\r\n          ? getLocaleString(\"MATERIALS/PLACEHOLDER-BLOCK-TT\")\r\n          : coloursJSON[selectedBlock.colourSetId.toString()].blocks[selectedBlock.blockId.toString()].displayName}\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default Waila;\r\n","import React, { Component, createRef } from \"react\";\r\n\r\nimport Tooltip from \"../../tooltip\";\r\n\r\nimport MapModes from \"../json/mapModes.json\";\r\n\r\nimport IMG_Textures from \"../../../images/textures.png\";\r\n\r\nimport NBTReader from \"../nbtReader\";\r\nimport Waila from \"../viewOnlineCommon/waila\";\r\n\r\nimport \"./viewOnline2D.css\";\r\n\r\nclass ViewOnline2D extends Component {\r\n  state = {\r\n    viewOnline_NBT_decompressed: null,\r\n    selectedBlock: null,\r\n    zoomFactor: 1,\r\n    canvasOffset_x: 0,\r\n    canvasOffset_y: 0,\r\n  };\r\n\r\n  paletteIdToColourSetIdAndBlockId = [];\r\n  mouse = { x: 0, y: 0, down: false, movedSinceDown: null };\r\n\r\n  getNBTDecompressed() {\r\n    const { viewOnline_NBT } = this.props;\r\n    let nbtReader = new NBTReader();\r\n    nbtReader.loadBuffer(viewOnline_NBT);\r\n    const viewOnline_NBT_decompressed = nbtReader.getData();\r\n    return viewOnline_NBT_decompressed;\r\n  }\r\n\r\n  drawNBT() {\r\n    const { coloursJSON, optionValue_version, optionValue_mapSize_x, optionValue_mapSize_y, optionValue_staircasing } = this.props;\r\n    const { viewOnline_NBT_decompressed } = this.state;\r\n    const { canvasRef_viewOnline } = this;\r\n\r\n    this.paletteIdToColourSetIdAndBlockId = [];\r\n    const NBT_palette = viewOnline_NBT_decompressed.value.palette.value.value;\r\n    for (let paletteItem_index = 0; paletteItem_index < NBT_palette.length; paletteItem_index++) {\r\n      const paletteItem = NBT_palette[paletteItem_index];\r\n      let paletteItemFound = false;\r\n      for (const [colourSetId, colourSet] of Object.entries(coloursJSON)) {\r\n        if (paletteItemFound) {\r\n          break;\r\n        }\r\n        for (const [blockId, block] of Object.entries(colourSet.blocks)) {\r\n          if (paletteItemFound) {\r\n            break;\r\n          }\r\n          if (!(optionValue_version.MCVersion in block.validVersions)) {\r\n            continue;\r\n          }\r\n          let blockNBTData = block.validVersions[optionValue_version.MCVersion];\r\n          if (typeof blockNBTData === \"string\") {\r\n            // this is of the form eg \"&1.12.2\"\r\n            blockNBTData = block.validVersions[blockNBTData.slice(1)];\r\n          }\r\n          if (\r\n            paletteItem.Name.value === `minecraft:${blockNBTData.NBTName}` &&\r\n            ((!(\"Properties\" in paletteItem) && Object.keys(blockNBTData.NBTArgs).length === 0) ||\r\n              (\"Properties\" in paletteItem &&\r\n                Object.keys(paletteItem.Properties.value).length === Object.keys(blockNBTData.NBTArgs).length &&\r\n                Object.entries(blockNBTData.NBTArgs).every(([argKey, argValue]) => {\r\n                  return argKey in paletteItem.Properties.value && argValue === paletteItem.Properties.value[argKey].value;\r\n                })))\r\n          ) {\r\n            this.paletteIdToColourSetIdAndBlockId.push([parseInt(colourSetId), parseInt(blockId)]);\r\n            paletteItemFound = true;\r\n          }\r\n        }\r\n      }\r\n      if (!paletteItemFound) {\r\n        console.log(`Didn't find ${paletteItem.Name.value} in coloursJSON; using placeholder texture`);\r\n        this.paletteIdToColourSetIdAndBlockId.push([64, 2]);\r\n      }\r\n    }\r\n\r\n    const img_textures = new Image();\r\n    img_textures.onload = () => {\r\n      const canvasRef_viewOnline_ctx = canvasRef_viewOnline.current.getContext(\"2d\");\r\n      canvasRef_viewOnline_ctx.textAlign = \"right\";\r\n      canvasRef_viewOnline_ctx.textBaseline = \"alphabetic\";\r\n      canvasRef_viewOnline_ctx.font = \"16px kenpixel_mini_square\";\r\n      canvasRef_viewOnline_ctx.fillStyle = \"rgba(0, 0, 0, 1)\";\r\n      canvasRef_viewOnline_ctx.fillRect(0, 0, 33 * 128 * optionValue_mapSize_x, 33 * (128 * optionValue_mapSize_y + 1));\r\n      let currentY = null;\r\n      let processedNoobline = false;\r\n      for (const block of viewOnline_NBT_decompressed.value.blocks.value.value) {\r\n        const block_paletteId = block.state.value;\r\n        const block_coords = block.pos.value.value;\r\n        if (block_coords[2] === 0) {\r\n          if (processedNoobline) {\r\n            continue;\r\n          } else {\r\n            processedNoobline = true;\r\n            // since we ordered blocks by Z and Y in nbt.jsworker, the first block in the column is the highest block of the\r\n            // noobline pillar (the correct height for the map preview)\r\n          }\r\n        } else {\r\n          processedNoobline = false; // ready for next column\r\n          if (block_paletteId === NBT_palette.length - 1) {\r\n            // last palette entry is support / noobline. don't draw this except on the noobline\r\n            continue;\r\n          }\r\n        }\r\n        const [int_colourSetId, int_blockId] = this.paletteIdToColourSetIdAndBlockId[block_paletteId];\r\n        let int_colourSetId_toDraw, int_blockId_toDraw;\r\n        if (!(int_colourSetId === 64 && int_blockId === 2) && coloursJSON[int_colourSetId.toString()].blocks[int_blockId.toString()].presetIndex === \"CUSTOM\") {\r\n          // if not placeholder, and is a custom block, then draw colour on canvas\r\n          int_colourSetId_toDraw = 64;\r\n          int_blockId_toDraw = 5;\r\n          canvasRef_viewOnline_ctx.fillStyle = `rgb(${coloursJSON[int_colourSetId.toString()].tonesRGB.normal.join(\", \")})`;\r\n          canvasRef_viewOnline_ctx.fillRect(33 * block_coords[0], 33 * block_coords[2], 32, 32);\r\n        } else {\r\n          int_colourSetId_toDraw = int_colourSetId;\r\n          int_blockId_toDraw = int_blockId;\r\n        }\r\n        canvasRef_viewOnline_ctx.drawImage(\r\n          img_textures,\r\n          32 * int_blockId_toDraw,\r\n          32 * int_colourSetId_toDraw,\r\n          32,\r\n          32,\r\n          33 * block_coords[0],\r\n          33 * block_coords[2],\r\n          32,\r\n          32\r\n        );\r\n        if (block_coords[2] !== 0) {\r\n          if (block_coords[1] > currentY) {\r\n            canvasRef_viewOnline_ctx.fillStyle = \"rgba(0, 0, 32, 0.2)\";\r\n            for (let i = 0; i < 4; i++) {\r\n              canvasRef_viewOnline_ctx.fillRect(33 * block_coords[0], 33 * block_coords[2], 33, -2 * (i + 1));\r\n            }\r\n          } else if (block_coords[1] < currentY) {\r\n            canvasRef_viewOnline_ctx.fillStyle = \"rgba(0, 0, 32, 0.2)\";\r\n            for (let i = 0; i < 4; i++) {\r\n              canvasRef_viewOnline_ctx.fillRect(33 * block_coords[0], 33 * block_coords[2], 33, 2 * (i + 1));\r\n            }\r\n          }\r\n        }\r\n        currentY = block_coords[1];\r\n        canvasRef_viewOnline_ctx.strokeStyle = \"rgba(0, 0, 0, 1)\";\r\n        canvasRef_viewOnline_ctx.fillStyle = \"rgba(255, 255, 255, 1)\";\r\n        if (\r\n          [\r\n            MapModes.SCHEMATIC_NBT.staircaseModes.CLASSIC.uniqueId,\r\n            MapModes.SCHEMATIC_NBT.staircaseModes.VALLEY.uniqueId,\r\n            MapModes.MAPDAT.staircaseModes.ON.uniqueId,\r\n            MapModes.MAPDAT.staircaseModes.ON_UNOBTAINABLE.uniqueId,\r\n          ].includes(optionValue_staircasing)\r\n        ) {\r\n          canvasRef_viewOnline_ctx.strokeText(block_coords[1], 33 * block_coords[0] + 31, 33 * (block_coords[2] + 1) - 2, 31);\r\n          canvasRef_viewOnline_ctx.fillText(block_coords[1], 33 * block_coords[0] + 31, 33 * (block_coords[2] + 1) - 2, 31);\r\n        }\r\n      }\r\n      for (let whichChunk_x = 0; whichChunk_x < 8 * optionValue_mapSize_x; whichChunk_x++) {\r\n        for (let whichChunk_y = -1; whichChunk_y < 8 * optionValue_mapSize_y; whichChunk_y++) {\r\n          canvasRef_viewOnline_ctx.fillStyle = \"rgba(255, 0, 0, 1)\";\r\n          for (let x = 0; x < 16; x++) {\r\n            for (let y = 0; y < 16; y++) {\r\n              canvasRef_viewOnline_ctx.fillRect(33 * (16 * whichChunk_x + x) + 32, 33 * (16 * whichChunk_y + y + 1), 1, 33);\r\n              canvasRef_viewOnline_ctx.fillRect(33 * (16 * whichChunk_x + x), 33 * (16 * whichChunk_y + y + 1) + 32, 33, 1);\r\n            }\r\n          }\r\n          canvasRef_viewOnline_ctx.fillStyle = \"rgba(0, 0, 255, 1)\";\r\n          canvasRef_viewOnline_ctx.fillRect(33 * 16 * (whichChunk_x + 1) - 1, 33 * (16 * whichChunk_y + 1), 1, 33 * 16);\r\n          canvasRef_viewOnline_ctx.fillRect(33 * 16 * whichChunk_x, 33 * (16 * (whichChunk_y + 1) + 1) - 1, 33 * 16, 1);\r\n        }\r\n      }\r\n    };\r\n    img_textures.src = IMG_Textures;\r\n  }\r\n\r\n  handleScroll_document = function (e) {\r\n    e.preventDefault();\r\n  };\r\n\r\n  handleScroll_canvas = function (e) {\r\n    e.preventDefault();\r\n    const zoomMultiplier = 1.1;\r\n    const { offsetX, offsetY } = e;\r\n    const delta = e.wheelDelta ? e.wheelDelta : e.detail ? -e.detail : 0;\r\n    if (delta) {\r\n      this.setState((state) => {\r\n        return {\r\n          zoomFactor: delta > 0 ? state.zoomFactor * zoomMultiplier : state.zoomFactor / zoomMultiplier,\r\n          canvasOffset_x:\r\n            delta > 0 ? state.canvasOffset_x - (zoomMultiplier - 1) * offsetX : state.canvasOffset_x - ((1 - zoomMultiplier) * offsetX) / zoomMultiplier,\r\n          canvasOffset_y:\r\n            delta > 0 ? state.canvasOffset_y - (zoomMultiplier - 1) * offsetY : state.canvasOffset_y - ((1 - zoomMultiplier) * offsetY) / zoomMultiplier,\r\n        };\r\n      });\r\n    }\r\n  }.bind(this);\r\n\r\n  handleMouseDown = function (e) {\r\n    e.preventDefault();\r\n    this.mouse.x = parseInt(e.clientX);\r\n    this.mouse.y = parseInt(e.clientY);\r\n    this.mouse.down = true;\r\n    this.mouse.movedSinceDown = false;\r\n    document.addEventListener(\"mousemove\", this.handleMouseMove, { passive: false });\r\n  }.bind(this);\r\n\r\n  handleMouseUp = function (e) {\r\n    e.preventDefault();\r\n    this.mouse.down = false;\r\n    if (!this.mouse.movedSinceDown) {\r\n      if (e.target === this.canvasRef_viewOnline.current) {\r\n        const { optionValue_mapSize_x, optionValue_mapSize_y } = this.props;\r\n        const { viewOnline_NBT_decompressed } = this.state;\r\n        const { offsetX, offsetY } = e;\r\n        const canvas_width = e.target.clientWidth;\r\n        const canvas_height = e.target.clientHeight;\r\n        const block_x = Math.floor((offsetX * 128 * optionValue_mapSize_x) / canvas_width);\r\n        const block_z = Math.floor((offsetY * (128 * optionValue_mapSize_y + 1)) / canvas_height);\r\n        for (const block of viewOnline_NBT_decompressed.value.blocks.value.value) {\r\n          const block_coords = block.pos.value.value;\r\n          if (block_coords[0] === block_x && block_coords[2] === block_z) {\r\n            const block_paletteId = block.state.value;\r\n            const [selectedBlock_colourSetId, selectedBlock_blockId] = this.paletteIdToColourSetIdAndBlockId[block_paletteId];\r\n            this.setState({\r\n              selectedBlock: {\r\n                x: block_coords[0],\r\n                y: block_coords[1],\r\n                z: block_coords[2],\r\n                colourSetId: selectedBlock_colourSetId,\r\n                blockId: selectedBlock_blockId,\r\n              },\r\n            });\r\n            break;\r\n          }\r\n        }\r\n      }\r\n    }\r\n    document.removeEventListener(\"mousemove\", this.handleMouseMove, { passive: false });\r\n  }.bind(this);\r\n\r\n  handleMouseMove = function (e) {\r\n    e.preventDefault();\r\n    if (!this.mouse.down) {\r\n      return;\r\n    }\r\n    const mouseMoved_x = parseInt(e.clientX - this.mouse.x);\r\n    const mouseMoved_y = parseInt(e.clientY - this.mouse.y);\r\n\r\n    if (Math.abs(mouseMoved_x) > 1 || Math.abs(mouseMoved_y) > 1) {\r\n      this.mouse.x = e.clientX;\r\n      this.mouse.y = e.clientY;\r\n      this.mouse.movedSinceDown = true;\r\n    }\r\n\r\n    this.setState((state) => {\r\n      return { canvasOffset_x: state.canvasOffset_x + mouseMoved_x, canvasOffset_y: state.canvasOffset_y + mouseMoved_y };\r\n    });\r\n  }.bind(this);\r\n\r\n  constructor(props) {\r\n    super(props);\r\n    this.canvasRef_viewOnline = createRef();\r\n  }\r\n\r\n  componentDidMount() {\r\n    const viewOnline_NBT_decompressed = this.getNBTDecompressed();\r\n\r\n    this.setState({ viewOnline_NBT_decompressed }, () => {\r\n      this.drawNBT();\r\n      document.addEventListener(\"DOMMouseScroll\", this.handleScroll_canvas, { passive: false });\r\n      this.canvasRef_viewOnline.current.addEventListener(\"mousewheel\", this.handleScroll_canvas, { passive: false });\r\n      document.addEventListener(\"mousewheel\", this.handleScroll_document, { passive: false });\r\n      document.addEventListener(\"mousedown\", this.handleMouseDown, { passive: false });\r\n      document.addEventListener(\"mouseup\", this.handleMouseUp, { passive: false });\r\n    });\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    document.removeEventListener(\"DOMMouseScroll\", this.handleScroll_canvas, { passive: false });\r\n    this.canvasRef_viewOnline.current.removeEventListener(\"mousewheel\", this.handleScroll_canvas, { passive: false });\r\n    document.removeEventListener(\"mousewheel\", this.handleScroll_document, { passive: false });\r\n    document.removeEventListener(\"mousedown\", this.handleMouseDown, { passive: false });\r\n    document.removeEventListener(\"mouseup\", this.handleMouseUp, { passive: false });\r\n  }\r\n\r\n  render() {\r\n    const { getLocaleString, coloursJSON, optionValue_mapSize_x, optionValue_mapSize_y, onGetViewOnlineNBT, onChooseViewOnline3D } = this.props;\r\n    const { viewOnline_NBT_decompressed, selectedBlock, zoomFactor } = this.state;\r\n    const { canvasOffset_x, canvasOffset_y } = this.state;\r\n\r\n    const component_controls = (\r\n      <div style={{ display: \"flex\", flexDirection: \"row\" }}>\r\n        <h1 style={{ cursor: \"pointer\" }} onClick={() => onGetViewOnlineNBT(null)}>\r\n          ❌\r\n        </h1>\r\n        <h1 style={{ cursor: \"pointer\" }} onClick={onChooseViewOnline3D}>\r\n          3D\r\n        </h1>\r\n      </div>\r\n    );\r\n\r\n    let component_waila = null;\r\n    if (selectedBlock !== null) {\r\n      component_waila = <Waila coloursJSON={coloursJSON} getLocaleString={getLocaleString} selectedBlock={selectedBlock} />;\r\n    }\r\n\r\n    let component_size = null;\r\n    if (viewOnline_NBT_decompressed !== null) {\r\n      const [size_x, size_y, size_z] = viewOnline_NBT_decompressed.value.size.value.value;\r\n      component_size = (\r\n        <h2 style={{ marginRight: \"0.1em\" }}>\r\n          {getLocaleString(\"VIEW-ONLINE/SIZE\")}\r\n          {\": \"}\r\n          {size_x.toString()}\r\n          {\"x\"}\r\n          {size_y > 256 ? (\r\n            <Tooltip\r\n              tooltipText={getLocaleString(\"VIEW-ONLINE/TOO-BIG-FOR-SINGLE\")}\r\n              textStyleOverrides={{\r\n                right: 0,\r\n                backgroundColor: \"orange\",\r\n              }}\r\n            >\r\n              <b style={{ color: \"orange\" }}>{size_y.toString()}</b>\r\n            </Tooltip>\r\n          ) : (\r\n            size_y.toString()\r\n          )}\r\n          {\"x\"}\r\n          {size_z.toString()}\r\n        </h2>\r\n      );\r\n    }\r\n\r\n    const component_topBar = (\r\n      <div className=\"topBar\">\r\n        {component_controls}\r\n        {component_waila}\r\n        {component_size}\r\n      </div>\r\n    );\r\n\r\n    return (\r\n      <div className={\"viewOnline2DContainer\"}>\r\n        {component_topBar}\r\n        <canvas\r\n          width={33 * 128 * optionValue_mapSize_x}\r\n          height={33 * (128 * optionValue_mapSize_y + 1)}\r\n          ref={this.canvasRef_viewOnline}\r\n          style={{\r\n            width: `${33 * 128 * optionValue_mapSize_x * zoomFactor}px`,\r\n            height: `${33 * (128 * optionValue_mapSize_y + 1) * zoomFactor}px`,\r\n            position: \"relative\",\r\n            left: canvasOffset_x,\r\n            top: canvasOffset_y,\r\n          }}\r\n        />\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default ViewOnline2D;\r\n","import { Euler, EventDispatcher, Vector3 } from \"three\";\r\n\r\nconst _euler = new Euler(0, 0, 0, \"YXZ\");\r\nconst _vector = new Vector3();\r\nconst _vector_up = new Vector3(0, 1, 0);\r\n\r\nconst _changeEvent = { type: \"change\" };\r\nconst _lockEvent = { type: \"lock\" };\r\nconst _unlockEvent = { type: \"unlock\" };\r\n\r\nconst _PI_2 = Math.PI / 2;\r\n\r\nclass PointerLockControls extends EventDispatcher {\r\n  constructor(camera, domElement) {\r\n    super();\r\n\r\n    if (domElement === undefined) {\r\n      console.warn('THREE.PointerLockControls: The second parameter \"domElement\" is now mandatory.');\r\n      domElement = document.body;\r\n    }\r\n\r\n    this.domElement = domElement;\r\n    this.isLocked = false;\r\n\r\n    // Set to constrain the pitch of the camera\r\n    // Range is 0 to Math.PI radians\r\n    this.minPolarAngle = 0; // radians\r\n    this.maxPolarAngle = Math.PI; // radians\r\n\r\n    const scope = this;\r\n\r\n    function onMouseMove(event) {\r\n      if (scope.isLocked === false) return;\r\n\r\n      const movementX = event.movementX || event.mozMovementX || event.webkitMovementX || 0;\r\n      const movementY = event.movementY || event.mozMovementY || event.webkitMovementY || 0;\r\n\r\n      _euler.setFromQuaternion(camera.quaternion);\r\n\r\n      _euler.y -= movementX * 0.002;\r\n      _euler.x -= movementY * 0.002;\r\n\r\n      _euler.x = Math.max(_PI_2 - scope.maxPolarAngle, Math.min(_PI_2 - scope.minPolarAngle, _euler.x));\r\n\r\n      camera.quaternion.setFromEuler(_euler);\r\n\r\n      scope.dispatchEvent(_changeEvent);\r\n    }\r\n\r\n    function onPointerlockChange() {\r\n      if (scope.domElement.ownerDocument.pointerLockElement === scope.domElement) {\r\n        scope.dispatchEvent(_lockEvent);\r\n\r\n        scope.isLocked = true;\r\n      } else {\r\n        scope.dispatchEvent(_unlockEvent);\r\n\r\n        scope.isLocked = false;\r\n      }\r\n    }\r\n\r\n    function onPointerlockError() {\r\n      console.error(\"THREE.PointerLockControls: Unable to use Pointer Lock API\");\r\n    }\r\n\r\n    this.connect = function () {\r\n      scope.domElement.ownerDocument.addEventListener(\"mousemove\", onMouseMove);\r\n      scope.domElement.ownerDocument.addEventListener(\"pointerlockchange\", onPointerlockChange);\r\n      scope.domElement.ownerDocument.addEventListener(\"pointerlockerror\", onPointerlockError);\r\n    };\r\n\r\n    this.disconnect = function () {\r\n      scope.domElement.ownerDocument.removeEventListener(\"mousemove\", onMouseMove);\r\n      scope.domElement.ownerDocument.removeEventListener(\"pointerlockchange\", onPointerlockChange);\r\n      scope.domElement.ownerDocument.removeEventListener(\"pointerlockerror\", onPointerlockError);\r\n    };\r\n\r\n    this.dispose = function () {\r\n      this.disconnect();\r\n    };\r\n\r\n    this.getObject = function () {\r\n      // retaining this method for backward compatibility\r\n\r\n      return camera;\r\n    };\r\n\r\n    this.getDirection = (function () {\r\n      const direction = new Vector3(0, 0, -1);\r\n\r\n      return function (v) {\r\n        return v.copy(direction).applyQuaternion(camera.quaternion);\r\n      };\r\n    })();\r\n\r\n    this.moveForward = function (distance) {\r\n      // move forward parallel to the xz-plane\r\n      // assumes camera.up is y-up\r\n\r\n      _vector.setFromMatrixColumn(camera.matrix, 0);\r\n\r\n      _vector.crossVectors(camera.up, _vector);\r\n\r\n      camera.position.addScaledVector(_vector, distance);\r\n    };\r\n\r\n    this.moveRight = function (distance) {\r\n      _vector.setFromMatrixColumn(camera.matrix, 0);\r\n\r\n      camera.position.addScaledVector(_vector, distance);\r\n    };\r\n\r\n    this.moveUp = function (distance) {\r\n      camera.position.addScaledVector(_vector_up, distance);\r\n    };\r\n\r\n    this.lock = function () {\r\n      this.domElement.requestPointerLock();\r\n    };\r\n\r\n    this.unlock = function () {\r\n      scope.domElement.ownerDocument.exitPointerLock();\r\n    };\r\n\r\n    this.connect();\r\n  }\r\n}\r\n\r\nexport { PointerLockControls };\r\n","import React, { Component, createRef } from \"react\";\r\n\r\nimport Tooltip from \"../../tooltip\";\r\n\r\nimport IMG_Textures from \"../../../images/textures.png\";\r\n\r\nimport NBTReader from \"../nbtReader\";\r\nimport Waila from \"../viewOnlineCommon/waila\";\r\n\r\nimport * as THREE from \"three\";\r\nimport { PointerLockControls } from \"./pointerLockControls\";\r\n\r\nimport \"./viewOnline3D.css\";\r\n\r\nclass BlockWorld {\r\n  faces = [\r\n    {\r\n      // left\r\n      uvRow: 0,\r\n      dir: [-1, 0, 0],\r\n      vertices: [\r\n        { pos: [0, 1, 0], uv: [0, 1] },\r\n        { pos: [0, 0, 0], uv: [0, 0] },\r\n        { pos: [0, 1, 1], uv: [1, 1] },\r\n        { pos: [0, 0, 1], uv: [1, 0] },\r\n      ],\r\n    },\r\n    {\r\n      // right\r\n      uvRow: 0,\r\n      dir: [1, 0, 0],\r\n      vertices: [\r\n        { pos: [1, 1, 1], uv: [0, 1] },\r\n        { pos: [1, 0, 1], uv: [0, 0] },\r\n        { pos: [1, 1, 0], uv: [1, 1] },\r\n        { pos: [1, 0, 0], uv: [1, 0] },\r\n      ],\r\n    },\r\n    {\r\n      // bottom\r\n      uvRow: 0,\r\n      dir: [0, -1, 0],\r\n      vertices: [\r\n        { pos: [1, 0, 1], uv: [1, 0] },\r\n        { pos: [0, 0, 1], uv: [0, 0] },\r\n        { pos: [1, 0, 0], uv: [1, 1] },\r\n        { pos: [0, 0, 0], uv: [0, 1] },\r\n      ],\r\n    },\r\n    {\r\n      // top\r\n      uvRow: 0,\r\n      dir: [0, 1, 0],\r\n      vertices: [\r\n        { pos: [0, 1, 1], uv: [1, 1] },\r\n        { pos: [1, 1, 1], uv: [0, 1] },\r\n        { pos: [0, 1, 0], uv: [1, 0] },\r\n        { pos: [1, 1, 0], uv: [0, 0] },\r\n      ],\r\n    },\r\n    {\r\n      // north\r\n      uvRow: 0,\r\n      dir: [0, 0, -1],\r\n      vertices: [\r\n        { pos: [1, 0, 0], uv: [0, 0] },\r\n        { pos: [0, 0, 0], uv: [1, 0] },\r\n        { pos: [1, 1, 0], uv: [0, 1] },\r\n        { pos: [0, 1, 0], uv: [1, 1] },\r\n      ],\r\n    },\r\n    {\r\n      // south\r\n      uvRow: 0,\r\n      dir: [0, 0, 1],\r\n      vertices: [\r\n        { pos: [0, 0, 1], uv: [0, 0] },\r\n        { pos: [1, 0, 1], uv: [1, 0] },\r\n        { pos: [0, 1, 1], uv: [0, 1] },\r\n        { pos: [1, 1, 1], uv: [1, 1] },\r\n      ],\r\n    },\r\n  ];\r\n\r\n  chunkSize = 16;\r\n  chunks = {};\r\n  chunks_mesh = {};\r\n  renderRequested = false;\r\n  animationFrameRequestID = null;\r\n\r\n  // for click mouse events\r\n  mouse = {\r\n    x: 0,\r\n    y: 0,\r\n    moveX: 0,\r\n    moveY: 0,\r\n  };\r\n\r\n  constructor(options) {\r\n    this.canvasRef = options.canvasRef;\r\n    this.coloursJSON = options.coloursJSON;\r\n    this.tileSize = options.tileSize;\r\n    this.tileTextureWidth = options.tileTextureWidth;\r\n    this.tileTextureHeight = options.tileTextureHeight;\r\n    const { camera_x, camera_y, camera_z } = options;\r\n    this.onSelectBlockCallback = options.onSelectBlockCallback;\r\n    // each chunk is a Uint8Array; each block is stored as colourSetId, blockId\r\n    // chunks represent a chunkSize^3 volume\r\n\r\n    this.renderer = new THREE.WebGLRenderer({ canvas: this.canvasRef.current });\r\n    this.renderer.setSize(this.canvasRef.current.clientWidth, this.canvasRef.current.clientHeight, false);\r\n\r\n    this.scene = new THREE.Scene();\r\n    this.scene.background = new THREE.Color(\"lightblue\");\r\n    this.scene.add(new THREE.AmbientLight(0xdddddd));\r\n\r\n    const fov = 75;\r\n    const aspect = 2;\r\n    const near = 0.1;\r\n    const far = 250;\r\n    this.camera = new THREE.PerspectiveCamera(fov, aspect, near, far);\r\n    this.camera.position.set(camera_x, camera_y, camera_z);\r\n\r\n    this.controls = new PointerLockControls(this.camera, this.canvasRef.current);\r\n\r\n    const texture = new THREE.TextureLoader().load(IMG_Textures, this.render);\r\n    texture.magFilter = THREE.NearestFilter;\r\n    texture.minFilter = THREE.NearestFilter;\r\n\r\n    this.material = new THREE.MeshLambertMaterial({\r\n      map: texture,\r\n      side: THREE.FrontSide,\r\n      alphaTest: 0,\r\n      transparent: false,\r\n    });\r\n  }\r\n\r\n  startAnimationLoop = () => {\r\n    this.renderer.render(this.scene, this.camera);\r\n    this.animationFrameRequestID = window.requestAnimationFrame(this.startAnimationLoop);\r\n  };\r\n\r\n  stopAnimationLoop = () => {\r\n    window.cancelAnimationFrame(this.animationFrameRequestID);\r\n  };\r\n\r\n  addEventListeners() {\r\n    window.addEventListener(\"resize\", this.handleWindowResize);\r\n    this.canvasRef.current.addEventListener(\"pointerdown\", this.handlePointerDown, { passive: false });\r\n    this.canvasRef.current.addEventListener(\"touchstart\", this.handleTouchStart, { passive: false });\r\n    document.addEventListener(\"keydown\", this.handleKeyDown, { passive: false });\r\n    document.addEventListener(\"keyup\", this.handleKeyUp, { passive: false });\r\n    this.controls.connect();\r\n  }\r\n\r\n  handleKeyDown = function (e) {\r\n    e.preventDefault();\r\n    switch (e.key) {\r\n      case \"w\":\r\n        this.controls.moveForward(1);\r\n        break;\r\n      case \"a\":\r\n        this.controls.moveRight(-1);\r\n        break;\r\n      case \"s\":\r\n        this.controls.moveForward(-1);\r\n        break;\r\n      case \"d\":\r\n        this.controls.moveRight(1);\r\n        break;\r\n      case \"e\":\r\n        this.controls.moveUp(-1);\r\n        break;\r\n      case \" \":\r\n        this.controls.moveUp(1);\r\n        break;\r\n      case \"c\":\r\n        this.camera.fov = 25;\r\n        this.camera.updateProjectionMatrix();\r\n        break;\r\n      default:\r\n        break;\r\n    }\r\n  }.bind(this);\r\n\r\n  handleKeyUp = function (e) {\r\n    e.preventDefault();\r\n    switch (e.key) {\r\n      case \"c\":\r\n        this.camera.fov = 75;\r\n        this.camera.updateProjectionMatrix();\r\n        break;\r\n      default:\r\n        break;\r\n    }\r\n  }.bind(this);\r\n\r\n  handlePointerDown = function (e) {\r\n    e.preventDefault();\r\n    this.mouse.x = e.clientX;\r\n    this.mouse.y = e.clientY;\r\n    this.mouse.moveX = 0;\r\n    this.mouse.moveY = 0;\r\n    this.canvasRef.current.addEventListener(\"pointermove\", this.recordMovement);\r\n    this.canvasRef.current.addEventListener(\"pointerup\", this.selectBlockIfNoMovement);\r\n    this.controls.lock();\r\n  }.bind(this);\r\n\r\n  recordMovement = function (e) {\r\n    this.mouse.moveX += Math.abs(this.mouse.x - e.clientX);\r\n    this.mouse.moveY += Math.abs(this.mouse.y - e.clientY);\r\n  }.bind(this);\r\n\r\n  selectBlockIfNoMovement = function (e) {\r\n    if (this.mouse.moveX < 5 && this.mouse.moveY < 5) {\r\n      this.selectBlock(e);\r\n    }\r\n    this.canvasRef.current.removeEventListener(\"pointermove\", this.recordMovement);\r\n    this.canvasRef.current.removeEventListener(\"pointerup\", this.selectBlockIfNoMovement);\r\n  }.bind(this);\r\n\r\n  handleTouchStart = function (e) {\r\n    // TODO test this on mobile\r\n    e.preventDefault(); // prevent scrolling\r\n  };\r\n\r\n  handleWindowResize = function () {\r\n    const width = this.canvasRef.current.clientWidth;\r\n    const height = this.canvasRef.current.clientHeight;\r\n\r\n    this.renderer.setSize(width, height, false);\r\n    this.camera.aspect = width / height;\r\n    this.camera.updateProjectionMatrix();\r\n  }.bind(this);\r\n\r\n  removeEventListeners() {\r\n    window.removeEventListener(\"resize\", this.handleWindowResize);\r\n    this.canvasRef.current.removeEventListener(\"pointerdown\", this.handlePointerDown, { passive: false });\r\n    this.canvasRef.current.removeEventListener(\"touchstart\", this.handleTouchStart, { passive: false });\r\n    document.removeEventListener(\"keydown\", this.handleKeyDown, { passive: false });\r\n    document.removeEventListener(\"keyup\", this.handleKeyUp, { passive: false });\r\n    this.controls.unlock();\r\n    this.controls.disconnect();\r\n  }\r\n\r\n  computeBlockOffset(x, y, z) {\r\n    const { chunkSize } = this;\r\n    const blockX = THREE.MathUtils.euclideanModulo(x, chunkSize) | 0;\r\n    const blockY = THREE.MathUtils.euclideanModulo(y, chunkSize) | 0;\r\n    const blockZ = THREE.MathUtils.euclideanModulo(z, chunkSize) | 0;\r\n    return 2 * (blockY * chunkSize * chunkSize + blockZ * chunkSize + blockX);\r\n  }\r\n\r\n  getChunkKey(x, y, z) {\r\n    const { chunkSize } = this;\r\n    const chunkX = Math.floor(x / chunkSize);\r\n    const chunkY = Math.floor(y / chunkSize);\r\n    const chunkZ = Math.floor(z / chunkSize);\r\n    return `${chunkX},${chunkY},${chunkZ}`;\r\n  }\r\n\r\n  getChunkForBlock(x, y, z) {\r\n    return this.chunks[this.getChunkKey(x, y, z)];\r\n  }\r\n\r\n  addChunkForBlock(x, y, z) {\r\n    const chunkKey = this.getChunkKey(x, y, z);\r\n    let chunk = this.chunks[chunkKey];\r\n    if (!chunk) {\r\n      const { chunkSize } = this;\r\n      chunk = new Uint8Array(2 * chunkSize * chunkSize * chunkSize);\r\n      for (let i = 0; i < chunk.length; i++) {\r\n        chunk[i] = 255;\r\n      }\r\n      this.chunks[chunkKey] = chunk;\r\n    }\r\n    return chunk;\r\n  }\r\n\r\n  getBlock(x, y, z) {\r\n    const chunk = this.getChunkForBlock(x, y, z);\r\n    if (!chunk) {\r\n      return null;\r\n    }\r\n    const blockOffset = this.computeBlockOffset(x, y, z);\r\n    return chunk.slice(blockOffset, blockOffset + 2);\r\n  }\r\n\r\n  setBlock(x, y, z, colourSetId, blockId) {\r\n    let chunk = this.getChunkForBlock(x, y, z);\r\n    if (!chunk) {\r\n      chunk = this.addChunkForBlock(x, y, z);\r\n    }\r\n    const blockOffset = this.computeBlockOffset(x, y, z);\r\n    chunk[blockOffset] = colourSetId;\r\n    chunk[blockOffset + 1] = blockId;\r\n  }\r\n\r\n  selectBlock() {\r\n    const canvas = this.canvasRef.current;\r\n    // const rect = canvas.getBoundingClientRect();\r\n    const pos = {\r\n      // x: ((e.clientX - rect.left) * canvas.width) / rect.width,\r\n      // y: ((e.clientY - rect.top) * canvas.height) / rect.height,\r\n      // x: ((rect.right + rect.left) * canvas.width) / (2 * rect.width),\r\n      // y: ((rect.bottom + rect.top) * canvas.height) / (2 * rect.height),\r\n      x: canvas.width / 2,\r\n      y: canvas.height / 2,\r\n    };\r\n    const x = (pos.x / canvas.width) * 2 - 1;\r\n    const y = (pos.y / canvas.height) * -2 + 1; // note we flip Y\r\n\r\n    const start = new THREE.Vector3();\r\n    const end = new THREE.Vector3();\r\n    start.setFromMatrixPosition(this.camera.matrixWorld);\r\n    end.set(x, y, 1).unproject(this.camera);\r\n\r\n    const intersection = this.intersectRay(start, end);\r\n    if (intersection) {\r\n      // the intersection point is on the face. That means\r\n      // the math imprecision could put us on either side of the face.\r\n      // so go half a normal into the block if removing (currentBlock = 0)\r\n      // our out of the block if adding (currentBlock  > 0)\r\n      // const pos = intersection.position.map((v, numberOfVertices) => {\r\n      //   return v + intersection.normal[numberOfVertices] * -0.5;\r\n      // });\r\n      this.onSelectBlockCallback({\r\n        x: intersection.block_coords.x,\r\n        y: intersection.block_coords.y,\r\n        z: intersection.block_coords.z,\r\n        colourSetId: intersection.block[0],\r\n        blockId: intersection.block[1],\r\n      });\r\n    }\r\n  }\r\n\r\n  intersectRay(start, end) {\r\n    // from\r\n    // http://www.cse.chalmers.se/edu/year/2010/course/TDA361/grid.pdf\r\n    let dx = end.x - start.x;\r\n    let dy = end.y - start.y;\r\n    let dz = end.z - start.z;\r\n    const lenSq = dx * dx + dy * dy + dz * dz;\r\n    const len = Math.sqrt(lenSq);\r\n\r\n    dx /= len;\r\n    dy /= len;\r\n    dz /= len;\r\n\r\n    let t = 0.0;\r\n    let ix = Math.floor(start.x);\r\n    let iy = Math.floor(start.y);\r\n    let iz = Math.floor(start.z);\r\n\r\n    const stepX = dx > 0 ? 1 : -1;\r\n    const stepY = dy > 0 ? 1 : -1;\r\n    const stepZ = dz > 0 ? 1 : -1;\r\n\r\n    const txDelta = Math.abs(1 / dx);\r\n    const tyDelta = Math.abs(1 / dy);\r\n    const tzDelta = Math.abs(1 / dz);\r\n\r\n    const xDist = stepX > 0 ? ix + 1 - start.x : start.x - ix;\r\n    const yDist = stepY > 0 ? iy + 1 - start.y : start.y - iy;\r\n    const zDist = stepZ > 0 ? iz + 1 - start.z : start.z - iz;\r\n\r\n    // location of nearest block boundary, in units of t\r\n    let txMax = txDelta < Infinity ? txDelta * xDist : Infinity;\r\n    let tyMax = tyDelta < Infinity ? tyDelta * yDist : Infinity;\r\n    let tzMax = tzDelta < Infinity ? tzDelta * zDist : Infinity;\r\n\r\n    let steppedIndex = -1;\r\n\r\n    // main loop along raycast vector\r\n    while (t <= len) {\r\n      const block = this.getBlock(ix, iy, iz);\r\n      if (block !== null && !(block[0] === 255 && block[1] === 255)) {\r\n        return {\r\n          position: [start.x + t * dx, start.y + t * dy, start.z + t * dz],\r\n          normal: [steppedIndex === 0 ? -stepX : 0, steppedIndex === 1 ? -stepY : 0, steppedIndex === 2 ? -stepZ : 0],\r\n          block: block,\r\n          block_coords: { x: ix, y: iy, z: iz },\r\n        };\r\n      }\r\n\r\n      // advance t to next nearest block boundary\r\n      if (txMax < tyMax) {\r\n        if (txMax < tzMax) {\r\n          ix += stepX;\r\n          t = txMax;\r\n          txMax += txDelta;\r\n          steppedIndex = 0;\r\n        } else {\r\n          iz += stepZ;\r\n          t = tzMax;\r\n          tzMax += tzDelta;\r\n          steppedIndex = 2;\r\n        }\r\n      } else {\r\n        if (tyMax < tzMax) {\r\n          iy += stepY;\r\n          t = tyMax;\r\n          tyMax += tyDelta;\r\n          steppedIndex = 1;\r\n        } else {\r\n          iz += stepZ;\r\n          t = tzMax;\r\n          tzMax += tzDelta;\r\n          steppedIndex = 2;\r\n        }\r\n      }\r\n    }\r\n    return null;\r\n  }\r\n\r\n  generateGeometryDataForChunk(chunkX, chunkY, chunkZ) {\r\n    const { coloursJSON, chunkSize, tileSize, tileTextureWidth, tileTextureHeight } = this;\r\n    const verticesComponents = [];\r\n    const normalsComponents = [];\r\n    const uvs = [];\r\n    const indices = [];\r\n    const startX = chunkX * chunkSize;\r\n    const startY = chunkY * chunkSize;\r\n    const startZ = chunkZ * chunkSize;\r\n\r\n    const chunk = this.getChunkForBlock(startX, startY, startZ);\r\n    if (chunk) {\r\n      for (let y = 0; y < chunkSize; y++) {\r\n        const blockY = startY + y;\r\n        for (let z = 0; z < chunkSize; z++) {\r\n          const blockZ = startZ + z;\r\n          for (let x = 0; x < chunkSize; x++) {\r\n            const blockX = startX + x;\r\n            const blockOffset = this.computeBlockOffset(x, y, z);\r\n            const block = chunk.slice(blockOffset, blockOffset + 2);\r\n            let [colourSetId, blockId] = block;\r\n            if (!(colourSetId === 255 && blockId === 255)) {\r\n              if (!(colourSetId === 64 && blockId === 2)) {\r\n                // if not placeholder texture then check if custom texture needed\r\n                if (coloursJSON[colourSetId.toString()].blocks[blockId.toString()].presetIndex === \"CUSTOM\") {\r\n                  colourSetId = 64;\r\n                  blockId = 5;\r\n                }\r\n              }\r\n              // There is a block here but do we need faces for it?\r\n              for (const { dir, vertices, uvRow } of this.faces) {\r\n                const neighbor = this.getBlock(blockX + dir[0], blockY + dir[1], blockZ + dir[2]);\r\n                if (neighbor === null || (neighbor[0] === 255 && neighbor[1] === 255)) {\r\n                  // this block has no neighbor in this direction so we need a face\r\n                  const numberOfVertices = verticesComponents.length / 3;\r\n                  for (const { pos, uv } of vertices) {\r\n                    verticesComponents.push(pos[0] + x, pos[1] + y, pos[2] + z);\r\n                    normalsComponents.push(...dir);\r\n                    uvs.push(((blockId + uv[0]) * tileSize) / tileTextureWidth, 1 - ((uvRow + (1 + colourSetId) - uv[1]) * tileSize) / tileTextureHeight);\r\n                  }\r\n                  indices.push(numberOfVertices, numberOfVertices + 1, numberOfVertices + 2, numberOfVertices + 2, numberOfVertices + 1, numberOfVertices + 3);\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n\r\n    return {\r\n      verticesComponents,\r\n      normalsComponents,\r\n      uvs,\r\n      indices,\r\n    };\r\n  }\r\n\r\n  updateChunkGeometry(x, y, z) {\r\n    const { chunkSize } = this;\r\n    const chunkX = Math.floor(x / chunkSize);\r\n    const chunkY = Math.floor(y / chunkSize);\r\n    const chunkZ = Math.floor(z / chunkSize);\r\n    const chunkKey = this.getChunkKey(x, y, z);\r\n    let mesh = this.chunks_mesh[chunkKey];\r\n    const geometry = mesh ? mesh.geometry : new THREE.BufferGeometry();\r\n\r\n    const { verticesComponents, normalsComponents, uvs, indices } = this.generateGeometryDataForChunk(chunkX, chunkY, chunkZ);\r\n    const positionNumComponents = 3;\r\n    geometry.setAttribute(\"position\", new THREE.BufferAttribute(new Float32Array(verticesComponents), positionNumComponents));\r\n    const normalNumComponents = 3;\r\n    geometry.setAttribute(\"normal\", new THREE.BufferAttribute(new Float32Array(normalsComponents), normalNumComponents));\r\n    const uvNumComponents = 2;\r\n    geometry.setAttribute(\"uv\", new THREE.BufferAttribute(new Float32Array(uvs), uvNumComponents));\r\n    geometry.setIndex(indices);\r\n    geometry.computeBoundingSphere();\r\n\r\n    if (!mesh) {\r\n      mesh = new THREE.Mesh(geometry, this.material);\r\n      mesh.name = chunkKey;\r\n      this.chunks_mesh[chunkKey] = mesh;\r\n      this.scene.add(mesh);\r\n      mesh.position.set(chunkX * chunkSize, chunkY * chunkSize, chunkZ * chunkSize);\r\n    }\r\n  }\r\n\r\n  updateBlockGeometry(x, y, z) {\r\n    const updatedChunkKeys = {};\r\n    for (const offset of [\r\n      [0, 0, 0], // self\r\n      [-1, 0, 0], // left\r\n      [1, 0, 0], // right\r\n      [0, -1, 0], // down\r\n      [0, 1, 0], // up\r\n      [0, 0, -1], // back\r\n      [0, 0, 1], // front\r\n    ]) {\r\n      const ox = x + offset[0];\r\n      const oy = y + offset[1];\r\n      const oz = z + offset[2];\r\n      const chunkKey = this.getChunkKey(ox, oy, oz);\r\n      if (!updatedChunkKeys[chunkKey]) {\r\n        updatedChunkKeys[chunkKey] = true;\r\n        this.updateChunkGeometry(ox, oy, oz);\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nclass ViewOnline3D extends Component {\r\n  state = {\r\n    viewOnline_NBT_decompressed: null,\r\n    selectedBlock: null,\r\n  };\r\n\r\n  constructor(props) {\r\n    super(props);\r\n    this.canvasRef_viewOnline = createRef();\r\n  }\r\n\r\n  getNBTDecompressed() {\r\n    const { viewOnline_NBT } = this.props;\r\n    let nbtReader = new NBTReader();\r\n    nbtReader.loadBuffer(viewOnline_NBT);\r\n    const viewOnline_NBT_decompressed = nbtReader.getData();\r\n    return viewOnline_NBT_decompressed;\r\n  }\r\n\r\n  drawNBT() {\r\n    const { coloursJSON, optionValue_version } = this.props;\r\n    const { viewOnline_NBT_decompressed } = this.state;\r\n    const [schematic_size_x, schematic_size_y, schematic_size_z] = viewOnline_NBT_decompressed.value.size.value.value;\r\n\r\n    this.world.chunks = {};\r\n    this.world.chunks_mesh = {};\r\n\r\n    let paletteIdToColourSetIdAndBlockId = [];\r\n    const NBT_palette = viewOnline_NBT_decompressed.value.palette.value.value;\r\n    for (let paletteItem_index = 0; paletteItem_index < NBT_palette.length; paletteItem_index++) {\r\n      const paletteItem = NBT_palette[paletteItem_index];\r\n      let paletteItemFound = false;\r\n      for (const [colourSetId, colourSet] of Object.entries(coloursJSON)) {\r\n        if (paletteItemFound) {\r\n          break;\r\n        }\r\n        for (const [blockId, block] of Object.entries(colourSet.blocks)) {\r\n          if (paletteItemFound) {\r\n            break;\r\n          }\r\n          if (!(optionValue_version.MCVersion in block.validVersions)) {\r\n            continue;\r\n          }\r\n          let blockNBTData = block.validVersions[optionValue_version.MCVersion];\r\n          if (typeof blockNBTData === \"string\") {\r\n            // this is of the form eg \"&1.12.2\"\r\n            blockNBTData = block.validVersions[blockNBTData.slice(1)];\r\n          }\r\n          if (\r\n            paletteItem.Name.value === `minecraft:${blockNBTData.NBTName}` &&\r\n            ((!(\"Properties\" in paletteItem) && Object.keys(blockNBTData.NBTArgs).length === 0) ||\r\n              (\"Properties\" in paletteItem &&\r\n                Object.keys(paletteItem.Properties.value).length === Object.keys(blockNBTData.NBTArgs).length &&\r\n                Object.entries(blockNBTData.NBTArgs).every(([argKey, argValue]) => {\r\n                  return argKey in paletteItem.Properties.value && argValue === paletteItem.Properties.value[argKey].value;\r\n                })))\r\n          ) {\r\n            paletteIdToColourSetIdAndBlockId.push([parseInt(colourSetId), parseInt(blockId)]);\r\n            paletteItemFound = true;\r\n          }\r\n        }\r\n      }\r\n      if (!paletteItemFound) {\r\n        console.log(`Didn't find ${paletteItem.Name.value} in coloursJSON; using placeholder texture`);\r\n        paletteIdToColourSetIdAndBlockId.push([64, 2]);\r\n      }\r\n    }\r\n\r\n    viewOnline_NBT_decompressed.value.blocks.value.value.forEach((block) => {\r\n      const block_coords = block.pos.value.value;\r\n      const block_paletteId = block.state.value;\r\n      this.world.setBlock(...block_coords, ...paletteIdToColourSetIdAndBlockId[block_paletteId]);\r\n    });\r\n    for (let x = 0; x < schematic_size_x; x += this.world.chunkSize) {\r\n      for (let y = 0; y < schematic_size_y; y += this.world.chunkSize) {\r\n        for (let z = 0; z < schematic_size_z; z += this.world.chunkSize) {\r\n          this.world.updateChunkGeometry(x, y, z);\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  handleEscapeKeyDown = function (e) {\r\n    const { handleViewOnline3DEscape } = this.props;\r\n    e.preventDefault();\r\n    if (e.key === \"Escape\") {\r\n      handleViewOnline3DEscape();\r\n    }\r\n  }.bind(this);\r\n\r\n  componentDidMount() {\r\n    const { coloursJSON } = this.props;\r\n    const canvasRef = this.canvasRef_viewOnline;\r\n    const viewOnline_NBT_decompressed = this.getNBTDecompressed();\r\n    const [, size_y, size_z] = viewOnline_NBT_decompressed.value.size.value.value;\r\n\r\n    this.world = new BlockWorld({\r\n      canvasRef: canvasRef,\r\n      coloursJSON: coloursJSON,\r\n      tileSize: 32,\r\n      tileTextureWidth: 608,\r\n      tileTextureHeight: 2080,\r\n      camera_x: 0,\r\n      camera_y: size_y + 1,\r\n      camera_z: size_z,\r\n      onSelectBlockCallback: (selectedBlock) => {\r\n        this.setState({ selectedBlock });\r\n      },\r\n    });\r\n\r\n    this.world.startAnimationLoop();\r\n\r\n    this.setState({ viewOnline_NBT_decompressed }, () => {\r\n      this.drawNBT();\r\n      document.addEventListener(\"keydown\", this.handleEscapeKeyDown);\r\n      this.world.addEventListeners();\r\n    });\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    this.world.stopAnimationLoop();\r\n    this.world.removeEventListeners();\r\n    document.removeEventListener(\"keydown\", this.handleEscapeKeyDown);\r\n  }\r\n\r\n  render() {\r\n    const { getLocaleString, coloursJSON } = this.props;\r\n    const { viewOnline_NBT_decompressed, selectedBlock } = this.state;\r\n    let component_size = null;\r\n    if (viewOnline_NBT_decompressed !== null) {\r\n      const [size_x, size_y, size_z] = viewOnline_NBT_decompressed.value.size.value.value;\r\n      component_size = (\r\n        <h2\r\n          style={{\r\n            position: \"fixed\",\r\n            zIndex: 121,\r\n            left: 0,\r\n            top: 0,\r\n          }}\r\n        >\r\n          {getLocaleString(\"VIEW-ONLINE/SIZE\")}\r\n          {\": \"}\r\n          {size_x.toString()}\r\n          {\"x\"}\r\n          {size_y > 256 ? (\r\n            <Tooltip\r\n              tooltipText={getLocaleString(\"VIEW-ONLINE/TOO-BIG-FOR-SINGLE\")}\r\n              textStyleOverrides={{\r\n                whiteSpace: \"nowrap\",\r\n                backgroundColor: \"orange\",\r\n              }}\r\n            >\r\n              <b style={{ color: \"orange\" }}>{size_y.toString()}</b>\r\n            </Tooltip>\r\n          ) : (\r\n            size_y.toString()\r\n          )}\r\n          {\"x\"}\r\n          {size_z.toString()}\r\n        </h2>\r\n      );\r\n    }\r\n    const component_controls = (\r\n      <div\r\n        style={{\r\n          position: \"fixed\",\r\n          zIndex: 121,\r\n          left: 0,\r\n          bottom: 0,\r\n        }}\r\n      >\r\n        <h3 style={{ margin: 0 }}>{`${getLocaleString(\"VIEW-ONLINE/CONTROLS\")}: W A S D E SPACE C`}</h3>\r\n        <h3 style={{ margin: 0 }}>{`ESC ESC ${getLocaleString(\"VIEW-ONLINE/TO-EXIT\")}`}</h3>\r\n      </div>\r\n    );\r\n    let component_waila = null;\r\n    if (selectedBlock !== null) {\r\n      component_waila = (\r\n        <Waila\r\n          getLocaleString={getLocaleString}\r\n          coloursJSON={coloursJSON}\r\n          selectedBlock={selectedBlock}\r\n          style={{\r\n            position: \"fixed\",\r\n            zIndex: 121,\r\n            right: 0,\r\n            top: 0,\r\n          }}\r\n        />\r\n      );\r\n    }\r\n\r\n    return (\r\n      <React.Fragment>\r\n        {component_size}\r\n        {component_controls}\r\n        {component_waila}\r\n        <b style={{ position: \"fixed\", zIndex: 121, top: \"50%\", left: \"50%\" }}>{\"\\\\\"}</b>\r\n        <canvas\r\n          ref={this.canvasRef_viewOnline}\r\n          style={{\r\n            position: \"fixed\",\r\n            zIndex: 120,\r\n            width: \"100%\",\r\n            height: \"100%\",\r\n            top: 0,\r\n            bottom: 0,\r\n            left: 0,\r\n            right: 0,\r\n          }}\r\n        />\r\n      </React.Fragment>\r\n    );\r\n  }\r\n}\r\n\r\nexport default ViewOnline3D;\r\n","import React, { Component } from \"react\";\r\n\r\nimport CookieManager from \"../../cookieManager\";\r\nimport BlockSelection from \"./blockSelection\";\r\nimport GreenButtons from \"./greenButtons\";\r\nimport MapPreview from \"./mapPreview\";\r\nimport MapSettings from \"./mapSettings\";\r\nimport Materials from \"./materials\";\r\nimport coloursJSON from \"./json/coloursJSON.json\";\r\nimport ViewOnline2D from \"./viewOnline2D/viewOnline2D\";\r\nimport ViewOnline3D from \"./viewOnline3D/viewOnline3D\";\r\n\r\nimport BackgroundColourModes from \"./json/backgroundColourModes.json\";\r\nimport CropModes from \"./json/cropModes.json\";\r\nimport DefaultPresets from \"./json/defaultPresets.json\";\r\nimport DitherMethods from \"./json/ditherMethods.json\";\r\nimport MapModes from \"./json/mapModes.json\";\r\nimport SupportedVersions from \"./json/supportedVersions.json\";\r\n\r\nimport IMG_Upload from \"../../images/upload.png\";\r\n\r\nimport \"./mapartController.css\";\r\n\r\nclass MapartController extends Component {\r\n  state = {\r\n    coloursJSON: null,\r\n    selectedBlocks: {},\r\n    optionValue_version: Object.values(SupportedVersions)[Object.keys(SupportedVersions).length - 1], // default to the latest version supported\r\n    optionValue_modeNBTOrMapdat: MapModes.SCHEMATIC_NBT.uniqueId,\r\n    optionValue_mapSize_x: 1,\r\n    optionValue_mapSize_y: 1,\r\n    optionValue_cropImage: CropModes.CENTER.uniqueId,\r\n    optionValue_cropImage_zoom: 10, // this gets scaled down by a factor of 10\r\n    optionValue_cropImage_percent_x: 50,\r\n    optionValue_cropImage_percent_y: 50,\r\n    optionValue_showGridOverlay: false,\r\n    optionValue_staircasing: MapModes.SCHEMATIC_NBT.staircaseModes.CLASSIC.uniqueId,\r\n    optionValue_supportBlock: \"light_gray_wool\",\r\n    optionValue_transparency: false,\r\n    optionValue_transparencyTolerance: 128,\r\n    optionValue_mapdatFilenameUseId: true,\r\n    optionValue_mapdatFilenameIdStart: 0,\r\n    optionValue_betterColour: true,\r\n    optionValue_dithering: DitherMethods.Atkinson.uniqueId,\r\n    optionValue_dithering_propagation_red: 100,\r\n    optionValue_dithering_propagation_green: 100,\r\n    optionValue_dithering_propagation_blue: 100,\r\n    optionValue_preprocessingEnabled: false,\r\n    preProcessingValue_brightness: 85,\r\n    preProcessingValue_contrast: 110,\r\n    preProcessingValue_saturation: 100,\r\n    preProcessingValue_backgroundColourSelect: BackgroundColourModes.OFF.uniqueId,\r\n    preProcessingValue_backgroundColour: \"#151515\",\r\n    optionValue_extras_moreStaircasingOptions: false,\r\n    uploadedImage: null,\r\n    uploadedImage_baseFilename: null,\r\n    presets: [],\r\n    selectedPresetName: \"None\",\r\n    currentMaterialsData: {\r\n      pixelsData: null,\r\n      maps: [[]], // entries are dictionaries with keys \"materials\", \"supportBlockCount\"\r\n      currentSelectedBlocks: {}, // we keep this soley for materials.js\r\n    },\r\n    mapPreviewWorker_inProgress: false,\r\n    viewOnline_NBT: null,\r\n    viewOnline_3D: false,\r\n  };\r\n\r\n  constructor(props) {\r\n    super(props);\r\n    // update default presets to latest version; done via checking for localeString\r\n    CookieManager.init();\r\n    let cookiesPresets_loaded = JSON.parse(CookieManager.touchCookie(\"mapartcraft_presets\", JSON.stringify(DefaultPresets)));\r\n    let cookiesPresets_updated = [];\r\n    for (const cookiesPreset_loaded of cookiesPresets_loaded) {\r\n      let cookiesPreset_updated = undefined;\r\n      if (\"localeKey\" in cookiesPreset_loaded) {\r\n        cookiesPreset_updated = DefaultPresets.find((defaultPreset) => defaultPreset.localeKey === cookiesPreset_loaded.localeKey);\r\n      }\r\n      if (cookiesPreset_updated === undefined) {\r\n        cookiesPreset_updated = cookiesPreset_loaded;\r\n      }\r\n      cookiesPresets_updated.push(cookiesPreset_updated);\r\n    }\r\n    CookieManager.setCookie(\"mapartcraft_presets\", JSON.stringify(cookiesPresets_updated));\r\n    this.state.presets = cookiesPresets_updated;\r\n\r\n    let cookie_customBlocks = JSON.parse(CookieManager.touchCookie(\"mapartcraft_customBlocks\", JSON.stringify([])));\r\n    this.state.coloursJSON = this.getMergedColoursJSON(cookie_customBlocks);\r\n\r\n    for (const colourSetId of Object.keys(this.state.coloursJSON)) {\r\n      this.state.selectedBlocks[colourSetId] = \"-1\";\r\n    }\r\n\r\n    const cookieMCVersion = CookieManager.touchCookie(\"mapartcraft_mcversion\", Object.values(SupportedVersions)[Object.keys(SupportedVersions).length - 1].MCVersion);\r\n    const supportedVersionFound = Object.values(SupportedVersions).find((supportedVersion) => supportedVersion.MCVersion === cookieMCVersion);\r\n    if (supportedVersionFound !== undefined) {\r\n      this.state.optionValue_version = supportedVersionFound;\r\n    }\r\n\r\n    const URLParams = new URL(window.location).searchParams;\r\n    if (URLParams.has(\"preset\")) {\r\n      const decodedPresetBlocks = this.URLToPreset(URLParams.get(\"preset\"));\r\n      if (decodedPresetBlocks !== null) {\r\n        this.state.selectedBlocks = decodedPresetBlocks;\r\n      }\r\n    }\r\n  }\r\n\r\n  getMergedColoursJSON(customBlocks) {\r\n    // this is how we currently merge custom blocks into coloursJSON at runtime / when custom blocks update. this may change if presets support for custom blocks is added\r\n    let coloursJSON_custom = JSON.parse(JSON.stringify(coloursJSON)); // hmmm\r\n    for (const [colourSetId, customBlock] of customBlocks) {\r\n      coloursJSON_custom[colourSetId].blocks[Object.keys(coloursJSON_custom[colourSetId].blocks).length.toString()] = customBlock;\r\n    }\r\n    return coloursJSON_custom;\r\n  }\r\n\r\n  eventListener_dragover = function (e) {\r\n    // this has to be here for drop event to work\r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n  };\r\n\r\n  eventListener_drop = function (e) {\r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n    const files = e.dataTransfer.files;\r\n    if (files.length) {\r\n      const file = files[0];\r\n      const imgUrl = URL.createObjectURL(file);\r\n      this.loadUploadedImageFromURL(imgUrl, \"mapart\");\r\n    }\r\n  }.bind(this);\r\n\r\n  eventListener_paste = function (e) {\r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n    const files = e.clipboardData.files;\r\n    if (files.length) {\r\n      const file = files[0];\r\n      const imgUrl = URL.createObjectURL(file);\r\n      this.loadUploadedImageFromURL(imgUrl, \"mapart\");\r\n    }\r\n  }.bind(this);\r\n\r\n  componentDidMount() {\r\n    this.loadUploadedImageFromURL(IMG_Upload, \"mapart\");\r\n\r\n    document.addEventListener(\"dragover\", this.eventListener_dragover);\r\n    document.addEventListener(\"drop\", this.eventListener_drop);\r\n\r\n    document.addEventListener(\"paste\", this.eventListener_paste);\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    document.removeEventListener(\"dragover\", this.eventListener_dragover);\r\n    document.removeEventListener(\"drop\", this.eventListener_drop);\r\n    document.removeEventListener(\"paste\", this.eventListener_paste);\r\n  }\r\n\r\n  onFileDialogEvent = (e) => {\r\n    const files = e.target.files;\r\n    if (!files.length) {\r\n      return;\r\n    } else {\r\n      const file = files[0];\r\n      const imgUrl = URL.createObjectURL(file);\r\n      this.loadUploadedImageFromURL(imgUrl, file.name.replace(/\\.[^/.]+$/, \"\"));\r\n    }\r\n  };\r\n\r\n  loadUploadedImageFromURL(imageURL, baseFilename) {\r\n    const img = new Image();\r\n    img.onload = () => {\r\n      this.setState({\r\n        uploadedImage: img,\r\n        uploadedImage_baseFilename: baseFilename,\r\n      });\r\n    };\r\n    img.src = imageURL;\r\n  }\r\n\r\n  handleChangeColourSetBlock = (colourSetId, blockId) => {\r\n    let selectedBlocks = { ...this.state.selectedBlocks };\r\n    selectedBlocks[colourSetId] = blockId;\r\n    this.setState({\r\n      selectedBlocks,\r\n    });\r\n  };\r\n\r\n  handleChangeColourSetBlocks = (setsAndBlocks) => {\r\n    const { coloursJSON, optionValue_version } = this.state;\r\n    let selectedBlocks = {};\r\n    for (const colourSetId of Object.keys(coloursJSON)) {\r\n      selectedBlocks[colourSetId] = \"-1\";\r\n    }\r\n    for (const [int_colourSetId, presetIndex] of setsAndBlocks) {\r\n      // we store presetIndex in the cookie, not blockId\r\n      const colourSetId = int_colourSetId.toString();\r\n      if (!(colourSetId in coloursJSON)) {\r\n        continue;\r\n      }\r\n      const blockIdAndBlock = Object.entries(coloursJSON[colourSetId].blocks).find(([, block]) => block.presetIndex === presetIndex);\r\n      if (blockIdAndBlock === undefined) {\r\n        continue;\r\n      }\r\n      const blockId = blockIdAndBlock[0];\r\n      if (Object.keys(coloursJSON[colourSetId].blocks[blockId].validVersions).includes(optionValue_version.MCVersion)) {\r\n        selectedBlocks[colourSetId] = blockId;\r\n      }\r\n    }\r\n    this.setState({\r\n      selectedBlocks,\r\n    });\r\n  };\r\n\r\n  onOptionChange_modeNBTOrMapdat = (e) => {\r\n    const mode = parseInt(e.target.value);\r\n    this.setState({ optionValue_modeNBTOrMapdat: mode });\r\n    if (mode === MapModes.SCHEMATIC_NBT.uniqueId) {\r\n      this.setState({ optionValue_staircasing: MapModes.SCHEMATIC_NBT.staircaseModes.CLASSIC.uniqueId });\r\n    } else {\r\n      this.setState({ optionValue_staircasing: MapModes.MAPDAT.staircaseModes.ON_UNOBTAINABLE.uniqueId });\r\n    }\r\n  };\r\n\r\n  onOptionChange_version = (e) => {\r\n    const { coloursJSON } = this.state;\r\n    const mcVersion = e.target.value;\r\n    CookieManager.setCookie(\"mapartcraft_mcversion\", mcVersion);\r\n    const supportedVersionFound = Object.values(SupportedVersions).find((supportedVersion) => supportedVersion.MCVersion === mcVersion);\r\n    this.setState((currentState) => {\r\n      let selectedBlocks = { ...currentState.selectedBlocks };\r\n      for (const [colourSetId, colourSet] of Object.entries(coloursJSON)) {\r\n        if (selectedBlocks[colourSetId] !== \"-1\" && !Object.keys(colourSet.blocks[selectedBlocks[colourSetId]].validVersions).includes(mcVersion)) {\r\n          selectedBlocks[colourSetId] = \"-1\";\r\n        }\r\n      }\r\n      return { optionValue_version: supportedVersionFound, selectedBlocks };\r\n    });\r\n  };\r\n\r\n  onOptionChange_mapSize_x = (value) => {\r\n    this.setState({\r\n      optionValue_mapSize_x: value,\r\n    });\r\n  };\r\n\r\n  onOptionChange_mapSize_y = (value) => {\r\n    this.setState({\r\n      optionValue_mapSize_y: value,\r\n    });\r\n  };\r\n\r\n  onOptionChange_cropImage = (e) => {\r\n    const cropValue = parseInt(e.target.value);\r\n    // CENTER is a special case of MANUAL\r\n    // reset cropImage variables any time we change\r\n    this.setState({\r\n      optionValue_cropImage: cropValue,\r\n      optionValue_cropImage_zoom: 10,\r\n      optionValue_cropImage_percent_x: 50,\r\n      optionValue_cropImage_percent_y: 50,\r\n    });\r\n  };\r\n\r\n  onOptionChange_cropImage_zoom = (value) => {\r\n    this.setState({\r\n      optionValue_cropImage_zoom: value,\r\n    });\r\n  };\r\n\r\n  onOptionChange_cropImage_percent_x = (value) => {\r\n    this.setState({\r\n      optionValue_cropImage_percent_x: value,\r\n    });\r\n  };\r\n\r\n  onOptionChange_cropImage_percent_y = (value) => {\r\n    this.setState({\r\n      optionValue_cropImage_percent_y: value,\r\n    });\r\n  };\r\n\r\n  onOptionChange_showGridOverlay = () => {\r\n    this.setState({\r\n      optionValue_showGridOverlay: !this.state.optionValue_showGridOverlay,\r\n    });\r\n    // \"updatePreviewScale(0)\"\r\n  };\r\n\r\n  onOptionChange_staircasing = (e) => {\r\n    const staircasingValue = parseInt(e.target.value);\r\n    this.setState({ optionValue_staircasing: staircasingValue });\r\n  };\r\n\r\n  onOptionChange_transparency = () => {\r\n    this.setState({\r\n      optionValue_transparency: !this.state.optionValue_transparency,\r\n    });\r\n  };\r\n\r\n  onOptionChange_transparencyTolerance = (value) => {\r\n    this.setState({\r\n      optionValue_transparencyTolerance: value,\r\n    });\r\n  };\r\n\r\n  onOptionChange_mapdatFilenameUseId = () => {\r\n    this.setState((currentState) => {\r\n      return {\r\n        optionValue_mapdatFilenameUseId: !currentState.optionValue_mapdatFilenameUseId,\r\n      };\r\n    });\r\n  };\r\n\r\n  onOptionChange_mapdatFilenameIdStart = (value) => {\r\n    this.setState({\r\n      optionValue_mapdatFilenameIdStart: value,\r\n    });\r\n  };\r\n\r\n  onOptionChange_BetterColour = () => {\r\n    this.setState({\r\n      optionValue_betterColour: !this.state.optionValue_betterColour,\r\n    });\r\n  };\r\n\r\n  onOptionChange_dithering = (e) => {\r\n    const ditheringValue = parseInt(e.target.value);\r\n    this.setState({ optionValue_dithering: ditheringValue });\r\n  };\r\n\r\n  onOptionChange_dithering_propagation_red = (value) => {\r\n    this.setState({ optionValue_dithering_propagation_red: value });\r\n  };\r\n\r\n  onOptionChange_dithering_propagation_green = (value) => {\r\n    this.setState({ optionValue_dithering_propagation_green: value });\r\n  };\r\n\r\n  onOptionChange_dithering_propagation_blue = (value) => {\r\n    this.setState({ optionValue_dithering_propagation_blue: value });\r\n  };\r\n\r\n  setOption_SupportBlock = (text) => {\r\n    this.setState({ optionValue_supportBlock: text });\r\n  };\r\n\r\n  onOptionChange_PreProcessingEnabled = () => {\r\n    this.setState({\r\n      optionValue_preprocessingEnabled: !this.state.optionValue_preprocessingEnabled,\r\n    });\r\n  };\r\n\r\n  onOptionChange_PreProcessingBrightness = (value) => {\r\n    this.setState({\r\n      preProcessingValue_brightness: value,\r\n    });\r\n  };\r\n\r\n  onOptionChange_PreProcessingContrast = (value) => {\r\n    this.setState({\r\n      preProcessingValue_contrast: value,\r\n    });\r\n  };\r\n\r\n  onOptionChange_PreProcessingSaturation = (value) => {\r\n    this.setState({\r\n      preProcessingValue_saturation: value,\r\n    });\r\n  };\r\n\r\n  onOptionChange_PreProcessingBackgroundColourSelect = (e) => {\r\n    const newValue = parseInt(e.target.value);\r\n    this.setState({ preProcessingValue_backgroundColourSelect: newValue });\r\n  };\r\n\r\n  onOptionChange_PreProcessingBackgroundColour = (e) => {\r\n    const newValue = e.target.value;\r\n    this.setState({ preProcessingValue_backgroundColour: newValue });\r\n  };\r\n\r\n  onOptionChange_extras_moreStaircasingOptions = () => {\r\n    const { optionValue_modeNBTOrMapdat, optionValue_extras_moreStaircasingOptions } = this.state;\r\n    this.setState({ optionValue_extras_moreStaircasingOptions: !optionValue_extras_moreStaircasingOptions });\r\n    if (optionValue_extras_moreStaircasingOptions) {\r\n      if (optionValue_modeNBTOrMapdat === MapModes.SCHEMATIC_NBT.uniqueId) {\r\n        this.setState({ optionValue_staircasing: MapModes.SCHEMATIC_NBT.staircaseModes.CLASSIC.uniqueId });\r\n      } else {\r\n        this.setState({ optionValue_staircasing: MapModes.MAPDAT.staircaseModes.ON_UNOBTAINABLE.uniqueId });\r\n      }\r\n    }\r\n  };\r\n\r\n  onGetViewOnlineNBT = (viewOnline_NBT) => {\r\n    this.setState({ viewOnline_NBT });\r\n  };\r\n\r\n  downloadBlobFile(downloadBlob, filename) {\r\n    const downloadURL = window.URL.createObjectURL(downloadBlob);\r\n    const downloadElt = document.createElement(\"a\");\r\n    downloadElt.style = \"display: none\";\r\n    downloadElt.href = downloadURL;\r\n    downloadElt.download = filename;\r\n    document.body.appendChild(downloadElt);\r\n    downloadElt.click();\r\n    window.URL.revokeObjectURL(downloadURL);\r\n    document.body.removeChild(downloadElt);\r\n  }\r\n\r\n  handleGetPDNPaletteClicked = () => {\r\n    const { getLocaleString } = this.props;\r\n    const { coloursJSON, selectedBlocks, optionValue_modeNBTOrMapdat, optionValue_staircasing } = this.state;\r\n    let paletteText =\r\n      \"; paint.net Palette File\\n; Generated by MapartCraft\\n; Link to preset: \" +\r\n      this.selectedBlocksToURL() +\r\n      (Object.entries(selectedBlocks).some(([colourSetId, blockId]) => blockId !== \"-1\" && coloursJSON[colourSetId].blocks[blockId].presetIndex === \"CUSTOM\")\r\n        ? \"\\n; Custom blocks not listed!\"\r\n        : \"\") +\r\n      \"\\n; staircasing: \" +\r\n      ([\r\n        MapModes.SCHEMATIC_NBT.staircaseModes.CLASSIC.uniqueId,\r\n        MapModes.SCHEMATIC_NBT.staircaseModes.VALLEY.uniqueId,\r\n        MapModes.MAPDAT.staircaseModes.ON.uniqueId,\r\n        MapModes.MAPDAT.staircaseModes.ON_UNOBTAINABLE.uniqueId,\r\n      ].includes(optionValue_staircasing)\r\n        ? \"enabled\"\r\n        : \"disabled\") +\r\n      \"\\n; unobtainable colours: \" +\r\n      ([MapModes.MAPDAT.staircaseModes.ON_UNOBTAINABLE.uniqueId, MapModes.MAPDAT.staircaseModes.FULL_UNOBTAINABLE.uniqueId].includes(optionValue_staircasing)\r\n        ? \"enabled\"\r\n        : \"disabled\") +\r\n      \"\\n\";\r\n    let numberOfColoursExported = 0;\r\n    const toneKeysToExport = Object.values(Object.values(MapModes).find((mapMode) => mapMode.uniqueId === optionValue_modeNBTOrMapdat).staircaseModes).find(\r\n      (staircaseMode) => staircaseMode.uniqueId === optionValue_staircasing\r\n    ).toneKeys; // this .find stuff is annoying.\r\n    // TODO change from uniqueId to key\r\n    for (const [selectedBlock_colourSetId, selectedBlock_blockId] of Object.entries(selectedBlocks)) {\r\n      if (selectedBlock_blockId !== \"-1\") {\r\n        let colours = coloursJSON[selectedBlock_colourSetId].tonesRGB;\r\n        for (const toneKeyToExport of toneKeysToExport) {\r\n          numberOfColoursExported += 1;\r\n          paletteText += \"FF\";\r\n          for (let i = 0; i < 3; i++) {\r\n            paletteText += Number(colours[toneKeyToExport][i]).toString(16).padStart(2, \"0\").toUpperCase();\r\n          }\r\n          paletteText += \"\\n\";\r\n        }\r\n      }\r\n    }\r\n    if (numberOfColoursExported === 0) {\r\n      alert(getLocaleString(\"BLOCK-SELECTION/PRESETS/DOWNLOAD-WARNING-NONE-SELECTED\"));\r\n      return;\r\n    } else if (numberOfColoursExported > 96) {\r\n      alert(\r\n        `${getLocaleString(\"BLOCK-SELECTION/PRESETS/DOWNLOAD-WARNING-MAX-COLOURS-1\")}${numberOfColoursExported.toString()}${getLocaleString(\r\n          \"BLOCK-SELECTION/PRESETS/DOWNLOAD-WARNING-MAX-COLOURS-2\"\r\n        )}`\r\n      );\r\n    }\r\n    const downloadBlob = new Blob([paletteText], { type: \"text/plain\" });\r\n    this.downloadBlobFile(downloadBlob, \"MapartcraftPalette.txt\");\r\n  };\r\n\r\n  handlePresetChange = (e) => {\r\n    const presetName = e.target.value;\r\n    const { presets } = this.state;\r\n\r\n    this.setState({ selectedPresetName: presetName });\r\n\r\n    if (presetName === \"None\") {\r\n      this.handleChangeColourSetBlocks([]);\r\n    } else {\r\n      const selectedPreset = presets.find((preset) => preset.name === presetName);\r\n      if (selectedPreset !== undefined) {\r\n        this.handleChangeColourSetBlocks(selectedPreset.blocks);\r\n      }\r\n    }\r\n  };\r\n\r\n  canDeletePreset = () => {\r\n    const { selectedPresetName } = this.state;\r\n    return selectedPresetName !== \"None\" && !DefaultPresets.find((defaultPreset) => defaultPreset.name === selectedPresetName);\r\n  };\r\n\r\n  handleDeletePreset = () => {\r\n    const { getLocaleString } = this.props;\r\n    const { presets, selectedPresetName } = this.state;\r\n    if (!this.canDeletePreset()) return;\r\n    if (!window.confirm(`${getLocaleString(\"BLOCK-SELECTION/PRESETS/DELETE-CONFIRM\")} ${selectedPresetName}`)) return;\r\n    const presets_new = presets.filter((preset) => preset.name !== selectedPresetName);\r\n    this.setState({\r\n      presets: presets_new,\r\n      selectedPresetName: \"None\",\r\n    });\r\n    CookieManager.setCookie(\"mapartcraft_presets\", JSON.stringify(presets_new));\r\n  };\r\n\r\n  handleSavePreset = () => {\r\n    const { getLocaleString } = this.props;\r\n    const { coloursJSON, presets, selectedBlocks } = this.state;\r\n\r\n    let presetToSave_name = prompt(getLocaleString(\"BLOCK-SELECTION/PRESETS/SAVE-PROMPT-ENTER-NAME\"), \"\");\r\n    if (presetToSave_name === null) {\r\n      return;\r\n    }\r\n\r\n    const otherPresets = presets.filter((preset) => preset.name !== presetToSave_name);\r\n    let newPreset = { name: presetToSave_name, blocks: [] };\r\n    Object.keys(selectedBlocks).forEach((key) => {\r\n      if (selectedBlocks[key] !== \"-1\" && coloursJSON[key].blocks[selectedBlocks[key]].presetIndex !== \"CUSTOM\") {\r\n        newPreset.blocks.push([parseInt(key), parseInt(coloursJSON[key].blocks[selectedBlocks[key]].presetIndex)]);\r\n      }\r\n    });\r\n    const presets_new = [...otherPresets, newPreset];\r\n    this.setState({\r\n      presets: presets_new,\r\n      selectedPresetName: presetToSave_name,\r\n    });\r\n    CookieManager.setCookie(\"mapartcraft_presets\", JSON.stringify(presets_new));\r\n  };\r\n\r\n  selectedBlocksToURL = () => {\r\n    // colourSetId encoded in base 36 as [0-9a-z]\r\n    // blockId encoded in modified base 26 as [Q-ZA-P]\r\n    const { coloursJSON, selectedBlocks } = this.state;\r\n    let presetQueryString = \"\";\r\n    for (const [colourSetId, blockId] of Object.entries(selectedBlocks)) {\r\n      if (blockId !== \"-1\" && coloursJSON[colourSetId].blocks[blockId].presetIndex !== \"CUSTOM\") {\r\n        presetQueryString += parseInt(colourSetId).toString(36);\r\n        presetQueryString += coloursJSON[colourSetId].blocks[blockId].presetIndex\r\n          .toString(26)\r\n          .toUpperCase()\r\n          .replace(/[0-9]/g, (match) => {\r\n            return {\r\n              0: \"Q\",\r\n              1: \"R\",\r\n              2: \"S\",\r\n              3: \"T\",\r\n              4: \"U\",\r\n              5: \"V\",\r\n              6: \"W\",\r\n              7: \"X\",\r\n              8: \"Y\",\r\n              9: \"Z\",\r\n            }[match];\r\n          });\r\n      }\r\n    }\r\n    return \"https://mms0316.github.io/mapartcraft/?preset=\" + presetQueryString;\r\n  };\r\n\r\n  handleSharePreset = () => {\r\n    const { getLocaleString } = this.props;\r\n    const { coloursJSON, selectedBlocks } = this.state;\r\n    if (Object.keys(selectedBlocks).every((colourSetId) => selectedBlocks[colourSetId] === \"-1\")) {\r\n      alert(getLocaleString(\"BLOCK-SELECTION/PRESETS/SHARE-WARNING-NONE-SELECTED\"));\r\n    } else {\r\n      if (\r\n        Object.entries(selectedBlocks).some(([colourSetId, blockId]) => blockId !== \"-1\" && coloursJSON[colourSetId].blocks[blockId].presetIndex === \"CUSTOM\")\r\n      ) {\r\n        alert(getLocaleString(\"BLOCK-SELECTION/ADD-CUSTOM/NO-EXPORT\"));\r\n      }\r\n      prompt(getLocaleString(\"BLOCK-SELECTION/PRESETS/SHARE-LINK\"), this.selectedBlocksToURL());\r\n    }\r\n  };\r\n\r\n  URLToPreset = (encodedPreset) => {\r\n    const { onCorruptedPreset } = this.props;\r\n    const { coloursJSON, optionValue_version } = this.state;\r\n    if (!/^[0-9a-zQ-ZA-P]*$/g.test(encodedPreset)) {\r\n      onCorruptedPreset();\r\n      return null;\r\n    }\r\n    let selectedBlocks = { ...this.state.selectedBlocks };\r\n    let presetRegex = /([0-9a-z]+)(?=([Q-ZA-P]+))/g;\r\n    let match;\r\n    while ((match = presetRegex.exec(encodedPreset)) !== null) {\r\n      const encodedColourSetId = match[1];\r\n      const encodedBlockId = match[2];\r\n      const decodedColourSetId = parseInt(encodedColourSetId, 36).toString();\r\n      const decodedPresetIndex = parseInt(\r\n        encodedBlockId\r\n          .replace(/[Q-Z]/g, (match) => {\r\n            return {\r\n              Q: \"0\",\r\n              R: \"1\",\r\n              S: \"2\",\r\n              T: \"3\",\r\n              U: \"4\",\r\n              V: \"5\",\r\n              W: \"6\",\r\n              X: \"7\",\r\n              Y: \"8\",\r\n              Z: \"9\",\r\n            }[match];\r\n          })\r\n          .toLowerCase(),\r\n        26\r\n      );\r\n      if (!(decodedColourSetId in coloursJSON)) {\r\n        continue;\r\n      }\r\n      const decodedBlock = Object.entries(coloursJSON[decodedColourSetId].blocks).find((elt) => elt[1].presetIndex === decodedPresetIndex);\r\n      if (decodedBlock === undefined) {\r\n        continue;\r\n      }\r\n      const decodedBlockId = decodedBlock[0].toString();\r\n      if (Object.keys(coloursJSON[decodedColourSetId].blocks[decodedBlockId].validVersions).includes(optionValue_version.MCVersion)) {\r\n        selectedBlocks[decodedColourSetId] = decodedBlockId;\r\n      }\r\n    }\r\n    return selectedBlocks;\r\n  };\r\n\r\n  onMapPreviewWorker_begin = () => {\r\n    this.setState({ mapPreviewWorker_inProgress: true });\r\n  };\r\n\r\n  handleSetMapMaterials = (currentMaterialsData) => {\r\n    this.setState({ currentMaterialsData: currentMaterialsData, mapPreviewWorker_inProgress: false });\r\n  };\r\n\r\n  onChooseViewOnline3D = () => {\r\n    this.setState({ viewOnline_3D: true });\r\n  };\r\n\r\n  handleViewOnline3DEscape = () => {\r\n    this.setState({\r\n      viewOnline_NBT: null,\r\n      viewOnline_3D: false,\r\n    });\r\n  };\r\n\r\n  handleAddCustomBlock = (block_colourSetId, block_name, block_nbtTags, block_versions) => {\r\n    const { getLocaleString } = this.props;\r\n    // const {coloursJSON} = this.state;\r\n    const block_name_trimmed = block_name.trim();\r\n    if (block_name_trimmed === \"\") {\r\n      alert(getLocaleString(\"BLOCK-SELECTION/ADD-CUSTOM/ERROR-NO-NAME\"));\r\n      return;\r\n    }\r\n    if (Object.values(block_versions).every((t) => !t)) {\r\n      alert(getLocaleString(\"BLOCK-SELECTION/ADD-CUSTOM/ERROR-NONE-SELECTED\"));\r\n      return;\r\n    }\r\n    let blockToAdd = {\r\n      displayName: block_name_trimmed,\r\n      validVersions: {},\r\n      presetIndex: \"CUSTOM\",\r\n    };\r\n    let addedFirstVersion = false;\r\n    for (const [block_version, block_version_isSelected] of Object.entries(block_versions)) {\r\n      if (!block_version_isSelected) {\r\n        continue;\r\n      }\r\n      if (addedFirstVersion) {\r\n        blockToAdd.validVersions[SupportedVersions[block_version].MCVersion] = `&${Object.keys(blockToAdd.validVersions)[0]}`;\r\n      } else {\r\n        blockToAdd.validVersions[SupportedVersions[block_version].MCVersion] = {\r\n          NBTName: block_name_trimmed,\r\n          NBTArgs: {},\r\n        };\r\n        for (const [nbtTag_key, nbtTag_value] of block_nbtTags) {\r\n          const nbtTag_key_trimmed = nbtTag_key.trim();\r\n          const nbtTag_value_trimmed = nbtTag_value.trim();\r\n          if (!(nbtTag_key_trimmed === \"\" && nbtTag_value_trimmed === \"\")) {\r\n            blockToAdd.validVersions[SupportedVersions[block_version].MCVersion].NBTArgs[nbtTag_key_trimmed] = nbtTag_value_trimmed;\r\n          }\r\n        }\r\n        addedFirstVersion = true;\r\n      }\r\n    }\r\n\r\n    const customBlocks = JSON.parse(CookieManager.getCookie(\"mapartcraft_customBlocks\"));\r\n    let customBlocks_new = customBlocks.filter(\r\n      (customBlock) =>\r\n        customBlock[0] !== block_colourSetId ||\r\n        customBlock[1].displayName !== block_name_trimmed ||\r\n        !Object.values(SupportedVersions).some(\r\n          (supportedVersion_value) =>\r\n            supportedVersion_value.MCVersion in customBlock[1].validVersions && supportedVersion_value.MCVersion in blockToAdd.validVersions\r\n        )\r\n    ); // filter removes customBlocks that have the same colourSet, name, and some versions in common as the one we are adding. For example this allows us to add different 1.12.2 and 1.13+ versions of a block\r\n    customBlocks_new.push([block_colourSetId, blockToAdd]);\r\n\r\n    this.setState((currentState) => {\r\n      return { coloursJSON: this.getMergedColoursJSON(customBlocks_new), selectedBlocks: { ...currentState.selectedBlocks, [block_colourSetId]: \"-1\" } };\r\n    });\r\n    CookieManager.setCookie(\"mapartcraft_customBlocks\", JSON.stringify(customBlocks_new));\r\n  };\r\n\r\n  handleDeleteCustomBlock = (block_colourSetId, block_name, block_versions) => {\r\n    const block_name_trimmed = block_name.trim();\r\n    if (block_name_trimmed === \"\" || Object.values(block_versions).every((t) => !t)) {\r\n      return;\r\n    }\r\n\r\n    let validVersions = [];\r\n    for (const [block_version, block_version_isSelected] of Object.entries(block_versions)) {\r\n      if (block_version_isSelected) {\r\n        validVersions.push(SupportedVersions[block_version].MCVersion);\r\n      }\r\n    }\r\n\r\n    const customBlocks = JSON.parse(CookieManager.getCookie(\"mapartcraft_customBlocks\"));\r\n    let customBlocks_new = customBlocks.filter(\r\n      (customBlock) =>\r\n        customBlock[0] !== block_colourSetId ||\r\n        customBlock[1].displayName !== block_name_trimmed ||\r\n        !Object.values(SupportedVersions).some(\r\n          (supportedVersion_value) =>\r\n            supportedVersion_value.MCVersion in customBlock[1].validVersions && validVersions.includes(supportedVersion_value.MCVersion)\r\n        )\r\n    );\r\n\r\n    this.setState((currentState) => {\r\n      return {\r\n        coloursJSON: this.getMergedColoursJSON(customBlocks_new),\r\n        selectedBlocks: { ...currentState.selectedBlocks, [block_colourSetId]: \"-1\" },\r\n        currentMaterialsData: {\r\n          // reset currentMaterialsData as materials.js uses a cached version of materials which could contain blocks which no longer exist\r\n          pixelsData: null,\r\n          maps: [[]],\r\n          currentSelectedBlocks: {},\r\n        },\r\n      };\r\n    });\r\n    CookieManager.setCookie(\"mapartcraft_customBlocks\", JSON.stringify(customBlocks_new));\r\n  };\r\n\r\n  render() {\r\n    const { getLocaleString } = this.props;\r\n    const {\r\n      coloursJSON,\r\n      selectedBlocks,\r\n      optionValue_version,\r\n      optionValue_modeNBTOrMapdat,\r\n      optionValue_mapSize_x,\r\n      optionValue_mapSize_y,\r\n      optionValue_cropImage,\r\n      optionValue_cropImage_zoom,\r\n      optionValue_cropImage_percent_x,\r\n      optionValue_cropImage_percent_y,\r\n      optionValue_showGridOverlay,\r\n      optionValue_staircasing,\r\n      optionValue_supportBlock,\r\n      optionValue_transparency,\r\n      optionValue_transparencyTolerance,\r\n      optionValue_mapdatFilenameUseId,\r\n      optionValue_mapdatFilenameIdStart,\r\n      optionValue_betterColour,\r\n      optionValue_dithering,\r\n      optionValue_dithering_propagation_red,\r\n      optionValue_dithering_propagation_green,\r\n      optionValue_dithering_propagation_blue,\r\n      optionValue_preprocessingEnabled,\r\n      preProcessingValue_brightness,\r\n      preProcessingValue_contrast,\r\n      preProcessingValue_saturation,\r\n      preProcessingValue_backgroundColourSelect,\r\n      preProcessingValue_backgroundColour,\r\n      optionValue_extras_moreStaircasingOptions,\r\n      uploadedImage,\r\n      uploadedImage_baseFilename,\r\n      presets,\r\n      selectedPresetName,\r\n      currentMaterialsData,\r\n      mapPreviewWorker_inProgress,\r\n      viewOnline_NBT,\r\n      viewOnline_3D,\r\n    } = this.state;\r\n    return (\r\n      <div className=\"mapartController\">\r\n        <BlockSelection\r\n          getLocaleString={getLocaleString}\r\n          coloursJSON={coloursJSON}\r\n          onChangeColourSetBlock={this.handleChangeColourSetBlock}\r\n          optionValue_version={optionValue_version}\r\n          optionValue_modeNBTOrMapdat={optionValue_modeNBTOrMapdat}\r\n          optionValue_staircasing={optionValue_staircasing}\r\n          selectedBlocks={selectedBlocks}\r\n          presets={presets}\r\n          selectedPresetName={selectedPresetName}\r\n          canDeletePreset={this.canDeletePreset}\r\n          onPresetChange={this.handlePresetChange}\r\n          onDeletePreset={this.handleDeletePreset}\r\n          onSavePreset={this.handleSavePreset}\r\n          onSharePreset={this.handleSharePreset}\r\n          onGetPDNPaletteClicked={this.handleGetPDNPaletteClicked}\r\n          handleAddCustomBlock={this.handleAddCustomBlock}\r\n          handleDeleteCustomBlock={this.handleDeleteCustomBlock}\r\n        />\r\n        <div className=\"sectionsPreviewSettingsMaterials\">\r\n          <MapPreview\r\n            getLocaleString={getLocaleString}\r\n            coloursJSON={coloursJSON}\r\n            selectedBlocks={selectedBlocks}\r\n            optionValue_version={optionValue_version}\r\n            optionValue_modeNBTOrMapdat={optionValue_modeNBTOrMapdat}\r\n            optionValue_mapSize_x={optionValue_mapSize_x}\r\n            optionValue_mapSize_y={optionValue_mapSize_y}\r\n            optionValue_cropImage={optionValue_cropImage}\r\n            optionValue_cropImage_zoom={optionValue_cropImage_zoom}\r\n            optionValue_cropImage_percent_x={optionValue_cropImage_percent_x}\r\n            optionValue_cropImage_percent_y={optionValue_cropImage_percent_y}\r\n            optionValue_showGridOverlay={optionValue_showGridOverlay}\r\n            optionValue_staircasing={optionValue_staircasing}\r\n            optionValue_transparency={optionValue_transparency}\r\n            optionValue_transparencyTolerance={optionValue_transparencyTolerance}\r\n            optionValue_betterColour={optionValue_betterColour}\r\n            optionValue_dithering={optionValue_dithering}\r\n            optionValue_dithering_propagation_red={optionValue_dithering_propagation_red}\r\n            optionValue_dithering_propagation_green={optionValue_dithering_propagation_green}\r\n            optionValue_dithering_propagation_blue={optionValue_dithering_propagation_blue}\r\n            optionValue_preprocessingEnabled={optionValue_preprocessingEnabled}\r\n            preProcessingValue_brightness={preProcessingValue_brightness}\r\n            preProcessingValue_contrast={preProcessingValue_contrast}\r\n            preProcessingValue_saturation={preProcessingValue_saturation}\r\n            preProcessingValue_backgroundColourSelect={preProcessingValue_backgroundColourSelect}\r\n            preProcessingValue_backgroundColour={preProcessingValue_backgroundColour}\r\n            uploadedImage={uploadedImage}\r\n            onFileDialogEvent={this.onFileDialogEvent}\r\n            onGetMapMaterials={this.handleSetMapMaterials}\r\n            onMapPreviewWorker_begin={this.onMapPreviewWorker_begin}\r\n          />\r\n          <div style={{ display: \"block\" }}>\r\n            <MapSettings\r\n              getLocaleString={getLocaleString}\r\n              coloursJSON={coloursJSON}\r\n              optionValue_version={optionValue_version}\r\n              onOptionChange_version={this.onOptionChange_version}\r\n              optionValue_modeNBTOrMapdat={optionValue_modeNBTOrMapdat}\r\n              onOptionChange_modeNBTOrMapdat={this.onOptionChange_modeNBTOrMapdat}\r\n              optionValue_mapSize_x={optionValue_mapSize_x}\r\n              onOptionChange_mapSize_x={this.onOptionChange_mapSize_x}\r\n              optionValue_mapSize_y={optionValue_mapSize_y}\r\n              onOptionChange_mapSize_y={this.onOptionChange_mapSize_y}\r\n              optionValue_cropImage={optionValue_cropImage}\r\n              onOptionChange_cropImage={this.onOptionChange_cropImage}\r\n              optionValue_cropImage_zoom={optionValue_cropImage_zoom}\r\n              onOptionChange_cropImage_zoom={this.onOptionChange_cropImage_zoom}\r\n              optionValue_cropImage_percent_x={optionValue_cropImage_percent_x}\r\n              onOptionChange_cropImage_percent_x={this.onOptionChange_cropImage_percent_x}\r\n              optionValue_cropImage_percent_y={optionValue_cropImage_percent_y}\r\n              onOptionChange_cropImage_percent_y={this.onOptionChange_cropImage_percent_y}\r\n              optionValue_showGridOverlay={optionValue_showGridOverlay}\r\n              onOptionChange_showGridOverlay={this.onOptionChange_showGridOverlay}\r\n              optionValue_staircasing={optionValue_staircasing}\r\n              onOptionChange_staircasing={this.onOptionChange_staircasing}\r\n              optionValue_supportBlock={optionValue_supportBlock}\r\n              setOption_SupportBlock={this.setOption_SupportBlock}\r\n              optionValue_transparency={optionValue_transparency}\r\n              onOptionChange_transparency={this.onOptionChange_transparency}\r\n              optionValue_transparencyTolerance={optionValue_transparencyTolerance}\r\n              onOptionChange_transparencyTolerance={this.onOptionChange_transparencyTolerance}\r\n              optionValue_mapdatFilenameUseId={optionValue_mapdatFilenameUseId}\r\n              onOptionChange_mapdatFilenameUseId={this.onOptionChange_mapdatFilenameUseId}\r\n              optionValue_mapdatFilenameIdStart={optionValue_mapdatFilenameIdStart}\r\n              onOptionChange_mapdatFilenameIdStart={this.onOptionChange_mapdatFilenameIdStart}\r\n              optionValue_betterColour={optionValue_betterColour}\r\n              onOptionChange_BetterColour={this.onOptionChange_BetterColour}\r\n              optionValue_dithering={optionValue_dithering}\r\n              onOptionChange_dithering={this.onOptionChange_dithering}\r\n              optionValue_dithering_propagation_red={optionValue_dithering_propagation_red}\r\n              onOptionChange_dithering_propagation_red={this.onOptionChange_dithering_propagation_red}\r\n              optionValue_dithering_propagation_green={optionValue_dithering_propagation_green}\r\n              onOptionChange_dithering_propagation_green={this.onOptionChange_dithering_propagation_green}\r\n              optionValue_dithering_propagation_blue={optionValue_dithering_propagation_blue}\r\n              onOptionChange_dithering_propagation_blue={this.onOptionChange_dithering_propagation_blue}\r\n              optionValue_preprocessingEnabled={optionValue_preprocessingEnabled}\r\n              onOptionChange_PreProcessingEnabled={this.onOptionChange_PreProcessingEnabled}\r\n              preProcessingValue_brightness={preProcessingValue_brightness}\r\n              onOptionChange_PreProcessingBrightness={this.onOptionChange_PreProcessingBrightness}\r\n              preProcessingValue_contrast={preProcessingValue_contrast}\r\n              onOptionChange_PreProcessingContrast={this.onOptionChange_PreProcessingContrast}\r\n              preProcessingValue_saturation={preProcessingValue_saturation}\r\n              onOptionChange_PreProcessingSaturation={this.onOptionChange_PreProcessingSaturation}\r\n              preProcessingValue_backgroundColourSelect={preProcessingValue_backgroundColourSelect}\r\n              onOptionChange_PreProcessingBackgroundColourSelect={this.onOptionChange_PreProcessingBackgroundColourSelect}\r\n              preProcessingValue_backgroundColour={preProcessingValue_backgroundColour}\r\n              onOptionChange_PreProcessingBackgroundColour={this.onOptionChange_PreProcessingBackgroundColour}\r\n              optionValue_extras_moreStaircasingOptions={optionValue_extras_moreStaircasingOptions}\r\n              onOptionChange_extras_moreStaircasingOptions={this.onOptionChange_extras_moreStaircasingOptions}\r\n            />\r\n            <GreenButtons\r\n              getLocaleString={getLocaleString}\r\n              coloursJSON={coloursJSON}\r\n              selectedBlocks={selectedBlocks}\r\n              optionValue_version={optionValue_version}\r\n              optionValue_modeNBTOrMapdat={optionValue_modeNBTOrMapdat}\r\n              optionValue_mapSize_x={optionValue_mapSize_x}\r\n              optionValue_mapSize_y={optionValue_mapSize_y}\r\n              optionValue_cropImage={optionValue_cropImage}\r\n              optionValue_cropImage_zoom={optionValue_cropImage_zoom}\r\n              optionValue_cropImage_percent_x={optionValue_cropImage_percent_x}\r\n              optionValue_cropImage_percent_y={optionValue_cropImage_percent_y}\r\n              optionValue_staircasing={optionValue_staircasing}\r\n              optionValue_supportBlock={optionValue_supportBlock}\r\n              optionValue_transparency={optionValue_transparency}\r\n              optionValue_transparencyTolerance={optionValue_transparencyTolerance}\r\n              optionValue_mapdatFilenameUseId={optionValue_mapdatFilenameUseId}\r\n              optionValue_mapdatFilenameIdStart={optionValue_mapdatFilenameIdStart}\r\n              optionValue_betterColour={optionValue_betterColour}\r\n              optionValue_dithering={optionValue_dithering}\r\n              optionValue_dithering_propagation_red={optionValue_dithering_propagation_red}\r\n              optionValue_dithering_propagation_green={optionValue_dithering_propagation_green}\r\n              optionValue_dithering_propagation_blue={optionValue_dithering_propagation_blue}\r\n              optionValue_preprocessingEnabled={optionValue_preprocessingEnabled}\r\n              preProcessingValue_brightness={preProcessingValue_brightness}\r\n              preProcessingValue_contrast={preProcessingValue_contrast}\r\n              preProcessingValue_saturation={preProcessingValue_saturation}\r\n              preProcessingValue_backgroundColourSelect={preProcessingValue_backgroundColourSelect}\r\n              preProcessingValue_backgroundColour={preProcessingValue_backgroundColour}\r\n              uploadedImage={uploadedImage}\r\n              uploadedImage_baseFilename={uploadedImage_baseFilename}\r\n              currentMaterialsData={currentMaterialsData}\r\n              mapPreviewWorker_inProgress={mapPreviewWorker_inProgress}\r\n              downloadBlobFile={this.downloadBlobFile}\r\n              onGetViewOnlineNBT={this.onGetViewOnlineNBT}\r\n            />\r\n          </div>\r\n          {optionValue_modeNBTOrMapdat === MapModes.SCHEMATIC_NBT.uniqueId ? (\r\n            <Materials\r\n              getLocaleString={getLocaleString}\r\n              coloursJSON={coloursJSON}\r\n              optionValue_version={optionValue_version}\r\n              optionValue_supportBlock={optionValue_supportBlock}\r\n              currentMaterialsData={currentMaterialsData}\r\n              onChangeColourSetBlock={this.handleChangeColourSetBlock}\r\n            />\r\n          ) : null}\r\n        </div>\r\n        {viewOnline_NBT !== null &&\r\n          (viewOnline_3D ? (\r\n            <ViewOnline3D\r\n              getLocaleString={getLocaleString}\r\n              coloursJSON={coloursJSON}\r\n              optionValue_version={optionValue_version}\r\n              optionValue_mapSize_x={optionValue_mapSize_x}\r\n              optionValue_mapSize_y={optionValue_mapSize_y}\r\n              viewOnline_NBT={viewOnline_NBT}\r\n              handleViewOnline3DEscape={this.handleViewOnline3DEscape}\r\n            />\r\n          ) : (\r\n            <ViewOnline2D\r\n              getLocaleString={getLocaleString}\r\n              coloursJSON={coloursJSON}\r\n              optionValue_version={optionValue_version}\r\n              optionValue_mapSize_x={optionValue_mapSize_x}\r\n              optionValue_mapSize_y={optionValue_mapSize_y}\r\n              optionValue_staircasing={optionValue_staircasing}\r\n              viewOnline_NBT={viewOnline_NBT}\r\n              onGetViewOnlineNBT={this.onGetViewOnlineNBT}\r\n              onChooseViewOnline3D={this.onChooseViewOnline3D}\r\n            />\r\n          ))}\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default MapartController;\r\n","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAANMSURBVHhe7d3PahNRGIbxowv/IHZjcS2uxL3gDXgV3oDgvXgXXoVegOC+iAv3lm6sSGIjKBPmg+Mwk2SSMzPfd573gaEmTJuU99dpRUlvvXn39m9S2G63bxU0AYAnAPAEAJ4AwBMAeAIADwtg9WOVvny4SJvVTXsPMySA7fgfL9LPy+vtWzICHAAb/896s729vl6jEaAAdMe3yAgwAIbGt6gIEAD2jW8REVQP4NDxLRqCqgGMHd8iIagWwLHjWxQEVQI4dXyLgKA6AKXGt2pHUBWA0uNbNSOoBsBU41u1IqgCwNTjWzUiCA9grvGt2hCEBjD3+FZNCMICWGp8qxYEIQEsPb5VA4JwALyMb0VHEAqAt/GtyAjCAPA6vhUVQQgA3se3IiJwDyDK+FY0BK4BRBvfioTALYCo41tRELgEEH18KwICdwBqGd/yjsAVgNrGtzwjcAOg1vEtrwhcAKh9fMsjgsUBUMa3vCFYFABtfMsTgsUAUMe3vCBYBAB9fMsDgtkBaPz/WxrBrAA0fn9LIpgNgMbf3VIIZgGg8Q9rCQSTA9D445obwaQANP5xzYlg0t8XcPn1e9qsy30SV9+u0s2v3+0tf915cDedPz1vb53evbP76dGTch+vr1C/MKJ5Ycfmtf289vDxWXr26nl7K0az/jVQ+UsA4AkAPAGAJwDwBACeAMATAHgCAE8A4AkAPAGAJwDwBACeAMATAHgCAE8A4AkAPAGAJwDwBACeAMATAHgCAE8A4AkAPAGAJwDwBACeAMATAHgCAE8A4AkAPAGAJwDwBACeAMAL9TqBqny6AsATAHgCAE8A4AkAPAGAJwDwBACeAMATAHgCAE8A4BX9x6DP7z+1fxruxeuX27f5uX33DbXr/ZuG7u927ONbpz7noY4595R0BYA3GYBGpx3HlL9/fsxV97EOeewxzzM/Nz/66juvOUqkKwC8yQA038PsmLruY5X8ChlT93nsKz9/1/v1ndccJdIVAN4sPwPkxxR1P37Jr5AxdZ/Hvg49N/+4+VEiXQHguQWQf6/Lj1oa8znl5+ZHiXQFgKf/Fg5PVwB4AgBPAOAJADwBgCcA8AQAngDAEwB4AgBPAOAJADwBgCcA8AQAXUr/ADWYPUK6/RieAAAAAElFTkSuQmCC\"","import React, { Component } from \"react\";\r\n\r\nimport Header from \"./header\";\r\nimport Languages from \"./languages\";\r\nimport MapartController from \"./mapart/mapartController\";\r\n\r\nimport Locale from \"../locale/locale\";\r\n\r\nimport \"./root.css\";\r\n\r\nclass Root extends Component {\r\n  state = {\r\n    displayingCorruptedPresetWarning: false,\r\n    displayingEdgeWarning: false,\r\n  };\r\n\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    //show warning when using Edge\r\n    if (!(/*@cc_on!@*/ (false || !!document[\"documentMode\"])) && !!window[\"StyleMedia\"]) {\r\n      this.state.displayingEdgeWarning = true;\r\n    }\r\n  }\r\n\r\n  getLocaleString = (stringName, languageCodeOverride) => {\r\n    // languageCodeOverride only used inside this method for falling back to en\r\n    const countryCode = languageCodeOverride !== undefined ? languageCodeOverride : this.props.match.params.countryCode;\r\n    if (countryCode in Locale) {\r\n      let stringSegments = stringName.split(\"/\");\r\n      const stringLast = stringSegments.pop();\r\n      let folder = Locale[countryCode].strings;\r\n      for (const stringSegment of stringSegments) {\r\n        folder = folder[stringSegment];\r\n      }\r\n      if (folder[stringLast] === null) {\r\n        // this could get stuck in an endless loop if the string does not exist in en;\r\n        // en must always exist\r\n        return this.getLocaleString(stringName, \"en\");\r\n      } else {\r\n        return folder[stringLast];\r\n      }\r\n    } else {\r\n      return this.getLocaleString(stringName, \"en\");\r\n    }\r\n  };\r\n\r\n  onEdgeWarningButtonClick = () => {\r\n    this.setState({ displayingEdgeWarning: false });\r\n  };\r\n\r\n  onCorruptedPresetWarningButtonClick = () => {\r\n    this.setState({ displayingCorruptedPresetWarning: false });\r\n  };\r\n\r\n  showCorruptedPresetWarning = () => {\r\n    this.setState({ displayingCorruptedPresetWarning: true });\r\n  };\r\n\r\n  render() {\r\n    const { displayingCorruptedPresetWarning, displayingEdgeWarning } = this.state;\r\n    return (\r\n      <React.Fragment>\r\n        <div className=\"titleAndLanguages\">\r\n          <span><h1>MapartCraft</h1>{this.props.match.params.countryCode && this.props.match.params.countryCode !== \"en\" && <small>{this.getLocaleString(\"TRANSLATION/CREDITS\")}</small>}</span>\r\n          <Languages />\r\n        </div>\r\n        <Header getLocaleString={this.getLocaleString} countryCode={this.props.match.params.countryCode} />\r\n        <MapartController getLocaleString={this.getLocaleString} onCorruptedPreset={this.showCorruptedPresetWarning} />\r\n        <div className=\"fixedMessages\">\r\n          {displayingEdgeWarning ? (\r\n            <div className=\"fixedMessage\">\r\n              <p>{this.getLocaleString(\"EDGE-WARNING\").replace(\"\\\\n\", \"\\n\")}</p>\r\n              <button type=\"button\" onClick={this.onEdgeWarningButtonClick}>\r\n                ✔️\r\n              </button>\r\n            </div>\r\n          ) : null}\r\n          {displayingCorruptedPresetWarning ? (\r\n            <div className=\"fixedMessage\">\r\n              <p>{this.getLocaleString(\"BLOCK-SELECTION/PRESETS/IMPORT-ERROR-CORRUPTED\")}</p>\r\n              <button type=\"button\" onClick={this.onCorruptedPresetWarningButtonClick}>\r\n                ❗\r\n              </button>\r\n            </div>\r\n          ) : null}\r\n        </div>\r\n      </React.Fragment>\r\n    );\r\n  }\r\n}\r\n\r\nexport default Root;\r\n","import React from \"react\";\r\nimport ReactDOM from \"react-dom\";\r\nimport { BrowserRouter as Router, Switch, Route } from \"react-router-dom\";\r\n\r\nimport FAQ from \"./components/faq\";\r\nimport Root from \"./components/root\";\r\n\r\nimport \"./index.css\";\r\n\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    <Router basename=\"/mapartcraft\">\r\n      <Switch>\r\n        <Route path=\"/:countryCode?/faq\" component={FAQ} />\r\n        <Route path=\"/:countryCode?\" component={Root} />\r\n      </Switch>\r\n    </Router>\r\n  </React.StrictMode>,\r\n  document.getElementById(\"root\")\r\n);\r\n"],"sourceRoot":""}